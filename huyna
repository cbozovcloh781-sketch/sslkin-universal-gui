if not game:IsLoaded() then game.Loaded:Wait() end


local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local CoreGui = game:GetService("CoreGui")


local Config = {
    ESP = {
        Enabled     = true,
        TeamCheck   = false,
        ShowOutline = true,
        ShowLines   = false,
        Rainbow     = false,
        FillColor   = Color3.fromRGB(255,255,255),
        OutlineColor= Color3.fromRGB(255,255,255),
        TextColor   = Color3.fromRGB(255,255,255),
        LineColor   = Color3.fromRGB(255,255,255),
        FillTransparency    = 0.5,
        OutlineTransparency = 0,
        Font        = Enum.Font.SciFi,
        TeamColor   = Color3.fromRGB(0,255,0),
        EnemyColor  = Color3.fromRGB(255,0,0),
        ToggleKey   = nil,
    },
    Aimbot = {
        Enabled         = false,
        TeamCheck       = false,
        VisibilityCheck = true,
        FOV             = 150,
        ToggleKey       = nil,
        FOVColor        = Color3.fromRGB(255,128,128),
        FOVRainbow      = false,
    },
    MenuCollapsed = false,
}


local MovementConfig = {
    Fly = {Enabled = false, Speed = 1, ToggleKey = nil},
    NoClip = {Enabled = false, ToggleKey = nil, ForceToggleKey = nil},
    Speed = {Enabled = false, Speed = 1, ToggleKey = nil, UseJumpPower = false},
    LongJump = {Enabled = false, JumpPower = 150, ToggleKey = nil},
    InfiniteJump = {Enabled = false, JumpPower = 50, ToggleKey = nil},
}


local TeleportConfig = {
    Enabled = false,
    TargetPlayer = nil,
    OriginalPosition = nil,
    ToggleKey = nil,
    SelectedPlayerName = nil,
    UseStealthMode = true,
    TeleportSpeed = 2000,
    ReturnSpeed = 2400,
    BehindPlayerDistance = 2.6,
    StabilizationTime = 0.25,
    MaxSpeedResetTime = 2.0,
    SpeedResetThreshold = 50,
    InstantTurnSpeed = 600,
    SmoothingFactor = 0.2,
    MaxCorrectionSpeed = 180,
    StabilizationThreshold = 0.9,
}

local YBAConfig = {
    Enabled = false,
    ToggleKey = nil,
    StandRange = 500, -- Ð£Ð¼ÐµÐ½ÑŒÑˆÐ¸Ð»Ð¸ Ñ 100000 Ð´Ð¾ Ñ€Ð°Ð·ÑƒÐ¼Ð½Ð¾Ð³Ð¾ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ñ
    FreezePlayer = true,
    SwitchCamera = true,
    TransferControl = true,
    AutoFindStands = true,
    MaxStandDistance = 50, -- Ð£Ð¼ÐµÐ½ÑŒÑˆÐ¸Ð»Ð¸ Ñ 10000 Ð´Ð¾ Ñ€Ð°Ð·ÑƒÐ¼Ð½Ð¾Ð³Ð¾ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ñ
    CameraDistance = 12, -- Ð£Ð¼ÐµÐ½ÑŒÑˆÐ¸Ð»Ð¸ Ð´Ð»Ñ Ð»ÑƒÑ‡ÑˆÐµÐ³Ð¾ Ð¾Ð±Ð·Ð¾Ñ€Ð°
    CameraHeight = 8, -- Ð£Ð²ÐµÐ»Ð¸Ñ‡Ð¸Ð»Ð¸ Ð´Ð»Ñ Ð»ÑƒÑ‡ÑˆÐµÐ³Ð¾ Ð¾Ð±Ð·Ð¾Ñ€Ð°
    StandControlSpeed = 1.0,
    StandControlSmoothing = 0.1,
    MouseSensitivity = 0.01,
    CameraSmoothing = 0.08,
    CameraFollowDistance = 20.2,
    CameraFollowHeight = 6.1,
    MouseLookSensitivity = 0.003,
    StandRotationSpeed = 0.05,
    UndergroundControl = {
        FlightSpeed = 40, -- Ð”ÐµÑ„Ð¾Ð»Ñ‚Ð½Ð°Ñ ÑÐºÐ¾Ñ€Ð¾ÑÑ‚ÑŒ Ð¿Ð¾Ð»ÐµÑ‚Ð°
        AutoNoClip = true,
        OriginalPosition = nil,
    },
    ItemESP = {
        Enabled = false,
        ToggleKey = nil,
        MaxDistance = 1000,
        MaxRenderDistance = 5000,
        UpdateInterval = 0.3,
        ShowOutline = true,
        ShowText = true,
        ShowFill = true,
        FillColor = Color3.fromRGB(255, 215, 0),
        OutlineColor = Color3.fromRGB(255, 255, 0),
        TextColor = Color3.fromRGB(255, 255, 255),
        TextBackgroundColor = Color3.fromRGB(0, 0, 0),
        FillTransparency = 0.3,
        OutlineTransparency = 0.1,
        TextBackgroundTransparency = 0.3,
        TextSize = 10,
        DistanceTextSize = 9,
        Font = Enum.Font.GothamBold,
        Items = {
            ["Mysterious Arrow"] = true,
            ["Rokakaka"] = true,
            ["Pure Rokakaka"] = true,
            ["Diamond"] = true,
            ["Gold Coin"] = true,
            ["Steel Ball"] = true,
            ["Clackers"] = true,
            ["Caesar's Headband"] = true,
            ["Zeppeli's Hat"] = true,
            ["Zeppeli's Scarf"] = true,
            ["Ancient Scroll"] = true,
            ["Quinton's Glove"] = true,
            ["Stone Mask"] = true,
            ["Lucky Arrow"] = true,
            ["Lucky Stone Mask"] = true,
            ["Rib Cage of The Saint's Corpse"] = true,
            ["DIO's Diary"] = true,
        }
    }
}

local AntiTimeStopConfig = {
    Enabled = false,
    ToggleKey = nil,
    MovementSpeed = 1.5,
    JumpPower = 50,
    WalkSpeed = 16,
    AutoActivate = true,
    DetectionRange = 100,
    VisualEffect = true,
    SoundEffect = false,
    AntiFreeze = true,
    TimeStopBypass = true,
    MovementOverride = true,
    DisableOnAttack = true,
    ServerSync = true,
}

-- ÐšÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ñ Ð°Ð²Ñ‚Ð¾Ñ„Ð°Ñ€Ð¼Ð°
local AutofarmConfig = {
    Enabled = false,
    ToggleKey = nil,
    UseFlightMovement = true,
    UseNoClipMovement = true,
    FlightSpeed = 100, -- ÑƒÐ²ÐµÐ»Ð¸Ñ‡ÐµÐ½Ð° ÑÐºÐ¾Ñ€Ð¾ÑÑ‚ÑŒ Ð´Ð»Ñ Ð±Ñ‹ÑÑ‚Ñ€Ð¾Ð³Ð¾ Ð°Ð²Ñ‚Ð¾Ñ„Ð°Ñ€Ð¼Ð°
    PickupRadius = 4, -- Ñ€Ð°Ð´Ð¸ÑƒÑ Ð² ÐºÐ¾Ñ‚Ð¾Ñ€Ð¾Ð¼ Ð½Ð°Ñ‡Ð¸Ð½Ð°ÐµÑ‚ÑÑ Ð¿Ð¾Ð´Ð±Ð¾Ñ€ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ð¾Ð² (YBA Ð¼ÐµÑ…Ð°Ð½Ð¸ÐºÐ°)
    PickupDuration = 0.6, -- Ð²Ñ€ÐµÐ¼Ñ Ð·Ð°Ð¶Ð°Ñ‚Ð¸Ñ ÐºÐ»Ð°Ð²Ð¸ÑˆÐ¸ E Ð´Ð»Ñ Ð¿Ð¾Ð´Ð±Ð¾Ñ€Ð° (YBA Ð¼ÐµÑ…Ð°Ð½Ð¸ÐºÐ°)
    PickupKey = Enum.KeyCode.E,
    ScanInterval = 1, -- Ð¸Ð½Ñ‚ÐµÑ€Ð²Ð°Ð» ÑÐºÐ°Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ Ð² ÑÐµÐºÑƒÐ½Ð´Ð°Ñ…
    Items = {
        ["Mysterious Arrow"] = true,
        ["Rokakaka"] = true,
        ["Pure Rokakaka"] = true,
        ["Diamond"] = true,
        ["Gold Coin"] = true,
        ["Steel Ball"] = true,
        ["Clackers"] = true,
        ["Caesar's Headband"] = true,
        ["Zeppeli's Hat"] = true,
        ["Zeppeli's Scarf"] = true,
        ["Ancient Scroll"] = true,
        ["Quinton's Glove"] = true,
        ["Stone Mask"] = true,
        ["Lucky Arrow"] = true,
        ["Lucky Stone Mask"] = true,
        ["Rib Cage of The Saint's Corpse"] = true,
        ["DIO's Diary"] = true,
        ["Dio's Diary"] = true, -- Ð´Ð¾Ð±Ð°Ð²Ð»ÑÐµÐ¼ Ð°Ð»ÑŒÑ‚ÐµÑ€Ð½Ð°Ñ‚Ð¸Ð²Ð½Ð¾Ðµ Ð½Ð°Ð¿Ð¸ÑÐ°Ð½Ð¸Ðµ
    }
}

-- ÐšÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ñ Ð°Ð²Ñ‚Ð¾ÑÐµÐ»Ð»Ð°
local AutosellConfig = {
    Enabled = false,
    MaxItemCount = 10, -- Ð¼Ð°ÐºÑÐ¸Ð¼Ð°Ð»ÑŒÐ½Ð¾Ðµ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ð¾Ð² ÐºÐ°Ð¶Ð´Ð¾Ð³Ð¾ Ñ‚Ð¸Ð¿Ð°
    ShiftploxPosition = Vector3.new(-709, -25, -332), -- Ð¿Ð¾Ð·Ð¸Ñ†Ð¸Ñ NPC Shiftplox
    Items = {
        ["Mysterious Arrow"] = false,
        ["Rokakaka"] = false,
        ["Pure Rokakaka"] = false,
        ["Diamond"] = false,
        ["Gold Coin"] = false,
        ["Steel Ball"] = false,
        ["Clackers"] = false,
        ["Caesar's Headband"] = false,
        ["Zeppeli's Hat"] = false,
        ["Zeppeli's Scarf"] = false,
        ["Ancient Scroll"] = false,
        ["Quinton's Glove"] = false,
        ["Stone Mask"] = false,
        ["Lucky Arrow"] = false,
        ["Lucky Stone Mask"] = false,
        ["Rib Cage of The Saint's Corpse"] = false,
        ["DIO's Diary"] = false,
        ["Dio's Diary"] = false,
    }
}

local isFlying = false
local flyConnections = {}
local originalGravity = workspace.Gravity

local isNoClipping = false
local noClipConnections = {}

local isSpeedHacking = false
local speedHackConnections = {}
local originalWalkSpeed = 16
local originalJumpPower = 50

local isLongJumping = false
local longJumpConnections = {}
local originalLongJumpPower = 50

local isUndergroundControlEnabled = false
local undergroundControlConnections = {}
local controlledStandForUnderground = nil
local isShiftPressed = false

local isInfiniteJumping = false
local infiniteJumpConnections = {}
local lastJumpTime = 0

local isTeleporting = false
local teleportConnections = {}
local playerSelectionWindow = nil
local lastTeleportPosition = nil
local stabilizationStartTime = nil
local isStabilizing = false
local speedResetTimer = 0
local lastSpeedCheck = tick()
local lastBehindDistance = 0
local lastUpdateTime = tick()

local isYBAEnabled = false
local ybaConnections = {}
local originalPlayerPosition = nil
local originalPlayerCFrame = nil
local originalCameraCFrame = nil
local controlledStand = nil
local standControlConnections = {}
local originalGravity = workspace.Gravity
local originalYBAWalkSpeed = 16
local originalYBAJumpPower = 50

local isAntiTimeStopEnabled = false
local antiTimeStopConnections = {}
local originalAntiTimeStopWalkSpeed = 16
local originalAntiTimeStopJumpPower = 50
local timeStopDetected = false
local timeStopStartTime = 0
local timeStopDuration = 0
local antiTimeStopEffect = nil

local isStandControlActive = false
local currentControlledStand = nil
local standCameraConnections = {}
local originalStandCameraCFrame = nil
local standControlActive = false

local freeCameraActive = false
local freeCameraConnections = {}
local freeCameraRotation = Vector2.new(0, 0)
local freeCameraDistance = 10
local freeCameraHeight = 5
local freeCameraTarget = nil
local freeCameraLastMousePos = Vector2.new(0, 0)
local lastCameraUpdate = nil

-- Ð“Ð»Ð¾Ð±Ð°Ð»ÑŒÐ½Ð°Ñ Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ð°Ñ Ð´Ð»Ñ Ð¾Ñ‚ÑÐ»ÐµÐ¶Ð¸Ð²Ð°Ð½Ð¸Ñ Ð²Ð²Ð¾Ð´Ð° Ð² Ñ‡Ð°Ñ‚Ðµ/GUI
local isInputBeingProcessedByGame = false



local itemESPConnections = {}
local itemESPElements = {}
local itemESPEnabled = false

-- Player ESP variables
local playerESPConnections = {}
local playerESPElements = {}

-- Autofarm variables
local isAutofarmEnabled = false
local autofarmConnections = {}
local autofarmCurrentTarget = nil
local autofarmItemQueue = {}
local autofarmOriginalPosition = nil
local autofarmPickingUp = false
local autofarmSkippedItems = {} -- ÐŸÑ€Ð¾Ð¿ÑƒÑ‰ÐµÐ½Ð½Ñ‹Ðµ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ñ‹ Ð´Ð»Ñ Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€Ð½Ð¾Ð¹ Ð¿Ð¾Ð¿Ñ‹Ñ‚ÐºÐ¸
local autofarmItemAttempts = {} -- Ð¡Ñ‡ÐµÑ‚Ñ‡Ð¸Ðº Ð¿Ð¾Ð¿Ñ‹Ñ‚Ð¾Ðº Ð´Ð»Ñ ÐºÐ°Ð¶Ð´Ð¾Ð³Ð¾ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ð°
local autofarmSkippedReturns = {} -- Ð¡Ñ‡ÐµÑ‚Ñ‡Ð¸Ðº Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‚Ð¾Ð² Ðº Ð¿Ñ€Ð¾Ð¿ÑƒÑ‰ÐµÐ½Ð½Ñ‹Ð¼ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ð°Ð¼
local autofarmLastPickupTime = 0 -- Ð’Ñ€ÐµÐ¼Ñ Ð¿Ð¾ÑÐ»ÐµÐ´Ð½ÐµÐ³Ð¾ Ð¿Ð¾Ð´Ð±Ð¾Ñ€Ð° Ð´Ð»Ñ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸ Ð½ÐµÐ°ÐºÑ‚Ð¸Ð²Ð½Ð¾ÑÑ‚Ð¸
local autofarmRestartTimer = nil -- Ð¢Ð°Ð¹Ð¼ÐµÑ€ Ð´Ð»Ñ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ð³Ð¾ Ð¿ÐµÑ€ÐµÐ·Ð°Ð¿ÑƒÑÐºÐ° Ñ‡ÐµÑ€ÐµÐ· 60 ÑÐµÐºÑƒÐ½Ð´
local autofarmAutoRestarting = false -- Ð¤Ð»Ð°Ð³ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ð³Ð¾ Ð¿ÐµÑ€ÐµÐ·Ð°Ð¿ÑƒÑÐºÐ°

-- Autosell variables
local isAutosellEnabled = false
local autosellConnections = {}
local isSellingToNPC = false
local autosellCheckTimer = nil



-- Autosell Functions

-- ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð° Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ð¾Ð² Ð² Ñ€ÑŽÐºÐ·Ð°ÐºÐµ
local function checkInventoryForMaxItems()
    local player = Players.LocalPlayer
    if not player or not player.Backpack then return {} end
    
    local itemCounts = {}
    local itemsAtMax = {}
    
    -- ÐŸÐ¾Ð´ÑÑ‡Ð¸Ñ‚Ñ‹Ð²Ð°ÐµÐ¼ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ ÐºÐ°Ð¶Ð´Ð¾Ð³Ð¾ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ð° Ð² Ñ€ÑŽÐºÐ·Ð°ÐºÐµ
    for _, item in pairs(player.Backpack:GetChildren()) do
        if item:IsA("Tool") then
            local itemName = item.Name
            itemCounts[itemName] = (itemCounts[itemName] or 0) + 1
        end
    end
    
    -- ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼ ÐºÐ°ÐºÐ¸Ðµ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ñ‹ Ð´Ð¾ÑÑ‚Ð¸Ð³Ð»Ð¸ Ð¼Ð°ÐºÑÐ¸Ð¼ÑƒÐ¼Ð°
    for itemName, isEnabled in pairs(AutosellConfig.Items) do
        if isEnabled and itemCounts[itemName] and itemCounts[itemName] >= AutosellConfig.MaxItemCount then
            table.insert(itemsAtMax, itemName)
            print("ðŸ¤– AUTOSELL: ÐŸÑ€ÐµÐ´Ð¼ÐµÑ‚", itemName, "Ð´Ð¾ÑÑ‚Ð¸Ð³ Ð¼Ð°ÐºÑÐ¸Ð¼ÑƒÐ¼Ð°:", itemCounts[itemName], "/", AutosellConfig.MaxItemCount)
        end
    end
    
    return itemsAtMax
end

-- ÐŸÐµÑ€ÐµÐ¼ÐµÑ‰ÐµÐ½Ð¸Ðµ Ðº NPC Shiftplox
local function moveToShiftplox(callback)
    print("ðŸ¤– AUTOSELL: Ð›ÐµÑ‚Ð¸Ð¼ Ðº NPC Shiftplox...")
    moveToPosition(AutosellConfig.ShiftploxPosition, callback)
end

-- Ð’Ð·ÑÑ‚ÑŒ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚ Ð² Ñ€ÑƒÐºÐ¸
local function equipItem(itemName)
    local player = Players.LocalPlayer
    if not player or not player.Backpack then return false end
    
    local item = player.Backpack:FindFirstChild(itemName)
    if item and item:IsA("Tool") then
        item.Parent = player.Character
        print("ðŸ¤– AUTOSELL: Ð’Ð·ÑÐ»Ð¸ Ð² Ñ€ÑƒÐºÐ¸ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚:", itemName)
        return true
    end
    return false
end

-- ÐÐ°Ð¶Ð°Ñ‚ÑŒ ÐºÐ»Ð°Ð²Ð¸ÑˆÑƒ E Ð´Ð»Ñ Ð´Ð¸Ð°Ð»Ð¾Ð³Ð° Ñ NPC
local function interactWithNPC()
    print("ðŸ¤– AUTOSELL: ÐÐ°Ð¶Ð¸Ð¼Ð°ÐµÐ¼ E Ð´Ð»Ñ Ð´Ð¸Ð°Ð»Ð¾Ð³Ð° Ñ NPC...")
    game:GetService("VirtualInputManager"):SendKeyEvent(true, Enum.KeyCode.E, false, game)
    task.wait(0.1)
    game:GetService("VirtualInputManager"):SendKeyEvent(false, Enum.KeyCode.E, false, game)
end

-- Ð¡Ð¸Ð¼ÑƒÐ»ÑÑ†Ð¸Ñ Ð½Ð°Ð¶Ð°Ñ‚Ð¸Ð¹ ÐºÐ½Ð¾Ð¿Ð¾Ðº Ð² Ð´Ð¸Ð°Ð»Ð¾Ð³Ðµ (Ð»ÐµÐ²Ð°Ñ ÐºÐ½Ð¾Ð¿ÐºÐ° Ð´Ð²Ð° Ñ€Ð°Ð·Ð°, Ð·Ð°Ñ‚ÐµÐ¼ Ð»ÐµÐ²Ð°Ñ Ð¾Ð´Ð¸Ð½ Ñ€Ð°Ð·)
local function handleNPCDialog()
    print("ðŸ¤– AUTOSELL: ÐžÐ±Ñ€Ð°Ð±Ð°Ñ‚Ñ‹Ð²Ð°ÐµÐ¼ Ð´Ð¸Ð°Ð»Ð¾Ð³ Ñ NPC...")
    
    task.wait(1) -- Ð–Ð´ÐµÐ¼ Ð¿Ð¾ÑÐ²Ð»ÐµÐ½Ð¸Ñ Ð´Ð¸Ð°Ð»Ð¾Ð³Ð°
    
    -- ÐŸÐµÑ€Ð²Ð°Ñ Ð»ÐµÐ²Ð°Ñ ÐºÐ½Ð¾Ð¿ÐºÐ°
    print("ðŸ¤– AUTOSELL: ÐÐ°Ð¶Ð¸Ð¼Ð°ÐµÐ¼ Ð¿ÐµÑ€Ð²ÑƒÑŽ Ð»ÐµÐ²ÑƒÑŽ ÐºÐ½Ð¾Ð¿ÐºÑƒ...")
    game:GetService("VirtualInputManager"):SendKeyEvent(true, Enum.KeyCode.One, false, game)
    task.wait(0.1)
    game:GetService("VirtualInputManager"):SendKeyEvent(false, Enum.KeyCode.One, false, game)
    
    task.wait(0.5)
    
    -- Ð’Ñ‚Ð¾Ñ€Ð°Ñ Ð»ÐµÐ²Ð°Ñ ÐºÐ½Ð¾Ð¿ÐºÐ°
    print("ðŸ¤– AUTOSELL: ÐÐ°Ð¶Ð¸Ð¼Ð°ÐµÐ¼ Ð²Ñ‚Ð¾Ñ€ÑƒÑŽ Ð»ÐµÐ²ÑƒÑŽ ÐºÐ½Ð¾Ð¿ÐºÑƒ...")
    game:GetService("VirtualInputManager"):SendKeyEvent(true, Enum.KeyCode.One, false, game)
    task.wait(0.1)
    game:GetService("VirtualInputManager"):SendKeyEvent(false, Enum.KeyCode.One, false, game)
    
    task.wait(0.5)
    
    -- Ð¢Ñ€ÐµÑ‚ÑŒÑ Ð»ÐµÐ²Ð°Ñ ÐºÐ½Ð¾Ð¿ÐºÐ°
    print("ðŸ¤– AUTOSELL: ÐÐ°Ð¶Ð¸Ð¼Ð°ÐµÐ¼ Ñ‚Ñ€ÐµÑ‚ÑŒÑŽ Ð»ÐµÐ²ÑƒÑŽ ÐºÐ½Ð¾Ð¿ÐºÑƒ...")
    game:GetService("VirtualInputManager"):SendKeyEvent(true, Enum.KeyCode.One, false, game)
    task.wait(0.1)
    game:GetService("VirtualInputManager"):SendKeyEvent(false, Enum.KeyCode.One, false, game)
    
    task.wait(1) -- Ð–Ð´ÐµÐ¼ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¸Ñ Ð¿Ñ€Ð¾Ð´Ð°Ð¶Ð¸
end

-- ÐžÑÐ½Ð¾Ð²Ð½Ð°Ñ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ñ Ð¿Ñ€Ð¾Ð´Ð°Ð¶Ð¸ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ð¾Ð²
local function sellItemsToNPC(itemsToSell)
    if isSellingToNPC then return end
    isSellingToNPC = true
    
    print("ðŸ¤– AUTOSELL: ÐÐ°Ñ‡Ð¸Ð½Ð°ÐµÐ¼ Ð¿Ñ€Ð¾Ð´Ð°Ð¶Ñƒ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ð¾Ð²:", table.concat(itemsToSell, ", "))
    
    -- ÐžÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÐ¼ Ð°Ð²Ñ‚Ð¾Ñ„Ð°Ñ€Ð¼
    if isAutofarmEnabled then
        print("ðŸ¤– AUTOSELL: ÐžÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÐ¼ Ð°Ð²Ñ‚Ð¾Ñ„Ð°Ñ€Ð¼ Ð´Ð»Ñ Ð¿Ñ€Ð¾Ð´Ð°Ð¶Ð¸...")
        stopAutofarm()
    end
    
    -- Ð›ÐµÑ‚Ð¸Ð¼ Ðº NPC
    moveToShiftplox(function()
        print("ðŸ¤– AUTOSELL: ÐŸÑ€Ð¸Ð»ÐµÑ‚ÐµÐ»Ð¸ Ðº NPC, Ð½Ð°Ñ‡Ð¸Ð½Ð°ÐµÐ¼ Ð¿Ñ€Ð¾Ð´Ð°Ð¶Ñƒ...")
        
        for _, itemName in ipairs(itemsToSell) do
            print("ðŸ¤– AUTOSELL: ÐŸÑ€Ð¾Ð´Ð°ÐµÐ¼ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚:", itemName)
            
            -- Ð‘ÐµÑ€ÐµÐ¼ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚ Ð² Ñ€ÑƒÐºÐ¸
            if equipItem(itemName) then
                task.wait(0.5)
                
                -- Ð’Ð·Ð°Ð¸Ð¼Ð¾Ð´ÐµÐ¹ÑÑ‚Ð²ÑƒÐµÐ¼ Ñ NPC
                interactWithNPC()
                
                -- ÐžÐ±Ñ€Ð°Ð±Ð°Ñ‚Ñ‹Ð²Ð°ÐµÐ¼ Ð´Ð¸Ð°Ð»Ð¾Ð³
                handleNPCDialog()
                
                task.wait(1) -- ÐŸÐ°ÑƒÐ·Ð° Ð¼ÐµÐ¶Ð´Ñƒ Ð¿Ñ€Ð¾Ð´Ð°Ð¶Ð°Ð¼Ð¸
            else
                print("ðŸ¤– AUTOSELL: ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ Ð²Ð·ÑÑ‚ÑŒ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚:", itemName)
            end
        end
        
        print("ðŸ¤– AUTOSELL: ÐŸÑ€Ð¾Ð´Ð°Ð¶Ð° Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð°, Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚...")
        
        -- ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼ Ð¾ÑÑ‚Ð°Ð»Ð¸ÑÑŒ Ð»Ð¸ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ñ‹
        task.wait(2) -- Ð”Ð°ÐµÐ¼ Ð²Ñ€ÐµÐ¼Ñ Ð½Ð° Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ Ð¸Ð½Ð²ÐµÐ½Ñ‚Ð°Ñ€Ñ
        local remainingItems = checkInventoryForMaxItems()
        
        if #remainingItems > 0 then
            print("ðŸ¤– AUTOSELL: ÐžÑÑ‚Ð°Ð»Ð¸ÑÑŒ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ñ‹ Ð´Ð»Ñ Ð¿Ñ€Ð¾Ð´Ð°Ð¶Ð¸, Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€ÑÐµÐ¼ Ñ†Ð¸ÐºÐ»...")
            sellItemsToNPC(remainingItems)
        else
            print("ðŸ¤– AUTOSELL: Ð’ÑÐµ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ñ‹ Ð¿Ñ€Ð¾Ð´Ð°Ð½Ñ‹, Ð²Ð¾Ð·Ð¾Ð±Ð½Ð¾Ð²Ð»ÑÐµÐ¼ Ð°Ð²Ñ‚Ð¾Ñ„Ð°Ñ€Ð¼...")
            isSellingToNPC = false
            
            -- Ð’Ð¾Ð·Ð¾Ð±Ð½Ð¾Ð²Ð»ÑÐµÐ¼ Ð°Ð²Ñ‚Ð¾Ñ„Ð°Ñ€Ð¼
            if AutofarmConfig.Enabled then
                startAutofarm()
            end
        end
    end)
end

-- Ð—Ð°Ð¿ÑƒÑÐº Ð°Ð²Ñ‚Ð¾ÑÐµÐ»Ð»Ð°
local function startAutosell()
    if isAutosellEnabled then return end
    isAutosellEnabled = true
    
    print("ðŸ¤– AUTOSELL: Ð—Ð°Ð¿ÑƒÑÐº Ð°Ð²Ñ‚Ð¾ÑÐµÐ»Ð»Ð°...")
    
    -- Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ Ñ‚Ð°Ð¹Ð¼ÐµÑ€ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸ ÐºÐ°Ð¶Ð´Ñ‹Ðµ 5 ÑÐµÐºÑƒÐ½Ð´
    autosellCheckTimer = task.spawn(function()
        while isAutosellEnabled do
            task.wait(5) -- ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼ ÐºÐ°Ð¶Ð´Ñ‹Ðµ 5 ÑÐµÐºÑƒÐ½Ð´
            
            if not isSellingToNPC then
                local itemsAtMax = checkInventoryForMaxItems()
                if #itemsAtMax > 0 then
                    print("ðŸ¤– AUTOSELL: ÐžÐ±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ñ‹ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ñ‹ Ð½Ð° Ð¼Ð°ÐºÑÐ¸Ð¼ÑƒÐ¼Ðµ, Ð·Ð°Ð¿ÑƒÑÐºÐ°ÐµÐ¼ Ð¿Ñ€Ð¾Ð´Ð°Ð¶Ñƒ...")
                    sellItemsToNPC(itemsAtMax)
                end
            end
        end
    end)
end

-- ÐžÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° Ð°Ð²Ñ‚Ð¾ÑÐµÐ»Ð»Ð°
local function stopAutosell()
    if not isAutosellEnabled then return end
    isAutosellEnabled = false
    
    print("ðŸ¤– AUTOSELL: ÐžÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° Ð°Ð²Ñ‚Ð¾ÑÐµÐ»Ð»Ð°...")
    
    if autosellCheckTimer then
        task.cancel(autosellCheckTimer)
        autosellCheckTimer = nil
    end
    
    isSellingToNPC = false
end

-- Player ESP Functions


-- GUI ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚Ñ‹
local teleportBtn = nil

local MenuSettings = {
    BlurEnabled = true,
    AccentColor = Color3.fromRGB(0, 150, 0),
    Language = "English", -- "English" Ð¸Ð»Ð¸ "Russian"
}

--[[Ð£Ð´Ð°Ð»ÐµÐ½ Ð±Ð¾Ð»ÑŒÑˆÐ¾Ð¹ Ð±Ð»Ð¾Ðº Languages Ð´Ð»Ñ ÑÐºÐ¾Ð½Ð¾Ð¼Ð¸Ð¸ Ð¿Ð°Ð¼ÑÑ‚Ð¸]]
local function getText(key) return key end

--[[local Languages = {
    English = {
        MainFunctions = "MAIN FUNCTIONS",
        YBAHacks = "YBA HACKS",
        MenuSettings = "MENU SETTINGS",
        
        BlurEffect = "Blur Effect",
        AccentColor = "Accent Color", 
        Language = "Language",
        
        ESP = "ESP",
        TeamCheck = "Team Check",
        ShowOutline = "Show Outline",
        ShowLines = "Show Lines",
        RainbowColors = "Rainbow Colors",
        Aimbot = "Aimbot",
        VisibilityCheck = "Visibility Check",
        FOVRainbow = "FOV Rainbow",
        Fly = "Fly",
        SpeedHack = "SpeedHack",
        UseJumpPowerMethod = "Use JumpPower Method",
        LongJump = "Long Jump",
        InfiniteJump = "Infinite Jump",
        ForceNoClip = "Force NoClip",
        TeleportToPlayer = "Teleport to Player",
        SelectedPlayer = "Selected Player",
        SelectPlayerForTeleport = "Select Player for Teleport",
        YBAStandRange = "YBA Stand Range",
        UndergroundFlight = "Underground Flight",
        ItemESP = "Item ESP",
        AntiTimeStop = "ANTI TIME STOP",
        StartTeleport = "START TELEPORT",
        StopTeleport = "STOP TELEPORT",
        -- YBA Items
        MysteriousArrow = "Mysterious Arrow",
        Rokakaka = "Rokakaka",
        PureRokakaka = "Pure Rokakaka",
        Diamond = "Diamond",
        GoldCoin = "Gold Coin",
        SteelBall = "Steel Ball",
        Clackers = "Clackers",
        CaesarsHeadband = "Caesar's Headband",
        ZeppeliHat = "Zeppeli's Hat",
        ZeppeliScarf = "Zeppeli's Scarf",
        QuintonsGlove = "Quinton's Glove",
        StoneMask = "Stone Mask",
        RibCage = "Rib Cage of The Saint's Corpse",
        AncientScroll = "Ancient Scroll",
        DiosDiary = "DIO's Diary",
        LuckyStoneMask = "Lucky Stone Mask",
        LuckyArrow = "Lucky Arrow",
    },
    Russian = {
        MainFunctions = "ÐžÐ¡ÐÐžÐ’ÐÐ«Ð• Ð¤Ð£ÐÐšÐ¦Ð˜Ð˜",
        YBAHacks = "YBA Ð¥ÐÐšÐ˜",
        MenuSettings = "ÐÐÐ¡Ð¢Ð ÐžÐ™ÐšÐ˜ ÐœÐ•ÐÐ®",
        
        BlurEffect = "Ð­Ñ„Ñ„ÐµÐºÑ‚ Ñ€Ð°Ð·Ð¼Ñ‹Ñ‚Ð¸Ñ",
        AccentColor = "Ð¦Ð²ÐµÑ‚ Ð°ÐºÑ†ÐµÐ½Ñ‚Ð°",
        Language = "Ð¯Ð·Ñ‹Ðº",
        
        ESP = "ESP",
        TeamCheck = "ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹",
        ShowOutline = "ÐŸÐ¾ÐºÐ°Ð·Ð°Ñ‚ÑŒ Ð¾Ð±Ð²Ð¾Ð´ÐºÑƒ",
        ShowLines = "ÐŸÐ¾ÐºÐ°Ð·Ð°Ñ‚ÑŒ Ð»Ð¸Ð½Ð¸Ð¸",
        RainbowColors = "Ð Ð°Ð´ÑƒÐ¶Ð½Ñ‹Ðµ Ñ†Ð²ÐµÑ‚Ð°",
        Aimbot = "ÐÐ¸Ð¼Ð±Ð¾Ñ‚",
        VisibilityCheck = "ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð²Ð¸Ð´Ð¸Ð¼Ð¾ÑÑ‚Ð¸",
        FOVRainbow = "Ð Ð°Ð´ÑƒÐ¶Ð½Ñ‹Ð¹ FOV",
        Fly = "ÐŸÐ¾Ð»ÐµÑ‚",
        SpeedHack = "Ð£ÑÐºÐ¾Ñ€ÐµÐ½Ð¸Ðµ",
        UseJumpPowerMethod = "Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ Ð¼ÐµÑ‚Ð¾Ð´ JumpPower",
        LongJump = "Ð”Ð»Ð¸Ð½Ð½Ñ‹Ð¹ Ð¿Ñ€Ñ‹Ð¶Ð¾Ðº",
        InfiniteJump = "Ð‘ÐµÑÐºÐ¾Ð½ÐµÑ‡Ð½Ñ‹Ð¹ Ð¿Ñ€Ñ‹Ð¶Ð¾Ðº",
        ForceNoClip = "ÐŸÑ€Ð¸Ð½ÑƒÐ´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ð¹ NoClip",
        TeleportToPlayer = "Ð¢ÐµÐ»ÐµÐ¿Ð¾Ñ€Ñ‚ Ðº Ð¸Ð³Ñ€Ð¾ÐºÑƒ",
        SelectedPlayer = "Ð’Ñ‹Ð±Ñ€Ð°Ð½Ð½Ñ‹Ð¹ Ð¸Ð³Ñ€Ð¾Ðº",
        SelectPlayerForTeleport = "Ð’Ñ‹Ð±Ñ€Ð°Ñ‚ÑŒ Ð¸Ð³Ñ€Ð¾ÐºÐ° Ð´Ð»Ñ Ñ‚ÐµÐ»ÐµÐ¿Ð¾Ñ€Ñ‚Ð°",
        YBAStandRange = "YBA Ð”Ð°Ð»ÑŒÐ½Ð¾ÑÑ‚ÑŒ ÑÑ‚ÐµÐ½Ð´Ð°",
        UndergroundFlight = "ÐŸÐ¾Ð´Ð·ÐµÐ¼Ð½Ñ‹Ð¹ Ð¿Ð¾Ð»ÐµÑ‚",
        ItemESP = "ESP Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ð¾Ð²",
        AntiTimeStop = "ÐÐÐ¢Ð˜ ÐžÐ¡Ð¢ÐÐÐžÐ’ÐšÐ Ð’Ð Ð•ÐœÐ•ÐÐ˜",
        StartTeleport = "ÐÐÐ§ÐÐ¢Ð¬ Ð¢Ð•Ð›Ð•ÐŸÐžÐ Ð¢",
        StopTeleport = "ÐžÐ¡Ð¢ÐÐÐžÐ’Ð˜Ð¢Ð¬ Ð¢Ð•Ð›Ð•ÐŸÐžÐ Ð¢",
        -- YBA Items
        MysteriousArrow = "Ð¢Ð°Ð¸Ð½ÑÑ‚Ð²ÐµÐ½Ð½Ð°Ñ ÑÑ‚Ñ€ÐµÐ»Ð°",
        Rokakaka = "Ð Ð¾ÐºÐ°ÐºÐ°ÐºÐ°",
        PureRokakaka = "Ð§Ð¸ÑÑ‚Ð°Ñ Ñ€Ð¾ÐºÐ°ÐºÐ°ÐºÐ°",
        Diamond = "ÐÐ»Ð¼Ð°Ð·",
        GoldCoin = "Ð—Ð¾Ð»Ð¾Ñ‚Ð°Ñ Ð¼Ð¾Ð½ÐµÑ‚Ð°",
        SteelBall = "Ð¡Ñ‚Ð°Ð»ÑŒÐ½Ð¾Ð¹ ÑˆÐ°Ñ€",
        Clackers = "ÐšÐ»Ð°ÐºÐµÑ€Ñ‹",
        CaesarsHeadband = "ÐŸÐ¾Ð²ÑÐ·ÐºÐ° Ð¦ÐµÐ·Ð°Ñ€Ñ",
        ZeppeliHat = "Ð¨Ð»ÑÐ¿Ð° Ð¦ÐµÐ¿Ð¿ÐµÐ»Ð¸",
        ZeppeliScarf = "Ð¨Ð°Ñ€Ñ„ Ð¦ÐµÐ¿Ð¿ÐµÐ»Ð¸",
        QuintonsGlove = "ÐŸÐµÑ€Ñ‡Ð°Ñ‚ÐºÐ° ÐšÐ²Ð¸Ð½Ñ‚Ð¾Ð½Ð°",
        StoneMask = "ÐšÐ°Ð¼ÐµÐ½Ð½Ð°Ñ Ð¼Ð°ÑÐºÐ°",
        RibCage = "Ð ÐµÐ±Ñ€Ð¾ ÑÐ²ÑÑ‚Ð¾Ð³Ð¾ ÐºÐ¾Ñ€Ð¿ÑƒÑÐ°",
        AncientScroll = "Ð”Ñ€ÐµÐ²Ð½Ð¸Ð¹ ÑÐ²Ð¸Ñ‚Ð¾Ðº",
        DiosDiary = "Ð”Ð½ÐµÐ²Ð½Ð¸Ðº Ð”Ð˜Ðž",
        LuckyStoneMask = "Ð¡Ñ‡Ð°ÑÑ‚Ð»Ð¸Ð²Ð°Ñ ÐºÐ°Ð¼ÐµÐ½Ð½Ð°Ñ Ð¼Ð°ÑÐºÐ°",
        LuckyArrow = "Ð¡Ñ‡Ð°ÑÑ‚Ð»Ð¸Ð²Ð°Ñ ÑÑ‚Ñ€ÐµÐ»Ð°",
    }
}]]

local function updateBlurEffect()
    if glassEffect then
        glassEffect.Visible = MenuSettings.BlurEnabled
    end
    if glassBorder then
        glassBorder.Transparency = MenuSettings.BlurEnabled and 0.7 or 1
    end
    if rightPanel then
        rightPanel.BackgroundTransparency = MenuSettings.BlurEnabled and 0.15 or 0.05
    end
end

local function updateAccentColor()
    local reopenButton = screenGui:FindFirstChild("ReopenButton")
    if reopenButton then
        reopenButton.BackgroundColor3 = MenuSettings.AccentColor
    end
    
    for _, child in pairs(functionsContainer:GetChildren()) do
        if child:IsA("Frame") then
            local sliderBack = child:FindFirstChild("SliderBack")
            if sliderBack and sliderBack.BackgroundColor3 ~= Color3.fromRGB(100, 100, 100) then
                sliderBack.BackgroundColor3 = MenuSettings.AccentColor
            end
        end
    end
    
    for _, btn in pairs(leftPanel:GetChildren()) do
        if btn:IsA("TextButton") and btn.BackgroundColor3 == Color3.fromRGB(40, 40, 45) then
            local highlight = btn:FindFirstChild("Highlight")
            if highlight then
                highlight.BackgroundColor3 = MenuSettings.AccentColor
            end
        end
    end
end

local function updateAllTexts()
    if contentTitle then
        if selectedTab == "Main" then
            contentTitle.Text = getText("MainFunctions")
        elseif selectedTab == "YBA Hacks" then
            contentTitle.Text = getText("YBAHacks")
        elseif selectedTab == "Settings" then
            contentTitle.Text = getText("MenuSettings")
        end
    end
    
    showContent(selectedTab)
end

local YBAFreeCamera = {} do
    local RunService = game:GetService("RunService")
    local UserInputService = game:GetService("UserInputService")
    local Camera = workspace.CurrentCamera

    local fcRunning = false
    local cameraPos = Vector3.new()
    local cameraRot = Vector2.new()
    local targetStand = nil
    local originalCameraCFrame = nil
    local originalCameraType = nil
    local cameraDistance = 12
    local cameraHeight = 8
    local renderConnection = nil
    local inputConnections = {}
    local lastDebugTime = 0

    local NAV_SPEED = 1

    local input = {
        W = false, A = false, S = false, D = false,
        Space = false, LeftControl = false,
        LeftShift = false, -- Ð”Ð¾Ð±Ð°Ð²Ð»ÑÐµÐ¼ Shift Ð´Ð»Ñ ÑˆÐ¸Ñ„Ñ‚Ð»Ð¾ÐºÐ°
        MouseDelta = Vector2.new(),
        MouseWheel = 0
    }

    local function startInput()
        -- ÐžÑ‡Ð¸Ñ‰Ð°ÐµÐ¼ ÑÑ‚Ð°Ñ€Ñ‹Ðµ ÑÐ¾ÐµÐ´Ð¸Ð½ÐµÐ½Ð¸Ñ
        for _, connection in pairs(inputConnections) do
            if connection then connection:Disconnect() end
        end
        inputConnections = {}

        -- ÐŸÑ€Ð¾ÑÑ‚Ð¾Ðµ Ð¾Ñ‚ÑÐ»ÐµÐ¶Ð¸Ð²Ð°Ð½Ð¸Ðµ Ð²Ð²Ð¾Ð´Ð° Ñ‡ÐµÑ€ÐµÐ· UserInputService
        table.insert(inputConnections, UserInputService.InputBegan:Connect(function(inputObj, gameProcessed)
            -- Ð˜Ð³Ð½Ð¾Ñ€Ð¸Ñ€ÑƒÐµÐ¼ Ð²Ð²Ð¾Ð´ ÐµÑÐ»Ð¸ Ð¸Ð³Ñ€Ð¾Ðº Ð² Ñ‡Ð°Ñ‚Ðµ/Ð¼ÐµÐ½ÑŽ
            if gameProcessed then return end
            local keyName = inputObj.KeyCode.Name
            if input[keyName] ~= nil then
                input[keyName] = true
                print("YBA Input: ÐÐ°Ð¶Ð°Ñ‚Ð° ÐºÐ»Ð°Ð²Ð¸ÑˆÐ°", keyName)
            end
        end))

        table.insert(inputConnections, UserInputService.InputEnded:Connect(function(inputObj, gameProcessed)
            -- Ð˜Ð³Ð½Ð¾Ñ€Ð¸Ñ€ÑƒÐµÐ¼ Ð²Ð²Ð¾Ð´ ÐµÑÐ»Ð¸ Ð¸Ð³Ñ€Ð¾Ðº Ð² Ñ‡Ð°Ñ‚Ðµ/Ð¼ÐµÐ½ÑŽ
            if gameProcessed then return end
            local keyName = inputObj.KeyCode.Name
            if input[keyName] ~= nil then
                input[keyName] = false
                print("YBA Input: ÐžÑ‚Ð¿ÑƒÑ‰ÐµÐ½Ð° ÐºÐ»Ð°Ð²Ð¸ÑˆÐ°", keyName)
            end
        end))

        table.insert(inputConnections, UserInputService.InputChanged:Connect(function(inputObj, gameProcessed)
            -- ÐÐ• Ð¸Ð³Ð½Ð¾Ñ€Ð¸Ñ€ÑƒÐµÐ¼ gameProcessed Ð´Ð»Ñ Ð¼Ñ‹ÑˆÐ¸
            if inputObj.UserInputType == Enum.UserInputType.MouseMovement then
                -- Ð˜Ð¡ÐŸÐ ÐÐ’Ð›Ð•ÐÐž: Ð¸Ð½Ð²ÐµÑ€Ñ‚Ð¸Ñ€ÑƒÐµÐ¼ Ð¾ÑÑŒ X Ð´Ð»Ñ Ð³Ð¾Ñ€Ð¸Ð·Ð¾Ð½Ñ‚Ð°Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ð¿Ð¾Ð²Ð¾Ñ€Ð¾Ñ‚Ð°
                local sensitivity = 0.003
                input.MouseDelta = Vector2.new(inputObj.Delta.y * sensitivity, -inputObj.Delta.x * sensitivity)
                -- print("YBA Input: Ð”Ð²Ð¸Ð¶ÐµÐ½Ð¸Ðµ Ð¼Ñ‹ÑˆÐ¸", input.MouseDelta) -- Ð¡Ð»Ð¸ÑˆÐºÐ¾Ð¼ Ð¼Ð½Ð¾Ð³Ð¾ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ð¹
            elseif inputObj.UserInputType == Enum.UserInputType.MouseWheel then
                -- Ð˜Ð¡ÐŸÐ ÐÐ’Ð›Ð•ÐÐž: Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼ Ñ‡Ñ‚Ð¾ GUI Ð½Ðµ Ð°ÐºÑ‚Ð¸Ð²Ð½Ð¾ Ð¸ Ð½Ðµ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚Ð°Ð½Ð¾ Ð¸Ð³Ñ€Ð¾Ð¹
                if not gameProcessed then
                    input.MouseWheel = -inputObj.Position.Z
                    print("YBA Input: ÐšÐ¾Ð»ÐµÑÐ¾ Ð¼Ñ‹ÑˆÐ¸", input.MouseWheel)
                end
            end
        end))
    end

    local function stopInput()
        for _, connection in pairs(inputConnections) do
            if connection then connection:Disconnect() end
        end
        inputConnections = {}
        
        -- Ð¡Ð±Ñ€Ð¾Ñ Ð²ÑÐµÑ… Ð²Ñ…Ð¾Ð´Ð¾Ð²
        for k in pairs(input) do
            if typeof(input[k]) == "boolean" then 
                input[k] = false 
            elseif typeof(input[k]) == "number" then 
                input[k] = 0 
            end
        end
        input.MouseDelta = Vector2.new()
        input.MouseWheel = 0
    end

    local function stepFreecam(dt)
        if not targetStand or not targetStand.Root or not targetStand.Root.Parent then
            print("YBA: Ð¡Ñ‚ÐµÐ½Ð´ Ð¿Ð¾Ñ‚ÐµÑ€ÑÐ½, Ð¾ÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÐ¼ ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ")
            YBAFreeCamera.Stop()
            return
        end

        local standRoot = targetStand.Root
        local standPosition = standRoot.Position
        
        -- ÐžÑ‚Ð»Ð°Ð´Ð¾Ñ‡Ð½Ð°Ñ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ (Ð²Ñ‹Ð²Ð¾Ð´Ð¸Ð¼ ÐºÐ°Ð¶Ð´Ñ‹Ðµ 5 ÑÐµÐºÑƒÐ½Ð´)
        if tick() - lastDebugTime > 5 then
            print("YBA Debug: ÐšÐ°Ð¼ÐµÑ€Ð° Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚, Ð¿Ð¾Ð·Ð¸Ñ†Ð¸Ñ ÑÑ‚ÐµÐ½Ð´Ð°:", standPosition)
            print("YBA Debug: Ð¡Ð¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ Ð²Ð²Ð¾Ð´Ð° - W:", input.W, "A:", input.A, "S:", input.S, "D:", input.D, "Shift:", input.LeftShift)
            lastDebugTime = tick()
        end

        -- Ð”Ð²Ð¸Ð¶ÐµÐ½Ð¸Ðµ ÑÑ‚ÐµÐ½Ð´Ð° Ñ‡ÐµÑ€ÐµÐ· Ð¿Ñ€ÑÐ¼ÑƒÑŽ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÑƒ ÐºÐ»Ð°Ð²Ð¸Ñˆ (Ð¾Ð±Ñ…Ð¾Ð´ Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²ÐºÐ¸ YBA)
        local moveX = 0
        local moveZ = 0 
        local moveY = 0
        
        -- Ð£Ð»ÑƒÑ‡ÑˆÐµÐ½Ð½Ð°Ñ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ°, Ñ‡Ñ‚Ð¾ Ð¸Ð³Ñ€Ð¾Ðº Ð½Ðµ Ð² Ñ‡Ð°Ñ‚Ðµ/Ð¼ÐµÐ½ÑŽ
        local gameGui = Players.LocalPlayer:FindFirstChild("PlayerGui")
        local chatInFocus = false
        
        -- ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼ Ð¾ÑÐ½Ð¾Ð²Ð½Ð¾Ð¹ Ñ‡Ð°Ñ‚
        if gameGui then
            local chatGui = gameGui:FindFirstChild("Chat")
            if chatGui and chatGui:FindFirstChild("Frame") and chatGui.Frame:FindFirstChild("ChatBarParentFrame") then
                local chatBar = chatGui.Frame.ChatBarParentFrame:FindFirstChild("Frame")
                if chatBar and chatBar:FindFirstChild("BoxFrame") and chatBar.BoxFrame:FindFirstChild("Frame") and chatBar.BoxFrame.Frame:FindFirstChild("ChatBar") then
                    chatInFocus = chatBar.BoxFrame.Frame.ChatBar:IsFocused()
                end
            end
            
            -- Ð”Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð°Ñ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ° - Ð»ÑŽÐ±Ð¾Ð¹ TextBox Ð² Ñ„Ð¾ÐºÑƒÑÐµ
            if not chatInFocus then
                local function checkTextBoxFocus(parent)
                    for _, child in pairs(parent:GetChildren()) do
                        if child:IsA("TextBox") and child:IsFocused() then
                            return true
                        elseif child:IsA("GuiObject") then
                            if checkTextBoxFocus(child) then
                                return true
                            end
                        end
                    end
                    return false
                end
                chatInFocus = checkTextBoxFocus(gameGui)
            end
        end
        
        -- ÐŸÑ€ÑÐ¼Ð°Ñ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ° ÐºÐ»Ð°Ð²Ð¸Ñˆ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ ÐµÑÐ»Ð¸ Ð½Ðµ Ð² Ñ‡Ð°Ñ‚Ðµ Ð¸ Ð²Ð²Ð¾Ð´ Ð½Ðµ Ð¾Ð±Ñ€Ð°Ð±Ð°Ñ‚Ñ‹Ð²Ð°ÐµÑ‚ÑÑ Ð¸Ð³Ñ€Ð¾Ð¹
        if not chatInFocus and not isInputBeingProcessedByGame then
            if UserInputService:IsKeyDown(Enum.KeyCode.D) then
                moveX = moveX + 1
            end
            if UserInputService:IsKeyDown(Enum.KeyCode.A) then
                moveX = moveX - 1
            end
            if UserInputService:IsKeyDown(Enum.KeyCode.S) then
                moveZ = moveZ + 1
            end
            if UserInputService:IsKeyDown(Enum.KeyCode.W) then
                moveZ = moveZ - 1
            end
            if UserInputService:IsKeyDown(Enum.KeyCode.Space) then
                moveY = moveY + 1
            end
            if UserInputService:IsKeyDown(Enum.KeyCode.LeftControl) then
                moveY = moveY - 1
            end
        else
            -- ÐžÑ‚Ð»Ð°Ð´ÐºÐ°: Ð¿Ð¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÐ¼ Ð¿Ð¾Ñ‡ÐµÐ¼Ñƒ Ð²Ð²Ð¾Ð´ Ð·Ð°Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²Ð°Ð½
            if chatInFocus or isInputBeingProcessedByGame then
                -- Ð’Ñ‹Ð²Ð¾Ð´Ð¸Ð¼ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð¿Ñ€Ð¸ Ð½Ð°Ð¶Ð°Ñ‚Ð¸Ð¸ Space Ð´Ð»Ñ Ð¸Ð·Ð±ÐµÐ¶Ð°Ð½Ð¸Ñ ÑÐ¿Ð°Ð¼Ð°
                if UserInputService:IsKeyDown(Enum.KeyCode.Space) then
                    print("YBA: Ð’Ð²Ð¾Ð´ Ð·Ð°Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²Ð°Ð½ - Ñ‡Ð°Ñ‚ Ð² Ñ„Ð¾ÐºÑƒÑÐµ:", chatInFocus, "gameProcessed:", isInputBeingProcessedByGame)
                end
            end
        end
        
        -- Ð’Ð¡Ð•Ð“Ð”Ð Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼ Shift Ð´Ð»Ñ ÑˆÐ¸Ñ„Ñ‚Ð»Ð¾ÐºÐ° (ÐºÐ°Ð¶Ð´Ñ‹Ð¹ ÐºÐ°Ð´Ñ€)
        input.LeftShift = UserInputService:IsKeyDown(Enum.KeyCode.LeftShift)
        
        local move = Vector3.new(moveX, moveY, moveZ)
        
        -- ÐžÑ‚Ð»Ð°Ð´ÐºÐ° Ð´Ð²Ð¸Ð¶ÐµÐ½Ð¸Ñ
        if move.Magnitude > 0 then
            print("YBA: Ð”Ð²Ð¸Ð¶ÐµÐ½Ð¸Ðµ Ð´ÐµÑ‚ÐµÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¾:", moveX, moveY, moveZ)
        end

        local bv = standRoot:FindFirstChild("BodyVelocity")
        if not bv then
            bv = Instance.new("BodyVelocity")
            bv.MaxForce = Vector3.new(4000, 4000, 4000)
            bv.Velocity = Vector3.new(0, 0, 0)
            bv.Parent = standRoot
        end
        
        -- Ð”Ð¾Ð±Ð°Ð²Ð»ÑÐµÐ¼ BodyAngularVelocity Ð´Ð»Ñ Ð¿Ð»Ð°Ð²Ð½Ð¾Ð³Ð¾ Ð¿Ð¾Ð²Ð¾Ñ€Ð¾Ñ‚Ð°
        local bav = standRoot:FindFirstChild("BodyAngularVelocity")
        if not bav then
            bav = Instance.new("BodyAngularVelocity")
            bav.MaxTorque = Vector3.new(0, 4000, 0) -- Ð¢Ð¾Ð»ÑŒÐºÐ¾ Ð¿Ð¾Ð²Ð¾Ñ€Ð¾Ñ‚ Ð¿Ð¾ Y
            bav.AngularVelocity = Vector3.new(0, 0, 0)
            bav.Parent = standRoot
        end
        
        if move.Magnitude > 0 then
            local standSpeed = YBAConfig.UndergroundControl.FlightSpeed or 20
            local cameraCFrame = CFrame.new(standPosition) * CFrame.Angles(0, cameraRot.Y, 0)
            local worldMove = cameraCFrame:VectorToWorldSpace(move)
            bv.Velocity = worldMove * standSpeed
            
            -- Ð£Ð‘Ð ÐÐÐž: Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹ Ð¿Ð¾Ð²Ð¾Ñ€Ð¾Ñ‚ ÑÑ‚ÐµÐ½Ð´Ð° Ð¿Ñ€Ð¸ Ð´Ð²Ð¸Ð¶ÐµÐ½Ð¸Ð¸
        else
            bv.Velocity = Vector3.new(0, 0, 0)
        end

        -- ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ð²Ñ€Ð°Ñ‰ÐµÐ½Ð¸Ñ Ð¼Ñ‹ÑˆÐ¸
        if input.MouseDelta.Magnitude > 0 then
            cameraRot = cameraRot + input.MouseDelta
            cameraRot = Vector2.new(
                math.clamp(cameraRot.X, -math.rad(80), math.rad(80)), 
                cameraRot.Y % (2 * math.pi)
            )
            
            -- Ð˜Ð¡ÐŸÐ ÐÐ’Ð›Ð•ÐÐž: Ð¡Ð¸Ð½Ñ…Ñ€Ð¾Ð½Ð¸Ð·Ð¸Ñ€ÑƒÐµÐ¼ Ð¿Ð¾Ð²Ð¾Ñ€Ð¾Ñ‚ Ð¸Ð³Ñ€Ð¾ÐºÐ° Ñ ÐºÐ°Ð¼ÐµÑ€Ð¾Ð¹ ÑÑ‚ÐµÐ½Ð´Ð°
            local player = Players.LocalPlayer
            if player and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
                local playerRoot = player.Character.HumanoidRootPart
                local targetPlayerCFrame = CFrame.new(playerRoot.Position) * CFrame.Angles(0, cameraRot.Y, 0)
                playerRoot.CFrame = targetPlayerCFrame
            end
            
            input.MouseDelta = Vector2.new()
        end
        
        -- Ð˜Ð¡ÐŸÐ ÐÐ’Ð›Ð•ÐÐž: Ð¡Ñ‚ÐµÐ½Ð´ Ð²ÑÐµÐ³Ð´Ð° ÐºÐ¾Ð¿Ð¸Ñ€ÑƒÐµÑ‚ Ð½Ð°Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ ÐºÐ°Ð¼ÐµÑ€Ñ‹ (Ð½Ðµ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð¿Ñ€Ð¸ Shift)
        local currentPos = standRoot.Position
        local currentCFrame = standRoot.CFrame
        local targetCFrame = CFrame.new(currentPos) * CFrame.Angles(0, cameraRot.Y, 0)
        -- ÐŸÐ»Ð°Ð²Ð½Ñ‹Ð¹ Ð¿Ð¾Ð²Ð¾Ñ€Ð¾Ñ‚ Ð´Ð»Ñ ÐµÑÑ‚ÐµÑÑ‚Ð²ÐµÐ½Ð½Ð¾ÑÑ‚Ð¸
        standRoot.CFrame = currentCFrame:Lerp(targetCFrame, 0.2)
        
        -- Ð”Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾: ÐµÑÐ»Ð¸ Ð·Ð°Ð¶Ð°Ñ‚ Shift - ÑƒÑÐºÐ¾Ñ€ÑÐµÐ¼ Ð¿Ð¾Ð²Ð¾Ñ€Ð¾Ñ‚ ÑÑ‚ÐµÐ½Ð´Ð°
        if input.LeftShift then
            standRoot.CFrame = currentCFrame:Lerp(targetCFrame, 0.5)
        end

        -- ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° ÐºÐ¾Ð»ÐµÑÐ° Ð¼Ñ‹ÑˆÐ¸ Ð´Ð»Ñ Ð·ÑƒÐ¼Ð°
        if input.MouseWheel ~= 0 then
            cameraDistance = math.clamp(cameraDistance + input.MouseWheel * 2, 5, 30)
            input.MouseWheel = 0
        end

        -- Ð˜Ð¡ÐŸÐ ÐÐ’Ð›Ð•ÐÐž: Ð¿Ð¾Ð·Ð¸Ñ†Ð¸Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ ÐºÐ°Ð¼ÐµÑ€Ñ‹ Ð±ÐµÐ· Ð²Ð»Ð¸ÑÐ½Ð¸Ñ Ð·ÑƒÐ¼Ð° Ð½Ð° ÑƒÐ³Ð¾Ð» Ð½Ð°ÐºÐ»Ð¾Ð½Ð°
        local horizontalDistance = cameraDistance
        local verticalOffset = cameraHeight
        
        -- ÐŸÑ€Ð¸Ð¼ÐµÐ½ÑÐµÐ¼ Ð¿Ð¾Ð²Ð¾Ñ€Ð¾Ñ‚ ÐºÐ°Ð¼ÐµÑ€Ñ‹ Ð´Ð»Ñ Ð½Ð°ÐºÐ»Ð¾Ð½Ð°
        local pitchOffset = math.sin(cameraRot.X) * cameraDistance
        local adjustedHorizontalDistance = math.cos(cameraRot.X) * cameraDistance
        
        local cameraOffset = Vector3.new(
            math.sin(cameraRot.Y) * adjustedHorizontalDistance,
            verticalOffset + pitchOffset,
            math.cos(cameraRot.Y) * adjustedHorizontalDistance
        )
        
        local cameraPosition = standPosition + cameraOffset
        local newCameraCFrame = CFrame.lookAt(cameraPosition, standPosition)
        
        -- ÐžÑÑ‚Ð¾Ñ€Ð¾Ð¶Ð½Ð¾ ÑƒÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÐ¼ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ CFrame ÐºÐ°Ð¼ÐµÑ€Ñ‹ (Ð½Ðµ Ñ‚Ð¸Ð¿)
        Camera.CFrame = newCameraCFrame
        
        -- ÐœÑÐ³ÐºÐ¾ Ð¾Ñ‚ÐºÐ»ÑŽÑ‡Ð°ÐµÐ¼ ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ ÐºÐ°Ð¼ÐµÑ€Ð¾Ð¹ Ð¸Ð³Ñ€Ð¾ÐºÐ¾Ð¼
        local player = Players.LocalPlayer
        if player and player.Character then
            local humanoid = player.Character:FindFirstChild("Humanoid")
            if humanoid then
                humanoid.AutoRotate = false
                -- ÐÐ• Ð²ÐºÐ»ÑŽÑ‡Ð°ÐµÐ¼ PlatformStand Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð½Ðµ Ñ‚Ñ€Ð¸Ð³Ð³ÐµÑ€Ð¸Ñ‚ÑŒ Ð°Ð½Ñ‚Ð¸Ñ‡Ð¸Ñ‚
            end
        end
    end

    function YBAFreeCamera.Start(stand)
        if fcRunning then 
            YBAFreeCamera.Stop() 
        end
        
        if not stand or not stand.Root then
            print("YBA: ÐžÑˆÐ¸Ð±ÐºÐ° - ÑÑ‚ÐµÐ½Ð´ Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½")
            return false
        end
        
        print("YBA: Ð—Ð°Ð¿ÑƒÑÐº ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ ÑÑ‚ÐµÐ½Ð´Ð¾Ð¼: " .. stand.Name)
        
        targetStand = stand
        originalCameraCFrame = Camera.CFrame
        originalCameraType = Camera.CameraType
        
        -- ÐžÑ‡Ð¸Ñ‰Ð°ÐµÐ¼ Ð»ÑŽÐ±Ñ‹Ðµ ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÑŽÑ‰Ð¸Ðµ Body Ð¾Ð±ÑŠÐµÐºÑ‚Ñ‹
        for _, bodyObj in pairs(stand.Root:GetChildren()) do
            if bodyObj:IsA("BodyVelocity") or bodyObj:IsA("BodyPosition") or bodyObj:IsA("BodyGyro") then
                bodyObj:Destroy()
            end
        end
        
        -- Ð¡Ð±Ñ€Ð¾Ñ Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ð¾Ð² ÐºÐ°Ð¼ÐµÑ€Ñ‹ Ð¸ ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð¸Ð·Ð°Ñ†Ð¸Ñ Ñ Ð½Ð°Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸ÐµÐ¼ Ð¸Ð³Ñ€Ð¾ÐºÐ°
        cameraDistance = YBAConfig.CameraDistance or 12
        cameraHeight = YBAConfig.CameraHeight or 8
        
        -- Ð˜Ð¡ÐŸÐ ÐÐ’Ð›Ð•ÐÐž: Ð˜Ð½Ð¸Ñ†Ð¸Ð°Ð»Ð¸Ð·Ð¸Ñ€ÑƒÐµÐ¼ ÐºÐ°Ð¼ÐµÑ€Ñƒ Ð² Ð½Ð°Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ð¸ Ð²Ð·Ð³Ð»ÑÐ´Ð° Ð¸Ð³Ñ€Ð¾ÐºÐ°
        local player = Players.LocalPlayer
        if player and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
            local playerCFrame = player.Character.HumanoidRootPart.CFrame
            local playerLookDirection = playerCFrame.LookVector
            local playerYRotation = math.atan2(playerLookDirection.X, playerLookDirection.Z)
            cameraRot = Vector2.new(0, playerYRotation)
            print("YBA: Ð¡Ð¸Ð½Ñ…Ñ€Ð¾Ð½Ð¸Ð·Ð°Ñ†Ð¸Ñ Ñ Ð½Ð°Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸ÐµÐ¼ Ð¸Ð³Ñ€Ð¾ÐºÐ°, ÑƒÐ³Ð¾Ð»:", math.deg(playerYRotation))
        else
            cameraRot = Vector2.new(0, 0)
        end
        
        -- ÐÐ• Ð¿ÐµÑ€ÐµÐºÐ»ÑŽÑ‡Ð°ÐµÐ¼ Ñ‚Ð¸Ð¿ ÐºÐ°Ð¼ÐµÑ€Ñ‹ Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð¾Ð±Ð¾Ð¹Ñ‚Ð¸ Ð°Ð½Ñ‚Ð¸Ñ‡Ð¸Ñ‚ YBA
        print("YBA: Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÑÐµÐ¼ Ð¾Ñ€Ð¸Ð³Ð¸Ð½Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ñ‚Ð¸Ð¿ ÐºÐ°Ð¼ÐµÑ€Ñ‹ Ð´Ð»Ñ Ð¾Ð±Ñ…Ð¾Ð´Ð° Ð°Ð½Ñ‚Ð¸Ñ‡Ð¸Ñ‚Ð°")
        print("YBA: Ð¢ÐµÐºÑƒÑ‰Ð¸Ð¹ Ñ‚Ð¸Ð¿ ÐºÐ°Ð¼ÐµÑ€Ñ‹:", Camera.CameraType)
        
        -- Ð£ÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÐ¼ Ð½Ð°Ñ‡Ð°Ð»ÑŒÐ½ÑƒÑŽ Ð¿Ð¾Ð·Ð¸Ñ†Ð¸ÑŽ ÐºÐ°Ð¼ÐµÑ€Ñ‹ Ð·Ð° ÑÑ‚ÐµÐ½Ð´Ð¾Ð¼ Ñ Ð·Ð°Ð´ÐµÑ€Ð¶ÐºÐ¾Ð¹
        task.wait(0.1) -- ÐÐµÐ±Ð¾Ð»ÑŒÑˆÐ°Ñ Ð·Ð°Ð´ÐµÑ€Ð¶ÐºÐ° Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð½Ðµ Ñ‚Ñ€Ð¸Ð³Ð³ÐµÑ€Ð¸Ñ‚ÑŒ Ð°Ð½Ñ‚Ð¸Ñ‡Ð¸Ñ‚
        local standPosition = stand.Root.Position
        
        -- Ð˜Ð¡ÐŸÐ ÐÐ’Ð›Ð•ÐÐž: ÐŸÐ¾Ð·Ð¸Ñ†Ð¸Ð¾Ð½Ð¸Ñ€ÑƒÐµÐ¼ ÑÑ‚ÐµÐ½Ð´ Ð² Ð½Ð°Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ð¸ Ð²Ð·Ð³Ð»ÑÐ´Ð° Ð¸Ð³Ñ€Ð¾ÐºÐ°
        if player and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
            local playerCFrame = player.Character.HumanoidRootPart.CFrame
            stand.Root.CFrame = CFrame.new(standPosition, standPosition + playerCFrame.LookVector)
            print("YBA: Ð¡Ñ‚ÐµÐ½Ð´ Ð¿Ð¾Ð²ÐµÑ€Ð½ÑƒÑ‚ Ð² Ð½Ð°Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ð¸ Ð¸Ð³Ñ€Ð¾ÐºÐ°")
        end
        
        -- ÐŸÐ¾Ð·Ð¸Ñ†Ð¸Ð¾Ð½Ð¸Ñ€ÑƒÐµÐ¼ ÐºÐ°Ð¼ÐµÑ€Ñƒ Ñ ÑƒÑ‡ÐµÑ‚Ð¾Ð¼ Ð¿Ð¾Ð²Ð¾Ñ€Ð¾Ñ‚Ð° ÑÑ‚ÐµÐ½Ð´Ð°
        local horizontalDistance = math.cos(cameraRot.X) * cameraDistance
        local verticalOffset = math.sin(cameraRot.X) * cameraDistance
        local cameraOffset = Vector3.new(
            math.sin(cameraRot.Y) * horizontalDistance,
            verticalOffset + cameraHeight,
            math.cos(cameraRot.Y) * horizontalDistance
        )
        local initialCameraPosition = standPosition + cameraOffset
        Camera.CFrame = CFrame.lookAt(initialCameraPosition, standPosition)
        print("YBA: Ð£ÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð° Ð½Ð°Ñ‡Ð°Ð»ÑŒÐ½Ð°Ñ Ð¿Ð¾Ð·Ð¸Ñ†Ð¸Ñ ÐºÐ°Ð¼ÐµÑ€Ñ‹:", initialCameraPosition)
        
        -- Ð—Ð°Ð¿ÑƒÑÐºÐ°ÐµÐ¼ Ð²Ð²Ð¾Ð´ Ð¸ Ñ€ÐµÐ½Ð´ÐµÑ€
        print("YBA: Ð—Ð°Ð¿ÑƒÑÐºÐ°ÐµÐ¼ ÑÐ¸ÑÑ‚ÐµÐ¼Ñƒ Ð²Ð²Ð¾Ð´Ð°...")
        startInput()
        print("YBA: ÐŸÐ¾Ð´ÐºÐ»ÑŽÑ‡Ð°ÐµÐ¼ Ñ€ÐµÐ½Ð´ÐµÑ€...")
        -- Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼ RenderStepped Ð²Ð¼ÐµÑÑ‚Ð¾ Heartbeat Ð´Ð»Ñ Ð¼ÐµÐ½ÑŒÑˆÐµÐ¹ Ñ‡Ð°ÑÑ‚Ð¾Ñ‚Ñ‹
        renderConnection = RunService.RenderStepped:Connect(stepFreecam)
        fcRunning = true
        
        print("YBA: Ð£Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ ÑÑ‚ÐµÐ½Ð´Ð¾Ð¼ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ Ð°ÐºÑ‚Ð¸Ð²Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¾!")
        print("YBA: fcRunning =", fcRunning)
        print("YBA: renderConnection =", renderConnection ~= nil)
        return true
    end

    function YBAFreeCamera.Stop()
        if not fcRunning then return end
        
        print("YBA: ÐžÑ‚ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ ÑÑ‚ÐµÐ½Ð´Ð¾Ð¼")
        
        -- ÐžÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÐ¼ Ð²Ð²Ð¾Ð´ Ð¸ Ñ€ÐµÐ½Ð´ÐµÑ€
        stopInput()
        if renderConnection then
            renderConnection:Disconnect()
            renderConnection = nil
        end
        
        -- Ð’Ð¾ÑÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÐ¼ ÐºÐ°Ð¼ÐµÑ€Ñƒ
        if originalCameraType then
            Camera.CameraType = originalCameraType
        else
            Camera.CameraType = Enum.CameraType.Custom
        end
        
        if originalCameraCFrame then
            Camera.CFrame = originalCameraCFrame
        end

        -- ÐžÑ‡Ð¸Ñ‰Ð°ÐµÐ¼ Body Ð¾Ð±ÑŠÐµÐºÑ‚Ñ‹ ÑÑ‚ÐµÐ½Ð´Ð°
        if targetStand and targetStand.Root and targetStand.Root.Parent then
            for _, bodyObj in pairs(targetStand.Root:GetChildren()) do
                if bodyObj:IsA("BodyVelocity") or bodyObj:IsA("BodyPosition") or bodyObj:IsA("BodyGyro") then
                    bodyObj:Destroy()
                end
            end
            -- ÐžÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÐ¼ ÑÑ‚ÐµÐ½Ð´
            targetStand.Root.Velocity = Vector3.new(0, 0, 0)
            if targetStand.Root.AssemblyLinearVelocity then
                targetStand.Root.AssemblyLinearVelocity = Vector3.new(0, 0, 0)
            end
        end

        -- Ð’Ð¾ÑÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÐ¼ ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð¸Ð³Ñ€Ð¾ÐºÐ¾Ð¼
        local player = Players.LocalPlayer
        if player and player.Character then
            local humanoid = player.Character:FindFirstChild("Humanoid")
            if humanoid then
                humanoid.AutoRotate = true
                -- PlatformStand Ð½Ðµ Ñ‚Ñ€Ð¾Ð³Ð°ÐµÐ¼ Ñ‚Ð°Ðº ÐºÐ°Ðº Ð½Ðµ Ð²ÐºÐ»ÑŽÑ‡Ð°Ð»Ð¸
            end
        end
        
        -- Ð¡Ð±Ñ€Ð°ÑÑ‹Ð²Ð°ÐµÐ¼ Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ðµ
        targetStand = nil
        originalCameraCFrame = nil
        originalCameraType = nil
        fcRunning = false
        
        print("YBA: Ð£Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ ÑÑ‚ÐµÐ½Ð´Ð¾Ð¼ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ Ð¾Ñ‚ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¾")
    end

    function YBAFreeCamera.Toggle(stand)
        if fcRunning then
            YBAFreeCamera.Stop()
            return false
        else
            return YBAFreeCamera.Start(stand)
        end
    end
end

local function startFly()
    local plr = Players.LocalPlayer
    local char = plr.Character
    local hum = char and char:FindFirstChildOfClass("Humanoid")
    local root = char and char:FindFirstChild("HumanoidRootPart")
    
    if not hum or not root then return end
    
    isFlying = true
    
    local flyOriginalJumpPower = hum.JumpPower
    local flyOriginalJumpHeight = hum.JumpHeight
    local flyOriginalGravity = workspace.Gravity
    local flyOriginalHipHeight = hum.HipHeight
    
    hum.JumpPower = 0
    hum.JumpHeight = 0
    workspace.Gravity = 0
    hum.HipHeight = 0
    
    local ctrl = {f = 0, b = 0, l = 0, r = 0, u = 0, d = 0}
    
    local inputDown = UserInputService.InputBegan:Connect(function(input, gp)
        if gp then return end
        if input.KeyCode == Enum.KeyCode.W then ctrl.f = 1
        elseif input.KeyCode == Enum.KeyCode.S then ctrl.b = -1
        elseif input.KeyCode == Enum.KeyCode.A then ctrl.l = -1
        elseif input.KeyCode == Enum.KeyCode.D then ctrl.r = 1
        elseif input.KeyCode == Enum.KeyCode.Space then ctrl.u = 1
        elseif input.KeyCode == Enum.KeyCode.LeftControl then ctrl.d = -1 end
    end)
    
    local inputUp = UserInputService.InputEnded:Connect(function(input, gp)
        if gp then return end
        if input.KeyCode == Enum.KeyCode.W then ctrl.f = 0
        elseif input.KeyCode == Enum.KeyCode.S then ctrl.b = 0
        elseif input.KeyCode == Enum.KeyCode.A then ctrl.l = 0
        elseif input.KeyCode == Enum.KeyCode.D then ctrl.r = 0
        elseif input.KeyCode == Enum.KeyCode.Space then ctrl.u = 0
        elseif input.KeyCode == Enum.KeyCode.LeftControl then ctrl.d = 0 end
    end)
    
    local renderConnection = RunService.RenderStepped:Connect(function()
        if not isFlying or not char or not char:FindFirstChild("Humanoid") or not root then
            if hum then
                hum.JumpPower = flyOriginalJumpPower
                hum.JumpHeight = flyOriginalJumpHeight
                hum.HipHeight = flyOriginalHipHeight
            end
            if not isNoClipping then
                workspace.Gravity = flyOriginalGravity
            end
            
            inputDown:Disconnect()
            inputUp:Disconnect()
            renderConnection:Disconnect()
            return
        end
        
        local cam = workspace.CurrentCamera
        if not cam then return end
        
        
        local forward = cam.CFrame.lookVector
        local right = cam.CFrame.rightVector
        local up = Vector3.new(0, 1, 0)
        
        local moveVector = Vector3.new(0, 0, 0)
        moveVector = moveVector + (forward * (ctrl.f + ctrl.b))
        moveVector = moveVector + (right * (ctrl.r + ctrl.l))
        moveVector = moveVector + (up * (ctrl.u + ctrl.d))
        
        if moveVector.Magnitude > 0 then
            moveVector = moveVector.Unit * (MovementConfig.Fly.Speed * 10)
            local bv = root:FindFirstChild("BodyVelocity")
            if not bv then
                bv = Instance.new("BodyVelocity", root)
                bv.MaxForce = Vector3.new(9e9, 9e9, 9e9)
            end
            bv.Velocity = moveVector
        else
            local bv = root:FindFirstChild("BodyVelocity")
            if bv then
                bv.Velocity = Vector3.new(0, 0, 0)
            end
        end
    end)
    
    table.insert(flyConnections, inputDown)
    table.insert(flyConnections, inputUp)
    table.insert(flyConnections, renderConnection)
end

local function stopFly()
    isFlying = false
    
    local char = Players.LocalPlayer.Character
    local hum = char and char:FindFirstChildOfClass("Humanoid")
    local root = char and char:FindFirstChild("HumanoidRootPart")
    
    if hum then
        
        hum.JumpPower = 50
        hum.JumpHeight = 7.2
        hum.HipHeight = 2
    end
    
    workspace.Gravity = 196.2
    
    
    if root then
        local bv = root:FindFirstChild("BodyVelocity")
        if bv then
            bv:Destroy()
        end
    end
    
    
    for _, connection in ipairs(flyConnections) do
        if connection then
            pcall(function() connection:Disconnect() end)
        end
    end
    flyConnections = {}
end

-- Anti Time Stop Functions
local function detectTimeStop()
    local players = Players:GetPlayers()
    local localPlayer = Players.LocalPlayer
    local localChar = localPlayer.Character
    local localRoot = localChar and localChar:FindFirstChild("HumanoidRootPart")
    
    if not localRoot then return false end
    
    for _, player in pairs(players) do
        if player ~= localPlayer then
            local char = player.Character
            if char then
                local stand = char:FindFirstChild("Stand")
                if stand then
                    local standAbilities = stand:FindFirstChild("Abilities")
                    if standAbilities then
                        for _, ability in pairs(standAbilities:GetChildren()) do
                            local abilityName = ability.Name:lower()
                            if abilityName:find("time") or 
                               abilityName:find("stop") or
                               abilityName:find("za warudo") or
                               abilityName:find("the world") or
                               abilityName:find("timestop") or
                               abilityName:find("time_stop") or
                               abilityName:find("za") or
                               abilityName:find("warudo") then
                                return true, player, ability
                            end
                        end
                    end
                    
                    local standName = stand.Name:lower()
                    if standName:find("the world") or 
                       standName:find("za warudo") or
                       standName:find("dio") or
                       standName:find("jotaro") or
                       standName:find("star platinum") or
                       standName:find("the world") then
                        return true, player, stand
                    end
                end
                
                for _, part in pairs(char:GetDescendants()) do
                    if part:IsA("BasePart") then
                        local partName = part.Name:lower()
                        if partName:find("time") or 
                           partName:find("stop") or
                           partName:find("freeze") or
                           partName:find("timestop") then
                            return true, player, part
                        end
                    end
                end
            end
        end
    end
    
    if localChar then
        local hum = localChar:FindFirstChildOfClass("Humanoid")
        if hum then
            for _, part in pairs(localChar:GetDescendants()) do
                if part:IsA("BasePart") and part.Anchored then
                    return true, nil, nil
                end
            end
        end
    end
    
    return false
end

local function createAntiTimeStopEffect()
    if not AntiTimeStopConfig.VisualEffect then return end
    
    local char = Players.LocalPlayer.Character
    if not char then return end
    
    local highlight = Instance.new("Highlight")
    highlight.Name = "AntiTimeStopEffect"
    highlight.FillColor = Color3.fromRGB(0, 255, 0)
    highlight.OutlineColor = Color3.fromRGB(0, 200, 0)
    highlight.FillTransparency = 0.3
    highlight.OutlineTransparency = 0
    highlight.DepthMode = Enum.HighlightDepthMode.AlwaysOnTop
    highlight.Parent = char
    
    antiTimeStopEffect = highlight
end

local function removeAntiTimeStopEffect()
    if antiTimeStopEffect then
        antiTimeStopEffect:Destroy()
        antiTimeStopEffect = nil
    end
end

local function startAntiTimeStop()
    local plr = Players.LocalPlayer
    local char = plr.Character
    local hum = char and char:FindFirstChildOfClass("Humanoid")
    local root = char and char:FindFirstChild("HumanoidRootPart")
    
    if not hum or not root then return end
    
    isAntiTimeStopEnabled = true
    timeStopDetected = false
    
    originalAntiTimeStopWalkSpeed = hum.WalkSpeed
    originalAntiTimeStopJumpPower = hum.JumpPower
    
    hum.WalkSpeed = AntiTimeStopConfig.WalkSpeed * AntiTimeStopConfig.MovementSpeed
    hum.JumpPower = AntiTimeStopConfig.JumpPower
    
    createAntiTimeStopEffect()
    
        print("Anti TS: ÐŸÑ€Ð¸Ð½ÑƒÐ´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ðµ Ð´Ð²Ð¸Ð¶ÐµÐ½Ð¸Ðµ Ð°ÐºÑ‚Ð¸Ð²Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¾")
    
    -- Ð‘Ð•Ð—ÐžÐŸÐÐ¡ÐÐžÐ• Ð¿Ñ€Ð¸Ð½ÑƒÐ´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ðµ Ð´Ð²Ð¸Ð¶ÐµÐ½Ð¸Ðµ
    local antiFreezeLoop = RunService.Heartbeat:Connect(function()
        if not isAntiTimeStopEnabled or not char or not char.Parent then
            return
        end
        
        -- ÐŸÑ€Ð¾ÑÑ‚Ð¾ ÑƒÐ±Ð¸Ñ€Ð°ÐµÐ¼ Anchored Ñ Ð¾ÑÐ½Ð¾Ð²Ð½Ñ‹Ñ… Ñ‡Ð°ÑÑ‚ÐµÐ¹ (Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾)
        if root then
            root.Anchored = false
        end
        
        if hum then
            hum.PlatformStand = false
        end
        
        -- ÐŸÐ Ð˜ÐÐ£Ð”Ð˜Ð¢Ð•Ð›Ð¬ÐÐžÐ• Ð´Ð²Ð¸Ð¶ÐµÐ½Ð¸Ðµ Ñ‡ÐµÑ€ÐµÐ· BodyVelocity (ÐÐ• ÑƒÐ´Ð°Ð»ÑÐµÐ¼ Ð½Ð¸Ñ‡ÐµÐ³Ð¾!)
        local moveVector = Vector3.new(0, 0, 0)
        local cam = workspace.CurrentCamera
        
        -- ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼ Ð½Ð°Ð¶Ð°Ñ‚Ñ‹Ðµ ÐºÐ»Ð°Ð²Ð¸ÑˆÐ¸ Ð¸ Ð¿Ñ€Ð¸Ð½ÑƒÐ´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ Ð´Ð²Ð¸Ð³Ð°ÐµÐ¼
        if UserInputService:IsKeyDown(Enum.KeyCode.W) then
            moveVector = moveVector + cam.CFrame.LookVector
        end
        if UserInputService:IsKeyDown(Enum.KeyCode.S) then
            moveVector = moveVector - cam.CFrame.LookVector
        end
        if UserInputService:IsKeyDown(Enum.KeyCode.A) then
            moveVector = moveVector - cam.CFrame.RightVector
        end
        if UserInputService:IsKeyDown(Enum.KeyCode.D) then
            moveVector = moveVector + cam.CFrame.RightVector
        end
        if UserInputService:IsKeyDown(Enum.KeyCode.Space) then
            moveVector = moveVector + Vector3.new(0, 1, 0)
        end
        
                 -- Ð•ÑÐ»Ð¸ ÐµÑÑ‚ÑŒ Ð´Ð²Ð¸Ð¶ÐµÐ½Ð¸Ðµ - Ð¿Ñ€Ð¸Ð½ÑƒÐ´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ Ð´Ð²Ð¸Ð³Ð°ÐµÐ¼ Ñ‡ÐµÑ€ÐµÐ· BodyVelocity
        if moveVector.Magnitude > 0 and root then
            local bv = root:FindFirstChild("AntiTSBodyVelocity")
            if not bv then
                bv = Instance.new("BodyVelocity")
                bv.Name = "AntiTSBodyVelocity"
                bv.MaxForce = Vector3.new(4000, 4000, 4000)
                bv.Parent = root
            end
            
            bv.Velocity = moveVector.Unit * 20 -- ÐÐ¾Ñ€Ð¼Ð°Ð»ÑŒÐ½Ð°Ñ ÑÐºÐ¾Ñ€Ð¾ÑÑ‚ÑŒ Ð´Ð²Ð¸Ð¶ÐµÐ½Ð¸Ñ
            print("Anti TS: ÐŸÑ€Ð¸Ð½ÑƒÐ´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ Ð´Ð²Ð¸Ð³Ð°ÑŽ Ð¸Ð³Ñ€Ð¾ÐºÐ°")
        else
            -- Ð£Ð±Ð¸Ñ€Ð°ÐµÐ¼ BodyVelocity ÐºÐ¾Ð³Ð´Ð° Ð½Ðµ Ð´Ð²Ð¸Ð³Ð°ÐµÐ¼ÑÑ
            local bv = root and root:FindFirstChild("AntiTSBodyVelocity")
            if bv then
                bv:Destroy()
            end
        end
        
        -- Ð ÐÐ‘ÐžÐ¢ÐÐ•Ðœ Ð¢ÐžÐ›Ð¬ÐšÐž Ð¡ Ð¢Ð’ÐžÐ˜Ðœ Ð¡Ð¢Ð•ÐÐ”ÐžÐœ!
        local myStand = nil
        
        print("Anti TS: Ð˜Ñ‰ÐµÐ¼ Ñ‚Ð²Ð¾Ð¹ ÑÑ‚ÐµÐ½Ð´...")
        print("Anti TS: Range Hack Ð°ÐºÑ‚Ð¸Ð²ÐµÐ½?", isYBAEnabled)
        print("Anti TS: controlledStand ÐµÑÑ‚ÑŒ?", controlledStand ~= nil)
        
        -- Ð¡Ð½Ð°Ñ‡Ð°Ð»Ð° Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼ Ð°ÐºÑ‚Ð¸Ð²ÐµÐ½ Ð»Ð¸ Stand Range Hack - Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼ ÐµÐ³Ð¾ ÑÑ‚ÐµÐ½Ð´
        if isYBAEnabled and controlledStand and controlledStand.Root then
            myStand = controlledStand
            print("Anti TS: Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼ ÑÑ‚ÐµÐ½Ð´ Ð¸Ð· Range Hack -", controlledStand.Name or "Unknown")
        else
            print("Anti TS: Range Hack Ð½ÐµÐ°ÐºÑ‚Ð¸Ð²ÐµÐ½, Ð¸Ñ‰ÐµÐ¼ ÑÑ‚ÐµÐ½Ð´ Ð²Ñ€ÑƒÑ‡Ð½ÑƒÑŽ...")
            
            -- Ð£ÐŸÐ ÐžÐ©Ð•ÐÐÐ«Ð™ Ð¿Ð¾Ð¸ÑÐº - Ð¿Ñ€Ð¾ÑÑ‚Ð¾ Ð¸Ñ‰ÐµÐ¼ Ð’Ð¡Ð• ÑÑ‚ÐµÐ½Ð´Ñ‹ Ñ€ÑÐ´Ð¾Ð¼ Ñ Ð¸Ð³Ñ€Ð¾ÐºÐ¾Ð¼
            for _, obj in pairs(workspace:GetChildren()) do
                if obj:IsA("Model") then
                    local standRoot = obj:FindFirstChild("HumanoidRootPart")
                    if standRoot and root then
                        local distance = (standRoot.Position - root.Position).Magnitude
                        if distance <= 20 then
                            -- ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼ Ñ‡Ñ‚Ð¾ ÑÑ‚Ð¾ ÑÑ‚ÐµÐ½Ð´ (Ð° Ð½Ðµ Ð¸Ð³Ñ€Ð¾Ðº)
                            if obj.Name:find("Stand") or obj.Name:find("stand") or
                               obj.Name:find("SP") or obj.Name:find("TW") or obj.Name:find("KC") or
                               obj.Name:find("CD") or obj.Name:find("GE") or obj.Name:find("SF") or
                               obj.Name:find("MR") or obj.Name:find("PH") or obj.Name:find("SC") then
                                myStand = {Root = standRoot, Model = obj, Name = obj.Name}
                                print("Anti TS: ÐÐ°Ð¹Ð´ÐµÐ½ ÑÑ‚ÐµÐ½Ð´ Ñ€ÑÐ´Ð¾Ð¼ -", obj.Name, "Ñ€Ð°ÑÑÑ‚Ð¾ÑÐ½Ð¸Ðµ:", distance)
                                break
                            end
                        end
                    end
                end
            end
            
            if not myStand then
                print("Anti TS: ÐÐ• ÐÐÐ™Ð”Ð•Ð Ð¡Ð¢Ð•ÐÐ” Ð Ð¯Ð”ÐžÐœ!")
                -- Ð’Ñ‹Ð²Ð¾Ð´Ð¸Ð¼ Ñ‡Ñ‚Ð¾ Ð²Ð¾Ð¾Ð±Ñ‰Ðµ ÐµÑÑ‚ÑŒ Ñ€ÑÐ´Ð¾Ð¼
                for _, obj in pairs(workspace:GetChildren()) do
                    if obj:IsA("Model") and root then
                        local objRoot = obj:FindFirstChild("HumanoidRootPart")
                        if objRoot then
                            local distance = (objRoot.Position - root.Position).Magnitude
                            if distance <= 20 then
                                print("Anti TS: Ð ÑÐ´Ð¾Ð¼ Ð¼Ð¾Ð´ÐµÐ»ÑŒ:", obj.Name, "Ñ€Ð°ÑÑÑ‚Ð¾ÑÐ½Ð¸Ðµ:", distance)
                            end
                        end
                    end
                end
            end
        end
        
        -- Ð•ÑÐ»Ð¸ Ð½Ð°ÑˆÐ»Ð¸ Ñ‚Ð²Ð¾Ð¹ ÑÑ‚ÐµÐ½Ð´ - Ð¿Ñ€Ð¸Ð½ÑƒÐ´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ Ð´Ð²Ð¸Ð³Ð°ÐµÐ¼ ÐµÐ³Ð¾
        if myStand and myStand.Root then
            local standRoot = myStand.Root
            
            -- Ð£Ð±Ð¸Ñ€Ð°ÐµÐ¼ Anchored ÑÐ¾ ÑÑ‚ÐµÐ½Ð´Ð° (Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾)
            standRoot.Anchored = false
            
            -- ÐŸÐ Ð˜ÐÐ£Ð”Ð˜Ð¢Ð•Ð›Ð¬ÐÐž Ð´Ð²Ð¸Ð³Ð°ÐµÐ¼ ÑÑ‚ÐµÐ½Ð´ Ñ‚Ð¾Ð¶Ðµ!
            if moveVector.Magnitude > 0 then
                local standBV = standRoot:FindFirstChild("AntiTSStandBodyVelocity")
                if not standBV then
                    standBV = Instance.new("BodyVelocity")
                    standBV.Name = "AntiTSStandBodyVelocity"
                    standBV.MaxForce = Vector3.new(4000, 4000, 4000)
                    standBV.Parent = standRoot
                end
                
                standBV.Velocity = moveVector.Unit * 25 -- Ð§ÑƒÑ‚ÑŒ Ð±Ñ‹ÑÑ‚Ñ€ÐµÐµ ÑÑ‚ÐµÐ½Ð´Ð°
                print("Anti TS: ÐŸÑ€Ð¸Ð½ÑƒÐ´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ Ð´Ð²Ð¸Ð³Ð°ÑŽ Ð¢Ð’ÐžÐ™ ÑÑ‚ÐµÐ½Ð´", myStand.Name or "Unknown")
            else
                -- Ð£Ð±Ð¸Ñ€Ð°ÐµÐ¼ BodyVelocity ÑÐ¾ ÑÑ‚ÐµÐ½Ð´Ð° ÐºÐ¾Ð³Ð´Ð° Ð½Ðµ Ð´Ð²Ð¸Ð³Ð°ÐµÐ¼ÑÑ
                local standBV = standRoot:FindFirstChild("AntiTSStandBodyVelocity")
                if standBV then
                    standBV:Destroy()
                end
            end
        end
    end)
    
    local attackDetection = RunService.Heartbeat:Connect(function()
        if not isAntiTimeStopEnabled or not timeStopDetected or not char or not char.Parent then
            return
        end
        
        local isAttacking = false
        
        if UserInputService:IsKeyDown(Enum.KeyCode.F) or 
           UserInputService:IsKeyDown(Enum.KeyCode.E) or
           UserInputService:IsKeyDown(Enum.KeyCode.R) or
           UserInputService:IsKeyDown(Enum.KeyCode.T) or
           UserInputService:IsKeyDown(Enum.KeyCode.Y) or
           UserInputService:IsKeyDown(Enum.KeyCode.Q) then
            isAttacking = true
        end
        
        if isAttacking and antiTimeStopEffect then
            antiTimeStopEffect.FillColor = Color3.fromRGB(255, 255, 0)
        else
            if antiTimeStopEffect then
                antiTimeStopEffect.FillColor = Color3.fromRGB(0, 255, 0)
            end
        end
    end)
    
    local timeStopDetection = RunService.Heartbeat:Connect(function()
        if not isAntiTimeStopEnabled or not char or not char.Parent then
            return
        end
        
        local detected, timeStopPlayer, timeStopAbility = detectTimeStop()
        
        if detected and not timeStopDetected then
            timeStopDetected = true
            timeStopStartTime = tick()
            
            if AntiTimeStopConfig.AntiFreeze then
                for _, part in pairs(char:GetDescendants()) do
                    if part:IsA("BasePart") then
                        part.Anchored = false
                        part.CanCollide = true
                    end
                end
            end
            
            if AntiTimeStopConfig.MovementOverride then
                local bv = root:FindFirstChild("AntiTimeStopBodyVelocity")
                if not bv then
                    bv = Instance.new("BodyVelocity", root)
                    bv.Name = "AntiTimeStopBodyVelocity"
                    bv.MaxForce = Vector3.new(9e9, 9e9, 9e9)
                end
                
                local bg = root:FindFirstChild("AntiTimeStopBodyGyro")
                if not bg then
                    bg = Instance.new("BodyGyro", root)
                    bg.Name = "AntiTimeStopBodyGyro"
                    bg.MaxTorque = Vector3.new(9e9, 9e9, 9e9)
                    bg.D = 1000
                    bg.P = 8000
                end
            end
            
            if AntiTimeStopConfig.SoundEffect then
                local sound = Instance.new("Sound", root)
                sound.SoundId = "rbxasset://sounds/electronicpingshort.wav"
                sound.Volume = 0.5
                sound:Play()
                game:GetService("Debris"):AddItem(sound, 2)
            end
            
        elseif not detected and timeStopDetected then
            timeStopDetected = false
            timeStopDuration = tick() - timeStopStartTime
            
            hum.WalkSpeed = originalAntiTimeStopWalkSpeed
            hum.JumpPower = originalAntiTimeStopJumpPower
            
            local bv = root:FindFirstChild("AntiTimeStopBodyVelocity")
            if bv then
                bv:Destroy()
            end
            
            local bg = root:FindFirstChild("AntiTimeStopBodyGyro")
            if bg then
                bg:Destroy()
            end
            
            removeAntiTimeStopEffect()
        end
    end)
    
    local movementOverride = RunService.Heartbeat:Connect(function()
        if not isAntiTimeStopEnabled or not timeStopDetected or not char or not char.Parent then
            return
        end
        
        if AntiTimeStopConfig.MovementOverride then
            local bv = root:FindFirstChild("AntiTimeStopBodyVelocity")
            local bg = root:FindFirstChild("AntiTimeStopBodyGyro")
            
            if bv and bg then
                local moveVector = Vector3.new(0, 0, 0)
                local cam = workspace.CurrentCamera
                
                if UserInputService:IsKeyDown(Enum.KeyCode.W) then
                    moveVector = moveVector + cam.CFrame.lookVector
                end
                if UserInputService:IsKeyDown(Enum.KeyCode.S) then
                    moveVector = moveVector - cam.CFrame.lookVector
                end
                if UserInputService:IsKeyDown(Enum.KeyCode.A) then
                    moveVector = moveVector - cam.CFrame.rightVector
                end
                if UserInputService:IsKeyDown(Enum.KeyCode.D) then
                    moveVector = moveVector + cam.CFrame.rightVector
                end
                if UserInputService:IsKeyDown(Enum.KeyCode.Space) then
                    moveVector = moveVector + Vector3.new(0, 1, 0)
                end
                if UserInputService:IsKeyDown(Enum.KeyCode.LeftControl) then
                    moveVector = moveVector - Vector3.new(0, 1, 0)
                end
                
                if moveVector.Magnitude > 0 then
                    moveVector = moveVector.Unit * (AntiTimeStopConfig.WalkSpeed * AntiTimeStopConfig.MovementSpeed)
                    bv.Velocity = moveVector
                    
                    bg.CFrame = cam.CFrame
                    
                    if AntiTimeStopConfig.ServerSync then
                        local newCFrame = root.CFrame + (moveVector * 0.016)
                        root.CFrame = newCFrame
                        
                        local remoteEvent = game:GetService("ReplicatedStorage"):FindFirstChild("AntiTimeStopMovement")
                        if not remoteEvent then
                            remoteEvent = Instance.new("RemoteEvent")
                            remoteEvent.Name = "AntiTimeStopMovement"
                            remoteEvent.Parent = game:GetService("ReplicatedStorage")
                        end
                        
                        remoteEvent:FireServer(newCFrame)
                    end
                    
                    if AntiTimeStopConfig.VisualEffect and antiTimeStopEffect then
                        antiTimeStopEffect.FillColor = Color3.fromRGB(0, 255, 255)
                    end
                else
                    bv.Velocity = Vector3.new(0, 0, 0)
                    
                    if AntiTimeStopConfig.VisualEffect and antiTimeStopEffect then
                        antiTimeStopEffect.FillColor = Color3.fromRGB(0, 255, 0)
                    end
                end
            end
        end
    end)
    
    local damageProtection = char.Humanoid.Died:Connect(function()
    end)
    
    local healthChanged = hum.HealthChanged:Connect(function(health)
    end)
    
    table.insert(antiTimeStopConnections, antiFreezeLoop)
    table.insert(antiTimeStopConnections, attackDetection)
    table.insert(antiTimeStopConnections, timeStopDetection)
    table.insert(antiTimeStopConnections, movementOverride)
    table.insert(antiTimeStopConnections, damageProtection)
    table.insert(antiTimeStopConnections, healthChanged)
end

local function stopAntiTimeStop()
    isAntiTimeStopEnabled = false
    timeStopDetected = false
    
    local char = Players.LocalPlayer.Character
    local hum = char and char:FindFirstChildOfClass("Humanoid")
    local root = char and char:FindFirstChild("HumanoidRootPart")
    
    if hum then
        hum.WalkSpeed = originalAntiTimeStopWalkSpeed
        hum.JumpPower = originalAntiTimeStopJumpPower
        hum.AutoRotate = true
        hum.AutoJumpEnabled = true
    end
    
    if root then
        local bv = root:FindFirstChild("AntiTimeStopBodyVelocity")
        if bv then
            bv:Destroy()
        end
        
        local bg = root:FindFirstChild("AntiTimeStopBodyGyro")
        if bg then
            bg:Destroy()
        end
    end
    
    removeAntiTimeStopEffect()
    
    for _, connection in ipairs(antiTimeStopConnections) do
        if connection then
            pcall(function() connection:Disconnect() end)
        end
    end
    antiTimeStopConnections = {}
    
    print("Anti Time Stop disabled")
end



local function startNoClip()
    local char = Players.LocalPlayer.Character
    if not char then return end
    
    isNoClipping = true
    
    
    for _, part in pairs(char:GetDescendants()) do
        if part:IsA("BasePart") and part.CanCollide then
            part.CanCollide = false
        end
    end
    
    
    local function noclip()
        if not char or not char.Parent then return end
        
        for _, part in pairs(char:GetDescendants()) do
            if part:IsA("BasePart") and part.CanCollide then
                part.CanCollide = false
            end
        end
    end
    
    
    local noClipLoop = RunService.Heartbeat:Connect(function()
        if not isNoClipping or not char or not char.Parent then
            return
        end
        noclip()
    end)
    
    table.insert(noClipConnections, noClipLoop)
    
    
    local function setupNoClipForPart(part)
        if part:IsA("BasePart") and part.CanCollide then
            part.CanCollide = false
        end
    end
    
    local descendantAdded = char.DescendantAdded:Connect(setupNoClipForPart)
    table.insert(noClipConnections, descendantAdded)
    
    
    task.spawn(function()
        task.wait(0.5)
        if isNoClipping and char and char.Parent then
            noclip()
        end
    end)
end

local function stopNoClip()
    isNoClipping = false
    
    local char = Players.LocalPlayer.Character
    if not char then return end
    
    
    for _, part in pairs(char:GetDescendants()) do
        if part:IsA("BasePart") then
            part.CanCollide = true
        end
    end
    
    
    for _, connection in ipairs(noClipConnections) do
        if connection then
            if typeof(connection) == "RBXScriptConnection" then
                pcall(function() connection:Disconnect() end)
            elseif typeof(connection) == "Instance" then
                pcall(function() connection:Destroy() end)
            end
        end
    end
    noClipConnections = {}
end

local function startSpeedHack()
    local char = Players.LocalPlayer.Character
    local hum = char and char:FindFirstChildOfClass("Humanoid")
    if not hum then return end
    
    isSpeedHacking = true
    originalWalkSpeed = hum.WalkSpeed
    originalJumpPower = hum.JumpPower
    
    hum.WalkSpeed = MovementConfig.Speed.Speed * 16
    
    if MovementConfig.Speed.UseJumpPower then
        hum.JumpPower = MovementConfig.Speed.Speed * 50
    end
    
    local function onCharacterAdded(newChar)
        local newHum = newChar:WaitForChild("Humanoid")
        if isSpeedHacking then
            newHum.WalkSpeed = MovementConfig.Speed.Speed * 16
            if MovementConfig.Speed.UseJumpPower then
                newHum.JumpPower = MovementConfig.Speed.Speed * 50
            end
        end
    end
    
    local characterAddedConnection = Players.LocalPlayer.CharacterAdded:Connect(onCharacterAdded)
    table.insert(speedHackConnections, characterAddedConnection)
    
    local speedLoop = RunService.Heartbeat:Connect(function()
        if not isSpeedHacking then return end
        
        local currentChar = Players.LocalPlayer.Character
        local currentHum = currentChar and currentChar:FindFirstChildOfClass("Humanoid")
        
        if currentHum then
            if currentHum.WalkSpeed ~= MovementConfig.Speed.Speed * 16 then
                currentHum.WalkSpeed = MovementConfig.Speed.Speed * 16
            end
            
            if MovementConfig.Speed.UseJumpPower and currentHum.JumpPower ~= MovementConfig.Speed.Speed * 50 then
                currentHum.JumpPower = MovementConfig.Speed.Speed * 50
            end
        end
    end)
    
    table.insert(speedHackConnections, speedLoop)
end

local function stopSpeedHack()
    isSpeedHacking = false
    
    local char = Players.LocalPlayer.Character
    local hum = char and char:FindFirstChildOfClass("Humanoid")
    if hum then
        hum.WalkSpeed = originalWalkSpeed
        hum.JumpPower = originalJumpPower
    end
    
    for _, connection in ipairs(speedHackConnections) do
        if connection then
            if typeof(connection) == "RBXScriptConnection" then
                pcall(function() connection:Disconnect() end)
            elseif typeof(connection) == "Instance" then
                pcall(function() connection:Destroy() end)
            end
        end
    end
    speedHackConnections = {}
end


local function startLongJump()
    local char = Players.LocalPlayer.Character
    local hum = char and char:FindFirstChildOfClass("Humanoid")
    if not hum then return end
    
    isLongJumping = true
    originalLongJumpPower = hum.JumpPower
    
    hum.JumpPower = MovementConfig.LongJump.JumpPower
    
    
    local function onCharacterAdded(newChar)
        local newHum = newChar:WaitForChild("Humanoid")
        if isLongJumping then
            newHum.JumpPower = MovementConfig.LongJump.JumpPower
        end
    end
    
    local characterAddedConnection = Players.LocalPlayer.CharacterAdded:Connect(onCharacterAdded)
    table.insert(longJumpConnections, characterAddedConnection)
    
    
    local longJumpLoop = RunService.Heartbeat:Connect(function()
        if not isLongJumping then return end
        
        local currentChar = Players.LocalPlayer.Character
        local currentHum = currentChar and currentChar:FindFirstChildOfClass("Humanoid")
        
        if currentHum and currentHum.JumpPower ~= MovementConfig.LongJump.JumpPower then
            currentHum.JumpPower = MovementConfig.LongJump.JumpPower
        end
    end)
    
    table.insert(longJumpConnections, longJumpLoop)
end

local function stopLongJump()
    isLongJumping = false
    
    local char = Players.LocalPlayer.Character
    local hum = char and char:FindFirstChildOfClass("Humanoid")
    if hum then
        hum.JumpPower = originalLongJumpPower
    end
    
    
    for _, connection in ipairs(longJumpConnections) do
        if connection then
            if typeof(connection) == "RBXScriptConnection" then
                pcall(function() connection:Disconnect() end)
            elseif typeof(connection) == "Instance" then
                pcall(function() connection:Destroy() end)
            end
        end
    end
    longJumpConnections = {}
end


local function startInfiniteJump()
    local char = Players.LocalPlayer.Character
    local hum = char and char:FindFirstChildOfClass("Humanoid")
    local root = char and char:FindFirstChild("HumanoidRootPart")
    if not hum or not root then return end
    
    isInfiniteJumping = true
    lastJumpTime = 0
    
    
    local function onJumpRequest()
        if not isInfiniteJumping then return end
        
        local currentTime = tick()
        if currentTime - lastJumpTime < 0.1 then return end 
        
        lastJumpTime = currentTime
        
        
        local bv = Instance.new("BodyVelocity", root)
        bv.MaxForce = Vector3.new(0, math.huge, 0)
        bv.Velocity = Vector3.new(0, MovementConfig.InfiniteJump.JumpPower, 0)
        
        
        task.spawn(function()
            task.wait(0.3)
            if bv and bv.Parent then
                bv:Destroy()
            end
        end)
    end
    
    
    local jumpConnection = hum.Jumping:Connect(onJumpRequest)
    table.insert(infiniteJumpConnections, jumpConnection)
    
    
    local function onInputBegan(input, gameProcessed)
        if gameProcessed then return end
        if input.KeyCode == Enum.KeyCode.Space then
            onJumpRequest()
        end
    end
    
    local inputConnection = UserInputService.InputBegan:Connect(onInputBegan)
    table.insert(infiniteJumpConnections, inputConnection)
    
    
    local function onCharacterAdded(newChar)
        if isInfiniteJumping then
            task.wait(1) 
            startInfiniteJump() 
        end
    end
    
    local characterAddedConnection = Players.LocalPlayer.CharacterAdded:Connect(onCharacterAdded)
    table.insert(infiniteJumpConnections, characterAddedConnection)
end

local function stopInfiniteJump()
    isInfiniteJumping = false
    lastJumpTime = 0
    
    
    for _, connection in ipairs(infiniteJumpConnections) do
        if connection then
            if typeof(connection) == "RBXScriptConnection" then
                pcall(function() connection:Disconnect() end)
            elseif typeof(connection) == "Instance" then
                pcall(function() connection:Destroy() end)
            end
        end
    end
    infiniteJumpConnections = {}
    
    
    local char = Players.LocalPlayer.Character
    local root = char and char:FindFirstChild("HumanoidRootPart")
    if root then
        for _, child in pairs(root:GetChildren()) do
            if child:IsA("BodyVelocity") then
                child:Destroy()
            end
        end
    end
end


local function createStealthTeleport()
    if not TeleportConfig.TargetPlayer then 
        return 
    end
    
    local char = Players.LocalPlayer.Character
    local targetChar = TeleportConfig.TargetPlayer.Character
    if not char or not targetChar then 
        return 
    end
    
    local root = char:FindFirstChild("HumanoidRootPart")
    local targetRoot = targetChar:FindFirstChild("HumanoidRootPart")
    local humanoid = char:FindFirstChild("Humanoid")
    if not root or not targetRoot or not humanoid then 
        return 
    end
    
    isTeleporting = true
    speedResetTimer = 0
    lastSpeedCheck = tick()
    
    
    if not TeleportConfig.OriginalPosition then
        TeleportConfig.OriginalPosition = root.Position
    end
    
    
    if not isNoClipping then
        startNoClip()
    end
    
    
    task.spawn(function()
        task.wait(0.1) 
        if not isNoClipping then
            startNoClip()
        end
        
        
        local char = Players.LocalPlayer.Character
        if char then
            for _, part in pairs(char:GetDescendants()) do
                if part:IsA("BasePart") and part.CanCollide then
                    part.CanCollide = false
                end
            end
        end
    end)
    
    local stealthTeleportLoop = RunService.Heartbeat:Connect(function()
        if not isTeleporting or not targetChar or not targetChar.Parent then
            return
        end
        
        
        if isNoClipping and char and char.Parent then
            for _, part in pairs(char:GetDescendants()) do
                if part:IsA("BasePart") and part.CanCollide then
                    part.CanCollide = false
                end
            end
        end
        
        
        local currentTime = tick()
        speedResetTimer = speedResetTimer + (currentTime - lastSpeedCheck)
        lastSpeedCheck = currentTime
        
        if speedResetTimer >= TeleportConfig.MaxSpeedResetTime then
            speedResetTimer = 0
            
            local bv = root:FindFirstChild("BodyVelocity")
            local safeBehindDistance = lastBehindDistance or 0
            if bv and bv.Velocity.Magnitude > TeleportConfig.SpeedResetThreshold and safeBehindDistance > 5 then
                bv.Velocity = bv.Velocity * 0.8
            end

            if humanoid and humanoid.WalkSpeed > 16 and (safeBehindDistance > 5) then
                humanoid.WalkSpeed = math.max(humanoid.WalkSpeed - 1, 16)
            end
        end
        
        local now = tick()
        local dt = now - lastUpdateTime
        lastUpdateTime = now
        
        local currentTargetRoot = targetChar:FindFirstChild("HumanoidRootPart")
        if currentTargetRoot then
            local targetPos = currentTargetRoot.Position
            local currentPos = root.Position
            local distance = (targetPos - currentPos).Magnitude

                    if lastTeleportPosition then
                local targetMovement = (targetPos - lastTeleportPosition).Magnitude
                if targetMovement > 3 then
                    task.wait(0.02)
                end
            end
            lastTeleportPosition = targetPos
            
            local targetCFrame = currentTargetRoot.CFrame
            local behindPosition = targetCFrame * CFrame.new(0, 0, TeleportConfig.BehindPlayerDistance)
            local behindDistance = (behindPosition.Position - currentPos).Magnitude
            
            local bv = root:FindFirstChild("BodyVelocity")
            if not bv then
                bv = Instance.new("BodyVelocity", root)
                bv.MaxForce = Vector3.new(1e9, 1e9, 1e9)
                bv.Velocity = Vector3.new(0, 0, 0)
            else
                bv.MaxForce = Vector3.new(1e9, 1e9, 1e9)
            end
            
            local bg = root:FindFirstChild("BodyGyro")
            if not bg then
                bg = Instance.new("BodyGyro", root)
                bg.MaxTorque = Vector3.new(1e9, 1e9, 1e9)
                bg.D = 1000
                bg.P = 8000
            else
                bg.MaxTorque = Vector3.new(1e9, 1e9, 1e9)
                bg.D = 1000
                bg.P = 8000
            end
            
            local targetLookVector = targetCFrame.LookVector
            bg.CFrame = CFrame.lookAt(root.Position, root.Position + targetLookVector)
            
            local targetVelocity = currentTargetRoot.Velocity
            local targetSpeed = targetVelocity.Magnitude
            
            local predictionTime = math.clamp(0.05 + (targetSpeed / 300), 0.05, 0.25)
            local predictedPosition = behindPosition.Position + (targetVelocity * predictionTime)
            local predictedDistance = (predictedPosition - currentPos).Magnitude
            
            local adaptiveSpeed = TeleportConfig.TeleportSpeed
            if targetSpeed > 80 then
                adaptiveSpeed = TeleportConfig.TeleportSpeed * 2.5
            elseif targetSpeed > 50 then
                adaptiveSpeed = TeleportConfig.TeleportSpeed * 2.0
            elseif targetSpeed > 20 then
                adaptiveSpeed = TeleportConfig.TeleportSpeed * 1.4
            end
            
            if predictedDistance > 1.5 then
                isStabilizing = false
                stabilizationStartTime = nil
                local direction = (predictedPosition - currentPos).Unit
                local currentVelocity = bv.Velocity
                local targetVelocityVec = direction * adaptiveSpeed
                
                local accelerationFactor = 0.22
                if targetSpeed > 80 then
                    accelerationFactor = 0.5
                elseif targetSpeed > 50 then
                    accelerationFactor = 0.4
                elseif targetSpeed > 30 then
                    accelerationFactor = 0.3
                end
                
                local velocityDiff = targetVelocityVec - currentVelocity
                local acceleration = velocityDiff * accelerationFactor
                
                bv.Velocity = currentVelocity + acceleration
            else
                local direction = (predictedPosition - currentPos).Unit
                local maxCorr = TeleportConfig.MaxCorrectionSpeed or 180
                local correctionSpeed = math.min(predictedDistance * 45, maxCorr)
                
                if targetSpeed > 10 then
                    correctionSpeed = correctionSpeed * 1.15
                end
                
                bv.Velocity = direction * correctionSpeed
                
                if predictedDistance < 0.25 and targetSpeed < 12 then
                    if not isStabilizing then
                        isStabilizing = true
                        stabilizationStartTime = tick()
                    end
                    local elapsed = tick() - (stabilizationStartTime or tick())
                    local smoothFactor = math.clamp(elapsed / (TeleportConfig.StabilizationTime + 1e-6), 0, 1)
                    local smallSpeed = math.min(predictedDistance * 25, 15)
                    local desiredVel = direction * smallSpeed
                    bv.Velocity = bv.Velocity + (desiredVel - bv.Velocity) * math.max(0.55, 0.85 * smoothFactor)
                    if predictedDistance < 0.05 then
                        bv.Velocity = Vector3.new(0, 0, 0)
                    end
                else
                    isStabilizing = false
                    stabilizationStartTime = nil
                end
            end
            
            lastBehindDistance = behindDistance
        end
    end)
    
    table.insert(teleportConnections, stealthTeleportLoop)
end

local function startTeleport()
    if not TeleportConfig.TargetPlayer then 
        return 
    end
    
    local char = Players.LocalPlayer.Character
    local targetChar = TeleportConfig.TargetPlayer.Character
    if not char or not targetChar then 
        return 
    end
    
    local root = char:FindFirstChild("HumanoidRootPart")
    local targetRoot = targetChar:FindFirstChild("HumanoidRootPart")
    if not root or not targetRoot then 
        return 
    end
    
    isTeleporting = true
    lastTeleportPosition = nil
    speedResetTimer = 0
    lastSpeedCheck = tick()
    
    
    TeleportConfig.OriginalPosition = root.Position
    
    
    if not isNoClipping then
        startNoClip()
    end
    
    
    task.spawn(function()
        task.wait(0.1) 
        if not isNoClipping then
            startNoClip()
        end
        
        
        local char = Players.LocalPlayer.Character
        if char then
            for _, part in pairs(char:GetDescendants()) do
                if part:IsA("BasePart") and part.CanCollide then
                    part.CanCollide = false
                end
            end
        end
    end)
    
    if teleportBtn then
        teleportBtn.Text = getText("StopTeleport")
        teleportBtn.BackgroundColor3 = Color3.fromRGB(150,0,0)
    end
    
    createStealthTeleport()
    
    
    task.spawn(function()
        task.wait(0.2)
        if not isNoClipping then
            startNoClip()
        end
        
        
        local char = Players.LocalPlayer.Character
        if char then
            for _, part in pairs(char:GetDescendants()) do
                if part:IsA("BasePart") and part.CanCollide then
                    part.CanCollide = false
                end
            end
        end
    end)
end

local function stopTeleport()
    isTeleporting = false
    lastTeleportPosition = nil
    speedResetTimer = 0
    TeleportConfig.Enabled = false
    
    local char = Players.LocalPlayer.Character
    if not char then 
        return 
    end
    
    local root = char:FindFirstChild("HumanoidRootPart")
    local humanoid = char:FindFirstChild("Humanoid")
    
    
    for _, connection in ipairs(teleportConnections) do
        if connection then
            if typeof(connection) == "RBXScriptConnection" then
                pcall(function() connection:Disconnect() end)
            end
        end
    end
    teleportConnections = {}
    
    
    local bv = root and root:FindFirstChild("BodyVelocity")
    if bv then
        
        bv.Velocity = Vector3.new(0, 0, 0)
        task.wait(0.1) 
        bv:Destroy()
    end
    
    local bg = root and root:FindFirstChild("BodyGyro")
    if bg then
        bg:Destroy()
    end
    
    
    if humanoid then
        humanoid.WalkSpeed = 16
        humanoid.JumpPower = 50
    end
    
    
    if root and TeleportConfig.OriginalPosition then
        
        if not isNoClipping then
            startNoClip()
        end
        
        
        local returnConnections = {}
        
        local returnLoop = RunService.Heartbeat:Connect(function()
            if not root or not root.Parent then
                return
            end
            
            local currentPos = root.Position
            local returnPos = TeleportConfig.OriginalPosition
            local distance = (returnPos - currentPos).Magnitude
            
            if distance > 3 then
                local returnBv = root:FindFirstChild("BodyVelocity")
                if not returnBv then
                    returnBv = Instance.new("BodyVelocity", root)
                    returnBv.MaxForce = Vector3.new(1e6, 1e6, 1e6) 
                end
                
                local returnDirection = (returnPos - currentPos).Unit
                local returnSpeed = TeleportConfig.ReturnSpeed
                
                returnSpeed = returnSpeed + math.random(-5, 5)
                
                returnBv.Velocity = returnDirection * returnSpeed
            else
                
                local returnBv = root:FindFirstChild("BodyVelocity")
                if returnBv then
                    returnBv.Velocity = Vector3.new(0, 0, 0)
                    task.wait(0.5) 
                    returnBv:Destroy()
                end
                
                local returnBg = root:FindFirstChild("BodyGyro")
                if returnBg then
                    returnBg:Destroy()
                end
                
                
                root.CFrame = CFrame.new(TeleportConfig.OriginalPosition)
                TeleportConfig.OriginalPosition = nil
                
                
                local freezeBv = Instance.new("BodyVelocity", root)
                freezeBv.MaxForce = Vector3.new(9e9, 9e9, 9e9)
                freezeBv.Velocity = Vector3.new(0, 0, 0)
                
                task.wait(2) 
                
                if freezeBv then
                    freezeBv:Destroy()
                end
                
                
                task.spawn(function()
                    task.wait(5)
                    if isNoClipping then
                        stopNoClip()
                    end
                end)
                
                
                for _, connection in ipairs(returnConnections) do
                    if connection then
                        pcall(function() connection:Disconnect() end)
                    end
                end
                
                if returnLoop then
                    returnLoop:Disconnect()
                end
            end
        end)
        
        table.insert(returnConnections, returnLoop)
    end
    
    
    local humanoid = char and char:FindFirstChild("Humanoid")
    if humanoid then
        humanoid.WalkSpeed = 16
        humanoid.JumpPower = 50
    end
    
    if teleportBtn then
        teleportBtn.Text = getText("StartTeleport")
        teleportBtn.BackgroundColor3 = Color3.fromRGB(0,150,0)
    end
end

local function findStands()
    local stands = {}
    local player = Players.LocalPlayer
    local playerChar = player.Character
    local playerRoot = playerChar and playerChar:FindFirstChild("HumanoidRootPart")
    
    if not playerRoot then 
        print("YBA: Ð˜Ð³Ñ€Ð¾Ðº Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½ Ð¸Ð»Ð¸ Ð½ÐµÑ‚ HumanoidRootPart")
        return stands 
    end
    
    print("YBA: ÐÐ°Ñ‡Ð¸Ð½Ð°ÐµÐ¼ Ð¿Ð¾Ð¸ÑÐº ÑÑ‚ÐµÐ½Ð´Ð¾Ð² Ð² workspace...")
    
    local standNames = {
        "Stand", "StandModel", "StandPart", "StandRoot", "StandHumanoidRootPart",
        "Star Platinum", "The World", "Hierophant Green", "Magician's Red",
        "Hermit Purple", "Silver Chariot", "Tower of Gray", "Dark Blue Moon",
        "Strength", "Wheel of Fortune", "Hanged Man", "Emperor", "Empress",
        "Judgment", "High Priestess", "Death Thirteen", "Lovers", "Sun",
        "Bastet", "Thunder McQueen", "Anubis", "Khnum", "Tohth", "Horus",
        "Atum", "Osiris", "Horus", "Anubis", "Bastet", "Khnum", "Tohth",
        -- Ð”Ð¾Ð±Ð°Ð²Ð»ÑÐµÐ¼ ÐµÑ‰Ðµ Ð²Ð°Ñ€Ð¸Ð°Ð½Ñ‚Ñ‹
        "stand", "STAND", "GER", "SPTW", "TW", "SP", "KC", "KCR", "CD", "WS", "MIH",
        "TWOH", "SPOH", "D4C", "KQ", "BTD", "SF", "SM", "HP", "SC", "HG", "MR"
    }
    
    local foundCount = 0
    local checkedModels = 0
    
    for _, obj in pairs(workspace:GetDescendants()) do
        if obj:IsA("Model") then
            checkedModels = checkedModels + 1
            local isStand = false
            for _, standName in ipairs(standNames) do
                if obj.Name:find(standName) or obj.Name:lower():find(standName:lower()) then
                    isStand = true
                    print("YBA: ÐÐ°Ð¹Ð´ÐµÐ½Ð° Ð¿Ð¾Ñ‚ÐµÐ½Ñ†Ð¸Ð°Ð»ÑŒÐ½Ð°Ñ Ð¼Ð¾Ð´ÐµÐ»ÑŒ ÑÑ‚ÐµÐ½Ð´Ð°:", obj.Name)
                    break
                end
            end
            
            if isStand then
                local standRoot = obj:FindFirstChild("HumanoidRootPart") or obj:FindFirstChild("StandRoot") or obj:FindFirstChild("RootPart")
                if standRoot then
                    local distance = (standRoot.Position - playerRoot.Position).Magnitude
                    print("YBA: Ð¡Ñ‚ÐµÐ½Ð´", obj.Name, "Ð½Ð° Ñ€Ð°ÑÑÑ‚Ð¾ÑÐ½Ð¸Ð¸:", distance)
                    if distance <= 20 then
                        foundCount = foundCount + 1
                        table.insert(stands, {
                            Model = obj,
                            Root = standRoot,
                            Distance = distance,
                            Name = obj.Name
                        })
                        print("YBA: Ð”Ð¾Ð±Ð°Ð²Ð»ÐµÐ½ ÑÑ‚ÐµÐ½Ð´:", obj.Name)
                    else
                        print("YBA: Ð¡Ñ‚ÐµÐ½Ð´", obj.Name, "ÑÐ»Ð¸ÑˆÐºÐ¾Ð¼ Ð´Ð°Ð»ÐµÐºÐ¾:", distance)
                    end
                else
                    print("YBA: Ð£ Ð¼Ð¾Ð´ÐµÐ»Ð¸", obj.Name, "Ð½ÐµÑ‚ Ð¿Ð¾Ð´Ñ…Ð¾Ð´ÑÑ‰ÐµÐ³Ð¾ Root Ñ‡Ð°ÑÑ‚Ð¸")
                end
            end
        end
    end
    
    print("YBA: ÐŸÑ€Ð¾Ð²ÐµÑ€ÐµÐ½Ð¾ Ð¼Ð¾Ð´ÐµÐ»ÐµÐ¹:", checkedModels, "ÐÐ°Ð¹Ð´ÐµÐ½Ð¾ ÑÑ‚ÐµÐ½Ð´Ð¾Ð²:", foundCount)
    
    if #stands == 0 then
        for _, obj in pairs(workspace:GetDescendants()) do
            if obj:IsA("Model") and obj:FindFirstChild("Humanoid") then
                local standRoot = obj:FindFirstChild("HumanoidRootPart")
                if standRoot then
                    local distance = (standRoot.Position - playerRoot.Position).Magnitude
                    if distance <= 20 then
                        table.insert(stands, {
                            Model = obj,
                            Root = standRoot,
                            Distance = distance,
                            Name = obj.Name
                        })
                    end
                end
            end
        end
    end
    
    table.sort(stands, function(a, b) return a.Distance < b.Distance end)
    return stands
end



local function freezePlayer()
    local player = Players.LocalPlayer
    local char = player.Character
    if not char then return end
    
    local root = char:FindFirstChild("HumanoidRootPart")
    local humanoid = char:FindFirstChild("Humanoid")
    
    if root then
        originalPlayerPosition = root.Position
        originalPlayerCFrame = root.CFrame
        
        local bv = root:FindFirstChild("BodyVelocity")
        if not bv then
            bv = Instance.new("BodyVelocity", root)
            bv.MaxForce = Vector3.new(1e6, 1e6, 1e6)
        end
        bv.Velocity = Vector3.new(0, 0, 0)
        
        local gyro = root:FindFirstChild("BodyGyro")
        if not gyro then
            gyro = Instance.new("BodyGyro", root)
            gyro.MaxTorque = Vector3.new(1e6, 1e6, 1e6)
        end
        gyro.CFrame = root.CFrame
        
        local camera = workspace.CurrentCamera
        if camera then
            camera.CameraType = Enum.CameraType.Scriptable
        end
    end
    
    if humanoid then
        originalYBAWalkSpeed = humanoid.WalkSpeed
        originalYBAJumpPower = humanoid.JumpPower
        humanoid.WalkSpeed = 0
        humanoid.JumpPower = 0
        
        humanoid.AutoRotate = false
        humanoid.AutoJumpEnabled = false
    end
end

local function unfreezePlayer()
    local player = Players.LocalPlayer
    local char = player.Character
    if not char then return end
    
    local root = char:FindFirstChild("HumanoidRootPart")
    local humanoid = char:FindFirstChild("Humanoid")
    
    if root then
        local bv = root:FindFirstChild("BodyVelocity")
        if bv then
            bv:Destroy()
        end
        
        local gyro = root:FindFirstChild("BodyGyro")
        if gyro then
            gyro:Destroy()
        end
    end
    
    if humanoid then
        humanoid.WalkSpeed = originalYBAWalkSpeed
        humanoid.JumpPower = originalYBAJumpPower
        
        humanoid.AutoRotate = true
        humanoid.AutoJumpEnabled = true
    end
end

local function activateFreeCamera(stand)
    if not stand or not stand.Root then 
        print("YBA: ÐžÑˆÐ¸Ð±ÐºÐ° - ÑÑ‚ÐµÐ½Ð´ Ð¸Ð»Ð¸ ÐµÐ³Ð¾ Root Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½")
        return false
    end
    
    print("YBA: ÐÐºÑ‚Ð¸Ð²Ð¸Ñ€ÑƒÐµÐ¼ ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ ÑÑ‚ÐµÐ½Ð´Ð¾Ð¼: " .. stand.Name)

    freeCameraActive = true
    freeCameraTarget = stand

    -- Ð—Ð°Ð¿ÑƒÑÐºÐ°ÐµÐ¼ ÑÐ²Ð¾Ð±Ð¾Ð´Ð½ÑƒÑŽ ÐºÐ°Ð¼ÐµÑ€Ñƒ
    local success = YBAFreeCamera.Start(stand)
    if success then
        print("YBA: Ð£Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ ÑÑ‚ÐµÐ½Ð´Ð¾Ð¼ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ Ð°ÐºÑ‚Ð¸Ð²Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¾!")
        controlledStand = stand -- Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÑÐµÐ¼ ÑÑÑ‹Ð»ÐºÑƒ Ð½Ð° ÐºÐ¾Ð½Ñ‚Ñ€Ð¾Ð»Ð¸Ñ€ÑƒÐµÐ¼Ñ‹Ð¹ ÑÑ‚ÐµÐ½Ð´
        return true
    else
        print("YBA: ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ Ð°ÐºÑ‚Ð¸Ð²Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ ÑÑ‚ÐµÐ½Ð´Ð¾Ð¼")
        freeCameraActive = false
        freeCameraTarget = nil
        return false
    end
end

local function disableFreeCamera()
    if not freeCameraActive then return end
    
    print("YBA: ÐžÑ‚ÐºÐ»ÑŽÑ‡Ð°ÐµÐ¼ ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ ÑÑ‚ÐµÐ½Ð´Ð¾Ð¼")
    
    freeCameraActive = false
    freeCameraTarget = nil

    YBAFreeCamera.Stop()

    local player = Players.LocalPlayer
    if player and player.Character then
        local humanoid = player.Character:FindFirstChild("Humanoid")
        if humanoid then
            humanoid.AutoRotate = true
        end
    end

    for _, connection in ipairs(freeCameraConnections) do
        if connection then
            pcall(function() connection:Disconnect() end)
        end
    end
    freeCameraConnections = {}
    
    print("YBA: Ð£Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ ÑÑ‚ÐµÐ½Ð´Ð¾Ð¼ Ð¾Ñ‚ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¾")

    local player = Players.LocalPlayer
    if player and player.Character then
        local humanoid = player.Character:FindFirstChild("Humanoid")
        if humanoid then
            humanoid.WalkSpeed = originalYBAWalkSpeed
            humanoid.JumpPower = originalYBAJumpPower
        end

        local root = player.Character:FindFirstChild("HumanoidRootPart")
        if root then
            local bv = root:FindFirstChild("BodyVelocity")
            if bv then
                bv:Destroy()
            end
            
            local gyro = root:FindFirstChild("BodyGyro")
            if gyro then
                gyro:Destroy()
            end
        end
    end
end

local function controlStand(stand)
    if not stand or not stand.Root then 
        print("YBA: ÐžÑˆÐ¸Ð±ÐºÐ° - ÑÑ‚ÐµÐ½Ð´ Ð¸Ð»Ð¸ ÐµÐ³Ð¾ Root Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½")
        return 
    end
    
    print("YBA: ÐÐ°Ñ‡Ð¸Ð½Ð°ÐµÐ¼ ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ ÑÑ‚ÐµÐ½Ð´Ð¾Ð¼: " .. stand.Name)
    controlledStand = stand

    if activateFreeCamera(stand) then
        print("YBA: Ð¡Ð²Ð¾Ð±Ð¾Ð´Ð½Ð°Ñ ÐºÐ°Ð¼ÐµÑ€Ð° Ð°ÐºÑ‚Ð¸Ð²Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð° Ð´Ð»Ñ ÑÑ‚ÐµÐ½Ð´Ð°: " .. stand.Name)
    else
        print("YBA: ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ Ð°ÐºÑ‚Ð¸Ð²Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ ÑÐ²Ð¾Ð±Ð¾Ð´Ð½ÑƒÑŽ ÐºÐ°Ð¼ÐµÑ€Ñƒ Ð´Ð»Ñ ÑÑ‚ÐµÐ½Ð´Ð°: " .. stand.Name)
    end
end

local function startYBA()
    if isYBAEnabled then 
        print("YBA: Ð£Ð¶Ðµ Ð°ÐºÑ‚Ð¸Ð²Ð¸Ñ€Ð¾Ð²Ð°Ð½!")
        return 
    end
    
    print("YBA: ÐÐ°Ñ‡Ð¸Ð½Ð°ÐµÐ¼ Ð°ÐºÑ‚Ð¸Ð²Ð°Ñ†Ð¸ÑŽ Stand Range...")
    isYBAEnabled = true
    YBAConfig.Enabled = true
    
    if not findStands then 
        print("YBA: Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ findStands Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½Ð°!")
        return 
    end
    
    print("YBA: Ð˜Ñ‰ÐµÐ¼ ÑÑ‚ÐµÐ½Ð´Ñ‹...")
    local stands = findStands()
    print("YBA: ÐÐ°Ð¹Ð´ÐµÐ½Ð¾ ÑÑ‚ÐµÐ½Ð´Ð¾Ð²:", #stands)
    
    if #stands == 0 then 
        print("YBA: Ð¡Ñ‚ÐµÐ½Ð´Ñ‹ Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½Ñ‹! ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ, Ñ‡Ñ‚Ð¾ Ñƒ Ð²Ð°Ñ ÐµÑÑ‚ÑŒ ÑÑ‚ÐµÐ½Ð´.")
        isYBAEnabled = false
        YBAConfig.Enabled = false
        return 
    end
    
    local targetStand = stands[1]
    print("YBA: Ð’Ñ‹Ð±Ñ€Ð°Ð½ ÑÑ‚ÐµÐ½Ð´:", targetStand.Name, "Ð¢Ð¸Ð¿ Ð¼Ð¾Ð´ÐµÐ»Ð¸:", targetStand.Model.ClassName)
    
    print("YBA: ÐÐ°Ð¹Ð´ÐµÐ½ ÑÑ‚ÐµÐ½Ð´: " .. targetStand.Name .. " Ð½Ð° Ñ€Ð°ÑÑÑ‚Ð¾ÑÐ½Ð¸Ð¸: " .. targetStand.Distance)
    
    -- ÐžÑ‚ÑÐ¾ÐµÐ´Ð¸Ð½ÑÐµÐ¼ ÑÑ‚ÐµÐ½Ð´ Ð¾Ñ‚ Ð¸Ð³Ñ€Ð¾ÐºÐ° (Ð´ÐµÐ»Ð°ÐµÐ¼ ÐµÐ³Ð¾ ÑÐ²Ð¾Ð±Ð¾Ð´Ð½Ñ‹Ð¼)
    local player = Players.LocalPlayer
    if targetStand.Root and targetStand.Model then
        print("YBA: ÐžÑ‚ÑÐ¾ÐµÐ´Ð¸Ð½ÑÐµÐ¼ ÑÑ‚ÐµÐ½Ð´ Ð¾Ñ‚ Ð¸Ð³Ñ€Ð¾ÐºÐ°...")
        
        -- ÐœÑÐ³ÐºÐ¾ Ð¾Ñ‚ÐºÐ»ÑŽÑ‡Ð°ÐµÐ¼ Ð°Ð²Ñ‚Ð¾ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ ÑÑ‚ÐµÐ½Ð´Ð¾Ð¼
        local humanoid = targetStand.Model:FindFirstChild("Humanoid")
        if humanoid then
            -- ÐÐ• Ð²ÐºÐ»ÑŽÑ‡Ð°ÐµÐ¼ PlatformStand Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð½Ðµ Ñ‚Ñ€Ð¸Ð³Ð³ÐµÑ€Ð¸Ñ‚ÑŒ Ð°Ð½Ñ‚Ð¸Ñ‡Ð¸Ñ‚
            humanoid.Sit = false
            humanoid.Jump = false
            humanoid.AutoRotate = false
        end
        
        -- Ð£Ð±Ð¸Ñ€Ð°ÐµÐ¼ Ð¿Ñ€Ð¸Ð²ÑÐ·ÐºÑƒ Ðº Ð¸Ð³Ñ€Ð¾ÐºÑƒ Ñ‡ÐµÑ€ÐµÐ· Weld/Motor6D Ð¸ Attachment
        local connectionsRemoved = 0
        for _, child in pairs(targetStand.Root:GetChildren()) do
            if child:IsA("Weld") or child:IsA("Motor6D") or child:IsA("ManualWeld") then
                print("YBA: ÐÐ°Ð¹Ð´ÐµÐ½Ð° ÑÐ²ÑÐ·ÑŒ:", child.Name, child.ClassName)
                if (child.Part0 and child.Part0.Parent == player.Character) or 
                   (child.Part1 and child.Part1.Parent == player.Character) then
                    print("YBA: Ð£Ð´Ð°Ð»ÑÐµÐ¼ ÑÐ²ÑÐ·ÑŒ Ñ Ð¸Ð³Ñ€Ð¾ÐºÐ¾Ð¼:", child.Name)
                    child:Destroy()
                    connectionsRemoved = connectionsRemoved + 1
                end
            elseif child:IsA("Attachment") then
                -- Ð£Ð´Ð°Ð»ÑÐµÐ¼ Ð²ÑÐµ Attachment'Ñ‹ ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ðµ Ð¼Ð¾Ð³ÑƒÑ‚ ÑÐ²ÑÐ·Ñ‹Ð²Ð°Ñ‚ÑŒ Ñ Ð¸Ð³Ñ€Ð¾ÐºÐ¾Ð¼
                print("YBA: ÐÐ°Ð¹Ð´ÐµÐ½Ð° Ð¿Ñ€Ð¸Ð²ÑÐ·ÐºÐ°:", child.Name, child.ClassName)
                if child.Name == "StandAttach" or child.Name == "RootRigAttachment" then
                    print("YBA: Ð£Ð´Ð°Ð»ÑÐµÐ¼ Ð¿Ð¾Ð´Ð¾Ð·Ñ€Ð¸Ñ‚ÐµÐ»ÑŒÐ½ÑƒÑŽ Ð¿Ñ€Ð¸Ð²ÑÐ·ÐºÑƒ:", child.Name)
                    child:Destroy()
                    connectionsRemoved = connectionsRemoved + 1
                end
            end
        end
        
        -- Ð¢Ð°ÐºÐ¶Ðµ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼ Ð²ÑÐµ Ñ‡Ð°ÑÑ‚Ð¸ ÑÑ‚ÐµÐ½Ð´Ð° Ð½Ð° ÑÐ²ÑÐ·Ð¸ Ð¸ Ð¾Ð³Ñ€Ð°Ð½Ð¸Ñ‡ÐµÐ½Ð¸Ñ
        for _, part in pairs(targetStand.Model:GetDescendants()) do
            if part:IsA("BasePart") then
                for _, child in pairs(part:GetChildren()) do
                    if child:IsA("Weld") or child:IsA("Motor6D") or child:IsA("ManualWeld") then
                        if (child.Part0 and child.Part0.Parent == player.Character) or 
                           (child.Part1 and child.Part1.Parent == player.Character) then
                            print("YBA: Ð£Ð´Ð°Ð»ÑÐµÐ¼ ÑÐ²ÑÐ·ÑŒ Ð¸Ð· Ñ‡Ð°ÑÑ‚Ð¸", part.Name, ":", child.Name)
                            child:Destroy()
                            connectionsRemoved = connectionsRemoved + 1
                        end
                    elseif child:IsA("AlignPosition") or child:IsA("AlignOrientation") or child:IsA("BodyPosition") or child:IsA("BodyAngularVelocity") then
                        -- Ð£Ð´Ð°Ð»ÑÐµÐ¼ Ð²ÑÐµ Ð¾Ð³Ñ€Ð°Ð½Ð¸Ñ‡ÐµÐ½Ð¸Ñ Ð¿Ð¾Ð·Ð¸Ñ†Ð¸Ð¸/Ð¾Ñ€Ð¸ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ð¸
                        print("YBA: Ð£Ð´Ð°Ð»ÑÐµÐ¼ Ð¾Ð³Ñ€Ð°Ð½Ð¸Ñ‡ÐµÐ½Ð¸Ðµ Ð¸Ð· Ñ‡Ð°ÑÑ‚Ð¸", part.Name, ":", child.Name, child.ClassName)
                        child:Destroy()
                        connectionsRemoved = connectionsRemoved + 1
                    end
                end
            end
        end
        
        print("YBA: Ð£Ð´Ð°Ð»ÐµÐ½Ð¾ ÑÐ²ÑÐ·ÐµÐ¹ Ñ Ð¸Ð³Ñ€Ð¾ÐºÐ¾Ð¼:", connectionsRemoved)
        
        -- ÐÐ»ÑŒÑ‚ÐµÑ€Ð½Ð°Ñ‚Ð¸Ð²Ð½Ñ‹Ð¹ ÑÐ¿Ð¾ÑÐ¾Ð±: Ð¿ÐµÑ€ÐµÐ¼ÐµÑÑ‚Ð¸Ñ‚ÑŒ ÑÑ‚ÐµÐ½Ð´ Ð² workspace Ð¸ ÑÐ´ÐµÐ»Ð°Ñ‚ÑŒ Ð½ÐµÐ·Ð°Ð²Ð¸ÑÐ¸Ð¼Ñ‹Ð¼
        if targetStand.Model.Parent ~= workspace then
            print("YBA: ÐŸÐµÑ€ÐµÐ¼ÐµÑ‰Ð°ÐµÐ¼ ÑÑ‚ÐµÐ½Ð´ Ð² workspace Ð¸Ð·", targetStand.Model.Parent.Name)
            targetStand.Model.Parent = workspace
        end
        
        -- Ð”ÐµÐ»Ð°ÐµÐ¼ ÑÑ‚ÐµÐ½Ð´ Ð¿Ð¾Ð»Ð½Ð¾ÑÑ‚ÑŒÑŽ Ð½ÐµÐ·Ð°Ð²Ð¸ÑÐ¸Ð¼Ñ‹Ð¼
        targetStand.Root.CanCollide = false
        targetStand.Root.Anchored = false
        
        -- Ð£Ð±Ð¸Ñ€Ð°ÐµÐ¼ Ð²ÑÐµ ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÑŽÑ‰Ð¸Ðµ Body Ð¾Ð±ÑŠÐµÐºÑ‚Ñ‹
        for _, child in pairs(targetStand.Root:GetChildren()) do
            if child:IsA("BodyVelocity") or child:IsA("BodyPosition") or child:IsA("BodyGyro") or child:IsA("BodyAngularVelocity") then
                print("YBA: Ð£Ð´Ð°Ð»ÑÐµÐ¼ Body Ð¾Ð±ÑŠÐµÐºÑ‚:", child.Name, child.ClassName)
                child:Destroy()
                connectionsRemoved = connectionsRemoved + 1
            end
        end
        
        -- ÐŸÐ¾Ð·Ð¸Ñ†Ð¸Ð¾Ð½Ð¸Ñ€ÑƒÐµÐ¼ ÑÑ‚ÐµÐ½Ð´ Ñ€ÑÐ´Ð¾Ð¼ Ñ Ð¸Ð³Ñ€Ð¾ÐºÐ¾Ð¼ Ð¿Ð¾ÑÐ»Ðµ Ð¾Ñ‚ÑÐ¾ÐµÐ´Ð¸Ð½ÐµÐ½Ð¸Ñ
        if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
            local playerRoot = player.Character.HumanoidRootPart
            local standPosition = playerRoot.Position + playerRoot.CFrame.LookVector * 5
            targetStand.Root.CFrame = CFrame.new(standPosition, playerRoot.Position)
            targetStand.Root.Anchored = false
            
            -- ÐžÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÐ¼ Ð»ÑŽÐ±Ð¾Ðµ ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÑŽÑ‰ÐµÐµ Ð´Ð²Ð¸Ð¶ÐµÐ½Ð¸Ðµ ÑÑ‚ÐµÐ½Ð´Ð°
            targetStand.Root.Velocity = Vector3.new(0, 0, 0)
            targetStand.Root.AssemblyLinearVelocity = Vector3.new(0, 0, 0)
            
            print("YBA: Ð¡Ñ‚ÐµÐ½Ð´ Ð¿Ð¾Ð·Ð¸Ñ†Ð¸Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½ Ð½Ð°:", standPosition)
        end
        
        print("YBA: Ð¡Ñ‚ÐµÐ½Ð´ Ð¾Ñ‚ÑÐ¾ÐµÐ´Ð¸Ð½ÐµÐ½ Ð¸ Ð³Ð¾Ñ‚Ð¾Ð² Ðº ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸ÑŽ")
    end
    
    if YBAConfig.FreezePlayer and freezePlayer then 
        print("YBA: Ð—Ð°Ð¼Ð¾Ñ€Ð°Ð¶Ð¸Ð²Ð°ÐµÐ¼ Ð¸Ð³Ñ€Ð¾ÐºÐ°...")
        freezePlayer() 
    end
    if YBAConfig.SwitchCamera then 
        print("YBA: ÐŸÐµÑ€ÐµÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ ÐºÐ°Ð¼ÐµÑ€Ñ‹ Ð²ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¾")
    end
    if YBAConfig.TransferControl and activateFreeCamera then 
        print("YBA: ÐÐºÑ‚Ð¸Ð²Ð¸Ñ€ÑƒÐµÐ¼ ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ ÑÑ‚ÐµÐ½Ð´Ð¾Ð¼...")
        activateFreeCamera(targetStand) 
    end
    
    local char = player.Character
    local humanoid = char and char:FindFirstChild("Humanoid")
    if humanoid then
        local deathConnection = humanoid.Died:Connect(function()
            stopYBA()
        end)
        table.insert(standControlConnections, deathConnection)
    end
    task.spawn(function()
        task.wait(5)
        if not isYBAEnabled then return end
        if startUndergroundControl then startUndergroundControl() end
    end)
end

local function stopYBA()
    if not isYBAEnabled then return end
    
    isYBAEnabled = false
    YBAConfig.Enabled = false
    
    if disableFreeCamera then
        disableFreeCamera()
    end
    if unfreezePlayer then
        unfreezePlayer()
    end
    
    for _, connection in ipairs(standControlConnections) do
        if connection then
            pcall(function() connection:Disconnect() end)
        end
    end
    standControlConnections = {}
    controlledStand = nil
    
    print("Stand Range Hack Ð´ÐµÐ°ÐºÑ‚Ð¸Ð²Ð¸Ñ€Ð¾Ð²Ð°Ð½")
    print("ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸ Ð¾Ñ‚ÐºÐ»ÑŽÑ‡Ð°ÐµÐ¼ Underground Flight...")
    if stopUndergroundControl then
        stopUndergroundControl()
    end
end

local function startUndergroundControl()
    print("=== Ð—ÐÐŸÐ£Ð¡Ðš ÐŸÐžÐ”Ð—Ð•ÐœÐÐžÐ“Ðž ÐŸÐžÐ›Ð•Ð¢Ð ===")
    
    if isUndergroundControlEnabled then 
        print("ÐŸÐ¾Ð´Ð·ÐµÐ¼Ð½Ñ‹Ð¹ Ð¿Ð¾Ð»ÐµÑ‚ ÑƒÐ¶Ðµ Ð°ÐºÑ‚Ð¸Ð²ÐµÐ½!")
        return 
    end
    
    local plr = Players.LocalPlayer
    local char = plr.Character
    local hum = char and char:FindFirstChildOfClass("Humanoid")
    local root = char and char:FindFirstChild("HumanoidRootPart")
    
    if not hum or not root then 
        print("ÐŸÐµÑ€ÑÐ¾Ð½Ð°Ð¶ Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½!")
        return 
    end
    
    print("ÐŸÐµÑ€ÑÐ¾Ð½Ð°Ð¶ Ð½Ð°Ð¹Ð´ÐµÐ½, Ð¿Ð¾Ð·Ð¸Ñ†Ð¸Ñ:", root.Position)
    
    if not findStands then
        print("Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ findStands Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½Ð°!")
        return
    end
    
    local stands = findStands()
    if #stands == 0 then
        print("Ð¡Ñ‚ÐµÐ½Ð´Ñ‹ Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½Ñ‹! Ð£Ð±ÐµÐ´Ð¸Ñ‚ÐµÑÑŒ, Ñ‡Ñ‚Ð¾ Ñƒ Ð²Ð°Ñ ÐµÑÑ‚ÑŒ ÑÑ‚ÐµÐ½Ð´.")
        return
    end
    
    controlledStandForUnderground = stands[1].Root
    isUndergroundControlEnabled = true
    
    print("ÐÐ°Ð¹Ð´ÐµÐ½ ÑÑ‚ÐµÐ½Ð´:", stands[1].Name, "Ð½Ð° Ñ€Ð°ÑÑÑ‚Ð¾ÑÐ½Ð¸Ð¸:", stands[1].Distance)
    print("ÐŸÐµÑ€ÐµÐ¼ÐµÑ‰Ð°ÐµÐ¼ Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð¶Ð° Ð¿Ð¾Ð´ ÑÑ‚ÐµÐ½Ð´ Ð½Ð° 40 Ð¼ÐµÑ‚Ñ€Ð¾Ð² Ð²Ð½Ð¸Ð·")
    
    if not YBAConfig.UndergroundControl.OriginalPosition then
        YBAConfig.UndergroundControl.OriginalPosition = root.Position
        print("Ð˜ÑÑ…Ð¾Ð´Ð½Ð°Ñ Ð¿Ð¾Ð·Ð¸Ñ†Ð¸Ñ ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð°:", root.Position)
    end
    
    if YBAConfig.UndergroundControl.AutoNoClip and not isNoClipping and startNoClip then
        startNoClip()
        print("NoClip Ð²ÐºÐ»ÑŽÑ‡ÐµÐ½ Ð´Ð»Ñ Ð¿Ð¾Ð´Ð·ÐµÐ¼Ð½Ð¾Ð³Ð¾ Ð¿Ð¾Ð»ÐµÑ‚Ð°")
    elseif not startNoClip then
        print("ÐžÐ¨Ð˜Ð‘ÐšÐ: Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ startNoClip Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½Ð°!")
    end
    
    local flyOriginalJumpPower = hum.JumpPower
    local flyOriginalJumpHeight = hum.JumpHeight
    local flyOriginalGravity = workspace.Gravity
    local flyOriginalHipHeight = hum.HipHeight
    
    hum.JumpPower = 0
    hum.JumpHeight = 0
    workspace.Gravity = 0
    hum.HipHeight = 0
    
    local standPos = controlledStandForUnderground.Position
    local undergroundPos = Vector3.new(standPos.X, standPos.Y - 40, standPos.Z)
    
    print("Ð¡Ñ‚ÐµÐ½Ð´ Ð¿Ð¾Ð·Ð¸Ñ†Ð¸Ñ:", standPos)
    print("Ð¦ÐµÐ»ÐµÐ²Ð°Ñ Ð¿Ð¾Ð´Ð·ÐµÐ¼Ð½Ð°Ñ Ð¿Ð¾Ð·Ð¸Ñ†Ð¸Ñ:", undergroundPos)
    print("Ð¢ÐµÐºÑƒÑ‰Ð°Ñ Ð¿Ð¾Ð·Ð¸Ñ†Ð¸Ñ Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð¶Ð°:", root.Position)
    
    local initialBv = Instance.new("BodyVelocity", root)
    initialBv.MaxForce = Vector3.new(9e9, 9e9, 9e9)
    local direction = (undergroundPos - root.Position).Unit
    local speed = 200
    initialBv.Velocity = direction * speed
    
    print("Ð¡Ð¾Ð·Ð´Ð°Ð½ BodyVelocity ÑÐ¾ ÑÐºÐ¾Ñ€Ð¾ÑÑ‚ÑŒÑŽ:", initialBv.Velocity)
    
    task.spawn(function()
        task.wait(1)
        if initialBv and initialBv.Parent then
            initialBv:Destroy()
            print("ÐÐ°Ñ‡Ð°Ð»ÑŒÐ½Ñ‹Ð¹ BodyVelocity ÑƒÐ´Ð°Ð»ÐµÐ½")
        end
    end)
    
    print("Ð—Ð°Ð¿ÑƒÑÐºÐ°ÐµÐ¼ Ð¾ÑÐ½Ð¾Ð²Ð½Ð¾Ð¹ Ñ†Ð¸ÐºÐ» Ð¿Ð¾Ð´Ð·ÐµÐ¼Ð½Ð¾Ð³Ð¾ Ð¿Ð¾Ð»ÐµÑ‚Ð°...")
    local undergroundFlyLoop = RunService.RenderStepped:Connect(function()
        if not isUndergroundControlEnabled or not controlledStandForUnderground or not controlledStandForUnderground.Parent then
            print("ÐŸÐ¾Ð´Ð·ÐµÐ¼Ð½Ñ‹Ð¹ Ð¿Ð¾Ð»ÐµÑ‚ Ð¾ÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½ - ÑÑ‚ÐµÐ½Ð´ Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½ Ð¸Ð»Ð¸ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ñ Ð¾Ñ‚ÐºÐ»ÑŽÑ‡ÐµÐ½Ð°")
            if hum then
                hum.JumpPower = flyOriginalJumpPower
                hum.JumpHeight = flyOriginalJumpHeight
                hum.HipHeight = flyOriginalHipHeight
            end
            if not isNoClipping then
                workspace.Gravity = flyOriginalGravity
            end
            return
        end
        
        local char = Players.LocalPlayer.Character
        local root = char and char:FindFirstChild("HumanoidRootPart")
        if not root then 
            if isUndergroundControlEnabled then
                stopUndergroundControl()
            end
            return 
        end
        
        local standPos = controlledStandForUnderground.Position
        local targetPos = Vector3.new(standPos.X, standPos.Y - 40, standPos.Z)
        
        local bv = root:FindFirstChild("BodyVelocity")
        if not bv then
            bv = Instance.new("BodyVelocity", root)
            bv.MaxForce = Vector3.new(9e9, 9e9, 9e9)
        end
        
        local direction = (targetPos - root.Position).Unit
        local distance = (targetPos - root.Position).Magnitude
        
        if distance > 2 then
            local flySpeed = math.floor(YBAConfig.UndergroundControl.FlightSpeed)
            
            if isShiftPressed then
                flySpeed = flySpeed + 50
            end
            
            local currentVelocity = bv.Velocity
            local targetVelocity = direction * flySpeed
            local smoothedVelocity = currentVelocity + (targetVelocity - currentVelocity) * 0.15
            bv.Velocity = smoothedVelocity
        elseif distance > 0.5 then
            local flySpeed = math.floor(YBAConfig.UndergroundControl.FlightSpeed * 0.2)
            
            if isShiftPressed then
                flySpeed = flySpeed + 10
            end
            
            local currentVelocity = bv.Velocity
            local targetVelocity = direction * flySpeed
            local smoothedVelocity = currentVelocity + (targetVelocity - currentVelocity) * 0.1
            bv.Velocity = smoothedVelocity
        else
            bv.Velocity = Vector3.new(0, 0, 0)
        end
    end)
    
    table.insert(undergroundControlConnections, undergroundFlyLoop)
    
    local humanoid = char and char:FindFirstChild("Humanoid")
    if humanoid then
        local deathConnection = humanoid.Died:Connect(function()
            print("Ð˜Ð³Ñ€Ð¾Ðº ÑƒÐ¼ÐµÑ€, Ð¾Ñ‚ÐºÐ»ÑŽÑ‡Ð°ÐµÐ¼ Underground Flight...")
            stopUndergroundControl()
        end)
        table.insert(undergroundControlConnections, deathConnection)
    end
    
    print("ÐŸÐ¾Ð»ÐµÑ‚ Ð¿Ð¾Ð´ Ð·ÐµÐ¼Ð»ÐµÐ¹ Ð·Ð° ÑÑ‚ÐµÐ½Ð´Ð¾Ð¼ Ð°ÐºÑ‚Ð¸Ð²Ð¸Ñ€Ð¾Ð²Ð°Ð½!")
    print("ÐŸÐµÑ€ÑÐ¾Ð½Ð°Ð¶ Ð¿ÐµÑ€ÐµÐ½ÐµÑÐµÐ½ Ð¿Ð¾Ð´ ÑÑ‚ÐµÐ½Ð´ Ð½Ð° Ñ€Ð°ÑÑÑ‚Ð¾ÑÐ½Ð¸Ð¸ 40 Ð¼ÐµÑ‚Ñ€Ð¾Ð² Ð¿Ð¾Ð´ Ð·ÐµÐ¼Ð»ÐµÐ¹")
end

local function stopUndergroundControl()
    if not isUndergroundControlEnabled then return end
    
    isUndergroundControlEnabled = false
    
    local char = Players.LocalPlayer.Character
    local hum = char and char:FindFirstChildOfClass("Humanoid")
    local root = char and char:FindFirstChild("HumanoidRootPart")
    
    if hum then
        hum.JumpPower = 50
        hum.JumpHeight = 7.2
        hum.HipHeight = 2
    end
    
    workspace.Gravity = 196.2
    
    if root then
        local bv = root:FindFirstChild("BodyVelocity")
        if bv then
            bv:Destroy()
        end
    end
    
    for _, connection in ipairs(undergroundControlConnections) do
        if connection then
            pcall(function() connection:Disconnect() end)
        end
    end
    undergroundControlConnections = {}
    
    if YBAConfig.UndergroundControl.OriginalPosition then
        if root then
            print("ÐŸÐ»Ð°Ð²Ð½Ð¾ Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÐ¼ Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð¶Ð° Ð² Ð¸ÑÑ…Ð¾Ð´Ð½ÑƒÑŽ Ð¿Ð¾Ð·Ð¸Ñ†Ð¸ÑŽ...")
            
            local returnBv = Instance.new("BodyVelocity", root)
            returnBv.MaxForce = Vector3.new(9e9, 9e9, 9e9)
            
            local direction = (YBAConfig.UndergroundControl.OriginalPosition - root.Position).Unit
            local distance = (YBAConfig.UndergroundControl.OriginalPosition - root.Position).Magnitude
            local returnSpeed = 100
            
            returnBv.Velocity = direction * returnSpeed
            
            local returnConnection = RunService.Heartbeat:Connect(function()
                local currentDistance = (YBAConfig.UndergroundControl.OriginalPosition - root.Position).Magnitude
                
                if currentDistance < 2 then
                    returnBv:Destroy()
                    returnConnection:Disconnect()
                    YBAConfig.UndergroundControl.OriginalPosition = nil
                    print("ÐŸÐµÑ€ÑÐ¾Ð½Ð°Ð¶ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰ÐµÐ½ Ð² Ð¸ÑÑ…Ð¾Ð´Ð½ÑƒÑŽ Ð¿Ð¾Ð·Ð¸Ñ†Ð¸ÑŽ")
                end
            end)
        end
    end
    
    controlledStandForUnderground = nil
    
    print("ÐŸÐ¾Ð»ÐµÑ‚ Ð¿Ð¾Ð´ Ð·ÐµÐ¼Ð»ÐµÐ¹ Ð·Ð° ÑÑ‚ÐµÐ½Ð´Ð¾Ð¼ Ð¾Ñ‚ÐºÐ»ÑŽÑ‡ÐµÐ½!")
end

local function getAlivePlayers()
    local alivePlayers = {}
    
    if not Players then
        return alivePlayers
    end
    
    if not Players.LocalPlayer then
        return alivePlayers
    end
    
    local allPlayers = Players:GetPlayers()
    if not allPlayers then
        return alivePlayers
    end
    
    for i, player in ipairs(allPlayers) do
        if player then
            if player ~= Players.LocalPlayer then
                if player.Character then
                    local humanoid = player.Character:FindFirstChild("Humanoid")
                    if humanoid then
                        if humanoid.Health > 0 then
                            table.insert(alivePlayers, player)
                        end
                    end
                end
            end
        end
    end
    
    return alivePlayers
end

-- Ð“Ð»Ð¾Ð±Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸Ðº Ð´Ð»Ñ Ð¾Ñ‚ÑÐ»ÐµÐ¶Ð¸Ð²Ð°Ð½Ð¸Ñ Ð²Ð²Ð¾Ð´Ð° Ð² Ñ‡Ð°Ñ‚Ðµ/GUI
UserInputService.InputBegan:Connect(function(input, gameProcessed)
    -- ÐžÐ±Ð½Ð¾Ð²Ð»ÑÐµÐ¼ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ: ÐµÑÐ»Ð¸ gameProcessed = true, Ð·Ð½Ð°Ñ‡Ð¸Ñ‚ Ð²Ð²Ð¾Ð´ Ð¾Ð±Ñ€Ð°Ð±Ð°Ñ‚Ñ‹Ð²Ð°ÐµÑ‚ÑÑ Ð¸Ð³Ñ€Ð¾Ð¹ (Ñ‡Ð°Ñ‚, Ð¼ÐµÐ½ÑŽ Ð¸ Ñ‚.Ð´.)
    if input.KeyCode == Enum.KeyCode.Space then
        isInputBeingProcessedByGame = gameProcessed
        if gameProcessed then
            print("YBA: ÐŸÑ€Ð¾Ð±ÐµÐ» Ð·Ð°Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²Ð°Ð½ - gameProcessed = true (Ñ‡Ð°Ñ‚/GUI Ð°ÐºÑ‚Ð¸Ð²Ð½Ð¾)")
        end
    end
end)

UserInputService.InputEnded:Connect(function(input, gameProcessed)
    -- ÐŸÑ€Ð¸ Ð¾Ñ‚Ð¿ÑƒÑÐºÐ°Ð½Ð¸Ð¸ ÐºÐ»Ð°Ð²Ð¸ÑˆÐ¸ ÑÐ±Ñ€Ð°ÑÑ‹Ð²Ð°ÐµÐ¼ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ ÐµÑÐ»Ð¸ ÑÑ‚Ð¾ Ð±Ñ‹Ð» Ð¿Ñ€Ð¾Ð±ÐµÐ»
    if input.KeyCode == Enum.KeyCode.Space then
        isInputBeingProcessedByGame = false
    end
end)

UserInputService.InputBegan:Connect(function(input, gp)
    if not gp then
        if MovementConfig.Fly.ToggleKey and input.KeyCode == MovementConfig.Fly.ToggleKey then
            MovementConfig.Fly.Enabled = not MovementConfig.Fly.Enabled
            if MovementConfig.Fly.Enabled then 
                startFly() 
            else 
                stopFly() 
            end
            
            if guiCallbacks.fly then
                guiCallbacks.fly.Text = "Fly: " .. (MovementConfig.Fly.Enabled and "ON" or "OFF")
            end
        elseif MovementConfig.NoClip.ToggleKey and input.KeyCode == MovementConfig.NoClip.ToggleKey then
            MovementConfig.NoClip.Enabled = not MovementConfig.NoClip.Enabled
            if MovementConfig.NoClip.Enabled then 
                startNoClip() 
            else 
                stopNoClip() 
            end
            
            if guiCallbacks.noClip then
                guiCallbacks.noClip.Text = "NoClip: " .. (MovementConfig.NoClip.Enabled and "ON" or "OFF")
            end
        elseif MovementConfig.Speed.ToggleKey and input.KeyCode == MovementConfig.Speed.ToggleKey then
            MovementConfig.Speed.Enabled = not MovementConfig.Speed.Enabled
            if MovementConfig.Speed.Enabled then 
                startSpeedHack() 
            else 
                stopSpeedHack() 
            end
            
            if guiCallbacks.speedHack then
                guiCallbacks.speedHack.Text = "SpeedHack: " .. (MovementConfig.Speed.Enabled and "ON" or "OFF")
            end
        elseif TeleportConfig.ToggleKey and input.KeyCode == TeleportConfig.ToggleKey then
            if TeleportConfig.Enabled then
                stopTeleport()
                TeleportConfig.Enabled = false
            else
                if TeleportConfig.TargetPlayer then
                    startTeleport()
                    TeleportConfig.Enabled = true
                else
                    print("Ð¡Ð½Ð°Ñ‡Ð°Ð»Ð° Ð²Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð¸Ð³Ñ€Ð¾ÐºÐ° Ð´Ð»Ñ Ñ‚ÐµÐ»ÐµÐ¿Ð¾Ñ€Ñ‚Ð°Ñ†Ð¸Ð¸")
                end
            end
            
            if guiCallbacks.teleport then
                guiCallbacks.teleport.Text = "Ð’Ñ‹Ð±Ñ€Ð°Ð½Ð½Ñ‹Ð¹ Ð¸Ð³Ñ€Ð¾Ðº: " .. (TeleportConfig.SelectedPlayerName or "ÐÐµ Ð²Ñ‹Ð±Ñ€Ð°Ð½")
            end
        elseif MovementConfig.LongJump.ToggleKey and input.KeyCode == MovementConfig.LongJump.ToggleKey then
            MovementConfig.LongJump.Enabled = not MovementConfig.LongJump.Enabled
            if MovementConfig.LongJump.Enabled then 
                startLongJump() 
            else 
                stopLongJump() 
            end
            
            if guiCallbacks.longJump then
                guiCallbacks.longJump.Text = "Long Jump: " .. (MovementConfig.LongJump.Enabled and "ON" or "OFF")
            end
        elseif MovementConfig.InfiniteJump.ToggleKey and input.KeyCode == MovementConfig.InfiniteJump.ToggleKey then
            MovementConfig.InfiniteJump.Enabled = not MovementConfig.InfiniteJump.Enabled
            if MovementConfig.InfiniteJump.Enabled then 
                startInfiniteJump() 
            else 
                stopInfiniteJump() 
            end
            
            if guiCallbacks.infiniteJump then
                guiCallbacks.infiniteJump.Text = "Infinite Jump: " .. (MovementConfig.InfiniteJump.Enabled and "ON" or "OFF")
            end
        elseif MovementConfig.NoClip.ForceToggleKey and input.KeyCode == MovementConfig.NoClip.ForceToggleKey then
            if isNoClipping then
                stopNoClip()
            else
                startNoClip()
            end
        elseif YBAConfig.ToggleKey and input.KeyCode == YBAConfig.ToggleKey then
            if YBAConfig.Enabled then
                stopYBA()
            else
                startYBA()
            end
            
            if guiCallbacks.yba then
                guiCallbacks.yba.Text = "Stand Range Hack: " .. (YBAConfig.Enabled and "ON" or "OFF")
            end

        elseif AntiTimeStopConfig.ToggleKey and input.KeyCode == AntiTimeStopConfig.ToggleKey then
            if not isAntiTimeStopEnabled then
                AntiTimeStopConfig.Enabled = true
                startAntiTimeStop()
                
                if guiCallbacks.antiTimeStop then
                    guiCallbacks.antiTimeStop.Text = "Anti Time Stop: ACTIVATING..."
                end
                
                spawn(function()
                    task.wait(0.5)
                    
                    AntiTimeStopConfig.Enabled = false
                    stopAntiTimeStop()
                    
                    if guiCallbacks.antiTimeStop then
                        guiCallbacks.antiTimeStop.Text = "Anti Time Stop: READY"
                    end
                end)
            else
                if guiCallbacks.antiTimeStop then
                    guiCallbacks.antiTimeStop.Text = "Anti Time Stop: ALREADY ACTIVE"
                    spawn(function()
                        task.wait(1)
                        guiCallbacks.antiTimeStop.Text = "Anti Time Stop: READY"
                    end)
                end
            end
        end
    end
end)

-- ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸ÐºÐ¸ ÐºÐ»Ð°Ð²Ð¸Ñˆ Ð´Ð»Ñ ÑƒÑÐºÐ¾Ñ€ÐµÐ½Ð¸Ñ Ctrl Ð² Stand Range Hack
UserInputService.InputBegan:Connect(function(input, gp)
    if not gp and input.KeyCode == Enum.KeyCode.LeftControl then
        isShiftPressed = true
        print("Ctrl Ð½Ð°Ð¶Ð°Ñ‚ - ÑƒÑÐºÐ¾Ñ€ÐµÐ½Ð¸Ðµ Ð°ÐºÑ‚Ð¸Ð²Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¾")
    end
end)

UserInputService.InputEnded:Connect(function(input, gp)
    if input.KeyCode == Enum.KeyCode.LeftControl then
        isShiftPressed = false
        print("Ctrl Ð¾Ñ‚Ð¿ÑƒÑ‰ÐµÐ½ - ÑƒÑÐºÐ¾Ñ€ÐµÐ½Ð¸Ðµ Ð´ÐµÐ°ÐºÑ‚Ð¸Ð²Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¾")
    end
end)


local ESPs, Lines = {}, {}
local FOVCircle

local FOVCircle = Drawing.new("Circle")
FOVCircle.Thickness = 2
FOVCircle.NumSides = 100
FOVCircle.Filled = false
FOVCircle.Visible = false


local function getName(p)
    return p.Name
end
local function getHealth(p)
    local h = p.Character and p.Character:FindFirstChild("Humanoid")
    return (h and h.Health>0) and math.floor(h.Health) or 0
end
local function isAlive(p) return getHealth(p)>0 end
local function getRainbow() return Color3.fromHSV((tick()%5)/5,1,1) end
local function getESPColor(p)
    if Config.ESP.Rainbow then return getRainbow() end
    if Config.ESP.TeamCheck then return (p.TeamColor==Players.LocalPlayer.TeamColor) and Config.ESP.TeamColor or Config.ESP.EnemyColor end
    return Config.ESP.FillColor
end
local function getOutlineColor(p)
    if Config.ESP.Rainbow then return getRainbow() end
    if Config.ESP.TeamCheck then return (p.TeamColor==Players.LocalPlayer.TeamColor) and Config.ESP.TeamColor or Config.ESP.EnemyColor end
    return Config.ESP.OutlineColor
end
local function rayVisible(p)
    if not Config.Aimbot.VisibilityCheck then return true end
    local cam=workspace.CurrentCamera
    local head=p.Character and p.Character:FindFirstChild("Head") if not head then return false end
    local rp=RaycastParams.new()
    rp.FilterType=Enum.RaycastFilterType.Blacklist
    rp.FilterDescendantsInstances={Players.LocalPlayer.Character,p.Character}
    return not workspace:Raycast(cam.CFrame.Position, head.Position-cam.CFrame.Position, rp)
end


local function createOrUpdateESP(p)
    if not ESPs[p] then
        local hl=Instance.new("Highlight"); hl.Adornee=p.Character; hl.DepthMode=Enum.HighlightDepthMode.AlwaysOnTop; hl.Parent=p.Character
        local bg=Instance.new("BillboardGui",p.Character); bg.AlwaysOnTop=true; bg.Size=UDim2.new(0,200,0,50); bg.StudsOffset=Vector3.new(0,2,0)
        local tl=Instance.new("TextLabel",bg); tl.Size=UDim2.new(1,0,1,0); tl.BackgroundTransparency=1; tl.Font=Config.ESP.Font; tl.TextSize=18
        ESPs[p]={hl=hl,bg=bg,tl=tl}
    end
    local d=ESPs[p]
    d.hl.FillColor=getESPColor(p); d.hl.FillTransparency=Config.ESP.FillTransparency
    d.hl.OutlineColor=getOutlineColor(p); d.hl.OutlineTransparency=Config.ESP.ShowOutline and Config.ESP.OutlineTransparency or 1
    d.tl.TextColor3=Config.ESP.TextColor
    
    local baseText = string.format("%s | HP:%d | %dm",getName(p),getHealth(p),math.floor((Players.LocalPlayer.Character.HumanoidRootPart.Position-p.Character.HumanoidRootPart.Position).Magnitude))
    
    d.tl.Text = baseText
end

local function removeESP(p)
    if ESPs[p] then 
        if ESPs[p].hl and ESPs[p].hl.Parent then ESPs[p].hl:Destroy() end
        if ESPs[p].bg and ESPs[p].bg.Parent then ESPs[p].bg:Destroy() end
        ESPs[p]=nil 
    end
    if Lines[p] then Lines[p]:Remove(); Lines[p]=nil end
end


local function isPlayerAlive(player)
    if not player then 
        return false 
    end
    
    if not player.Name then
        return false
    end
    
    if not player.Character then 
        return false 
    end
    local humanoid = player.Character:FindFirstChild("Humanoid")
    if not humanoid then 
        return false 
    end
    local isAlive = humanoid.Health > 0
    return isAlive
end

local function isPlayerOnServer(player)
    if not player or not player.Character then return false end
    local humanoid = player.Character:FindFirstChild("Humanoid")
    if not humanoid then return false end
    return humanoid.Health > 0 and humanoid.Parent ~= nil
end


local function onPlayerDied(player)
    removeESP(player)
end

local function onPlayerRespawned(player)
    if Config.ESP.Enabled and player ~= Players.LocalPlayer then
        spawn(function()
            wait(2) 
            if isPlayerAlive(player) then
                createOrUpdateESP(player)
            end
        end)
    end
end


local function setupPlayerESP(player)
    if player == Players.LocalPlayer then return end
    
    
    local function onCharacterAdded(char)
        local humanoid = char:WaitForChild("Humanoid")
        
        
        humanoid.Died:Connect(function()
            onPlayerDied(player)
        end)
        
        
        humanoid.StateChanged:Connect(function(_, new)
            if new == Enum.HumanoidStateType.Dead then
                onPlayerDied(player)
            elseif new == Enum.HumanoidStateType.Running then
                onPlayerRespawned(player)
            end
        end)
        
        
        char.AncestryChanged:Connect(function(_, parent)
            if not parent then
                onPlayerDied(player)
            end
        end)
    end
    
    if player.Character then
        onCharacterAdded(player.Character)
    end
    player.CharacterAdded:Connect(onCharacterAdded)
    player.CharacterRemoving:Connect(function()
        onPlayerDied(player)
    end)
end


for _, player in ipairs(Players:GetPlayers()) do
    setupPlayerESP(player)
end


Players.PlayerAdded:Connect(setupPlayerESP)



Players.PlayerRemoving:Connect(function(player)
    removeESP(player)
end)

local function getClosestTarget()
    local cam = workspace.CurrentCamera
    local closest, minDist = nil, Config.Aimbot.FOV

    for _, p in ipairs(Players:GetPlayers()) do
        if p == Players.LocalPlayer then continue end
        if Config.Aimbot.TeamCheck and p.Team == Players.LocalPlayer.Team then continue end
        if not isAlive(p) then continue end
        if Config.Aimbot.VisibilityCheck and not rayVisible(p) then continue end

        local head = p.Character and p.Character:FindFirstChild("Head")
        if not head then continue end
        local screenPos, onScreen = cam:WorldToViewportPoint(head.Position)
        if not onScreen then continue end

        local dist = (Vector2.new(screenPos.X, screenPos.Y) - Vector2.new(cam.ViewportSize.X/2, cam.ViewportSize.Y/2)).Magnitude
        if dist < minDist then
            closest = head
            minDist = dist
        end
    end
    return closest
end


RunService.RenderStepped:Connect(function()
    local cam = workspace.CurrentCamera
    for _, player in ipairs(Players:GetPlayers()) do
        if player == Players.LocalPlayer then continue end
        
        local char = player.Character
        local hum = char and char:FindFirstChild("Humanoid")
        local root = char and char:FindFirstChild("HumanoidRootPart")
        
        if isPlayerAlive(player) and root then
            if Config.ESP.Enabled then
                createOrUpdateESP(player)
                if Config.ESP.ShowLines then
                    if not Lines[player] then
                        local ln = Drawing.new("Line")
                        ln.Thickness = 2
                        ln.Transparency = 1
                        Lines[player] = ln
                    end
                    local pos, onScreen = cam:WorldToViewportPoint(root.Position)
                    Lines[player].Visible = onScreen
                    if onScreen then
                        Lines[player].From = Vector2.new(cam.ViewportSize.X/2, cam.ViewportSize.Y)
                        Lines[player].To = Vector2.new(pos.X, pos.Y)
                        Lines[player].Color = getESPColor(player)
                    end
                elseif Lines[player] then
                    Lines[player].Visible = false
                end
            else
                removeESP(player)
            end
        else
            
            removeESP(player)
        end
    end

    
if Config.Aimbot.Enabled then
    local target = getClosestTarget()
    if target then
        local cam = workspace.CurrentCamera
        cam.CFrame = CFrame.lookAt(cam.CFrame.Position, target.Position)
    end
end


local cam = workspace.CurrentCamera
FOVCircle.Visible = Config.Aimbot.Enabled
FOVCircle.Position = Vector2.new(cam.ViewportSize.X/2, cam.ViewportSize.Y/2)
FOVCircle.Color = Config.Aimbot.FOVRainbow and getRainbow() or Config.Aimbot.FOVColor
FOVCircle.Radius = Config.Aimbot.FOV


    
end)


UserInputService.InputBegan:Connect(function(inp, gp)
    if gp then return end
    if inp.UserInputType == Enum.UserInputType.Keyboard then
        if Config.ESP.ToggleKey and inp.KeyCode == Config.ESP.ToggleKey then
            Config.ESP.Enabled = not Config.ESP.Enabled
            print("ESP toggled:", Config.ESP.Enabled)
        elseif Config.Aimbot.ToggleKey and inp.KeyCode == Config.Aimbot.ToggleKey then
            Config.Aimbot.Enabled = not Config.Aimbot.Enabled
            print("Aimbot toggled:", Config.Aimbot.Enabled)
        end
    end
end)


local itemESPEnabled = false
local itemESPConnections = {}
local itemESPElements = {}

local YBA_ITEM_NAMES = {
    ["Mysterious Arrow"] = true,
    ["Rokakaka"] = true,
    ["Pure Rokakaka"] = true,
    ["Diamond"] = true,
    ["Gold Coin"] = true,
    ["Steel Ball"] = true,
    ["Clackers"] = true,
    ["Caesar's Headband"] = true,
    ["Zeppeli's Hat"] = true,
    ["Zeppeli's Scarf"] = true,
    ["Ancient Scroll"] = true,
    ["Quinton's Glove"] = true,
    ["Stone Mask"] = true,
    ["Lucky Arrow"] = true,
    ["Lucky Stone Mask"] = true,

    ["Rib Cage of The Saint's Corpse"] = true,
    
    ["Ancient Scroll"] = true,
    ["DIO's Diary"] = true,
    ["Lucky Stone Mask"] = true,
}

local function findYBAItems()
    local items = {}
    local player = Players.LocalPlayer
    local playerChar = player.Character
    local playerRoot = playerChar and playerChar:FindFirstChild("HumanoidRootPart")
    if not playerRoot then 
        return items 
    end

    local foundFolders = {}
    
    local targetFolder = workspace:FindFirstChild("Item_Spawns")
    if targetFolder then
        local itemsFolder = targetFolder:FindFirstChild("Items")
        if itemsFolder then
            table.insert(foundFolders, itemsFolder)
        end
    end
    
    if #foundFolders == 0 then
        local possibleFolders = {
            workspace:FindFirstChild("Items"),
            workspace:FindFirstChild("items"),
            workspace:FindFirstChild("ItemSpawns"),
            workspace:FindFirstChild("itemspawns"),
            workspace:FindFirstChild("ItemSpawn"),
            workspace:FindFirstChild("itemspawn"),
            workspace:FindFirstChild("Spawns"),
            workspace:FindFirstChild("spawns"),
            workspace:FindFirstChild("World"),
            workspace:FindFirstChild("world"),
            workspace:FindFirstChild("Map"),
            workspace:FindFirstChild("map"),
            workspace:FindFirstChild("Game"),
            workspace:FindFirstChild("game")
        }
        
        for _, folder in ipairs(possibleFolders) do
            if folder then
                table.insert(foundFolders, folder)
            end
        end
    end
    
    if #foundFolders == 0 then 
        return items 
    end
    
    local foundCount = 0
    local searchedModels = {}
    local debugCount = 0

    for _, folder in ipairs(foundFolders) do
        local function searchInFolder(currentFolder, depth)
            if depth > 3 then return end
            
            for _, child in ipairs(currentFolder:GetChildren()) do
                debugCount = debugCount + 1
                
                if child:IsA("Model") then
                    if not searchedModels[child] then
                        searchedModels[child] = true
                        
                        local proximityPrompt = child:FindFirstChild("ProximityPrompt")
                        local itemName = child.Name
                        
                        if proximityPrompt then
                            itemName = proximityPrompt.ObjectText or proximityPrompt.ActionText or child.Name
                        end
                        
                        if YBA_ITEM_NAMES[itemName] and YBAConfig.ItemESP.Items[itemName] then
                            for _, part in ipairs(child:GetDescendants()) do
                                if part:IsA("MeshPart") or part:IsA("Part") then
                                    local distance = (part.Position - playerRoot.Position).Magnitude
                                    
                                    foundCount = foundCount + 1
                                    
                                    table.insert(items, {
                                        Object = part,
                                        Root = part,
                                        Distance = distance,
                                        Name = itemName,
                                        Type = "YBA_Item",
                                        Folder = currentFolder.Name
                                    })
                                    break
                                end
                            end
                        -- Ð”Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð°Ñ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð´Ð»Ñ Ð´Ð½ÐµÐ²Ð½Ð¸ÐºÐ° Ð”Ð˜Ðž
                        elseif string.find(string.lower(itemName), "diary") and YBAConfig.ItemESP.Items["DIO's Diary"] then
                            for _, part in ipairs(child:GetDescendants()) do
                                if part:IsA("MeshPart") or part:IsA("Part") then
                                    local distance = (part.Position - playerRoot.Position).Magnitude
                                    
                                    foundCount = foundCount + 1
                                    
                                    table.insert(items, {
                                        Object = part,
                                        Root = part,
                                        Distance = distance,
                                        Name = "DIO's Diary", -- Ð¡Ñ‚Ð°Ð½Ð´Ð°Ñ€Ñ‚Ð¸Ð·Ð¸Ñ€ÑƒÐµÐ¼ Ð½Ð°Ð·Ð²Ð°Ð½Ð¸Ðµ
                                        Type = "YBA_Item",
                                        Folder = currentFolder.Name
                                    })
                                    break
                                end
                            end
                        end
                    end
                elseif child:IsA("Folder") and depth < 2 then
                    searchInFolder(child, depth + 1)
                end
            end
        end
        
        searchInFolder(folder, 0)
    end
    
    table.sort(items, function(a, b) return a.Distance < b.Distance end)
    
    return items
end

local function findYBAItemsFast()
    local items = {}
    local player = Players.LocalPlayer
    local playerChar = player.Character
    local playerRoot = playerChar and playerChar:FindFirstChild("HumanoidRootPart")
    if not playerRoot then 
        return items 
    end
    
    local targetFolder = workspace:FindFirstChild("Item_Spawns")
    if not targetFolder then
        return items
    end
    
    local itemsFolder = targetFolder:FindFirstChild("Items")
    if not itemsFolder then
        return items
    end
    
    local foundCount = 0
    local debugCount = 0

    for _, child in ipairs(itemsFolder:GetChildren()) do
        debugCount = debugCount + 1
        
        if child:IsA("Model") then
            local proximityPrompt = child:FindFirstChild("ProximityPrompt")
            local itemName = child.Name
            
            if proximityPrompt then
                itemName = proximityPrompt.ObjectText or proximityPrompt.ActionText or child.Name
            end
            
            if YBA_ITEM_NAMES[itemName] and YBAConfig.ItemESP.Items[itemName] then
                for _, part in ipairs(child:GetDescendants()) do
                    if part:IsA("MeshPart") or part:IsA("Part") then
                        local distance = (part.Position - playerRoot.Position).Magnitude
                        
                        foundCount = foundCount + 1
                        print("YBA Item ESP: ÐÐ°Ð¹Ð´ÐµÐ½ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚", itemName, "Ð½Ð° Ñ€Ð°ÑÑÑ‚Ð¾ÑÐ½Ð¸Ð¸", math.floor(distance), "Ð¼")
                        
                        table.insert(items, {
                            Object = part,
                            Root = part,
                            Distance = distance,
                            Name = itemName,
                            Type = "YBA_Item",
                            Folder = "Item_Spawns.Items"
                        })
                        break
                    end
                end
            elseif string.find(string.lower(itemName), "diary") and YBAConfig.ItemESP.Items["DIO's Diary"] then
                for _, part in ipairs(child:GetDescendants()) do
                    if part:IsA("MeshPart") or part:IsA("Part") then
                        local distance = (part.Position - playerRoot.Position).Magnitude
                        
                        foundCount = foundCount + 1
                        print("YBA Item ESP: ÐÐ°Ð¹Ð´ÐµÐ½ Ð´Ð½ÐµÐ²Ð½Ð¸Ðº (Ð¿Ð¾ Ð¿Ð¾Ð¸ÑÐºÑƒ)", itemName, "Ð½Ð° Ñ€Ð°ÑÑÑ‚Ð¾ÑÐ½Ð¸Ð¸", math.floor(distance), "Ð¼")
                        
                        table.insert(items, {
                            Object = part,
                            Root = part,
                            Distance = distance,
                            Name = "DIO's Diary",
                            Type = "YBA_Item",
                            Folder = "Item_Spawns.Items"
                        })
                        break
                    end
                end
            else
                local lowerName = string.lower(itemName)
                if string.find(lowerName, "arrow") or 
                   string.find(lowerName, "rokakaka") or
                   string.find(lowerName, "diamond") or
                   string.find(lowerName, "coin") or
                   string.find(lowerName, "corpse") or
                   string.find(lowerName, "diary") or
                   string.find(lowerName, "mask") or
                   string.find(lowerName, "scroll") or
                   string.find(lowerName, "glove") or
                   string.find(lowerName, "headband") or
                   string.find(lowerName, "ball") then
                    
                    for _, part in ipairs(child:GetDescendants()) do
                        if part:IsA("MeshPart") or part:IsA("Part") then
                            local distance = (part.Position - playerRoot.Position).Magnitude
                            
                            if distance <= YBAConfig.ItemESP.MaxDistance then
                                foundCount = foundCount + 1
                                print("YBA Item ESP: Ð‘Ñ‹ÑÑ‚Ñ€Ñ‹Ð¹ Ð¿Ð¾Ð¸ÑÐº - Ð½Ð°Ð¹Ð´ÐµÐ½ Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ñ‹Ð¹ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚", itemName, "Ð½Ð° Ñ€Ð°ÑÑÑ‚Ð¾ÑÐ½Ð¸Ð¸", math.floor(distance), "Ð¼")
                                
                                table.insert(items, {
                                    Object = part,
                                    Root = part,
                                    Distance = distance,
                                    Name = itemName,
                                    Type = "YBA_Item",
                                    Folder = "Item_Spawns.Items"
                                })
                                break
                            end
                        end
                    end
                end
            end
        end
    end
    
    table.sort(items, function(a, b) return a.Distance < b.Distance end)
    
    return items
end

local function findYBAItemsAlternative()
    local items = {}
    local player = Players.LocalPlayer
    local playerChar = player.Character
    local playerRoot = playerChar and playerChar:FindFirstChild("HumanoidRootPart")
    if not playerRoot then 
        print("YBA Item ESP: Ð˜Ð³Ñ€Ð¾Ðº Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½ (Ð°Ð»ÑŒÑ‚ÐµÑ€Ð½Ð°Ñ‚Ð¸Ð²Ð½Ñ‹Ð¹ Ð¿Ð¾Ð¸ÑÐº)")
        return items 
    end

    print("YBA Item ESP: ÐÐ»ÑŒÑ‚ÐµÑ€Ð½Ð°Ñ‚Ð¸Ð²Ð½Ñ‹Ð¹ Ð¿Ð¾Ð¸ÑÐº Ð¿Ð¾ Ð²ÑÐµÐ¼Ñƒ workspace...")
    
    local foundCount = 0
    local searchedModels = {}
    local debugCount = 0

    local function searchInWorkspace(parent, depth)
        if depth > 10 then return end
        
        for _, child in ipairs(parent:GetChildren()) do
            debugCount = debugCount + 1
            if debugCount % 500 == 0 then
                print("YBA Item ESP: ÐÐ»ÑŒÑ‚ÐµÑ€Ð½Ð°Ñ‚Ð¸Ð²Ð½Ñ‹Ð¹ Ð¿Ð¾Ð¸ÑÐº - Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐµÐ½Ð¾ Ð¾Ð±ÑŠÐµÐºÑ‚Ð¾Ð²:", debugCount)
            end
            
            if child:IsA("Model") then
                if not searchedModels[child] then
                    searchedModels[child] = true

                    if YBA_ITEM_NAMES[child.Name] and YBAConfig.ItemESP.Items[child.Name] then
                        print("YBA Item ESP: ÐÐ»ÑŒÑ‚ÐµÑ€Ð½Ð°Ñ‚Ð¸Ð²Ð½Ñ‹Ð¹ Ð¿Ð¾Ð¸ÑÐº - Ð½Ð°Ð¹Ð´ÐµÐ½Ð° Ð¼Ð¾Ð´ÐµÐ»ÑŒ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ð°:", child.Name)

                        for _, part in ipairs(child:GetDescendants()) do
                            if part:IsA("MeshPart") or part:IsA("Part") then
                                local distance = (part.Position - playerRoot.Position).Magnitude
                                
                                if distance <= YBAConfig.ItemESP.MaxDistance then
                                    foundCount = foundCount + 1
                                    print("YBA Item ESP: ÐÐ»ÑŒÑ‚ÐµÑ€Ð½Ð°Ñ‚Ð¸Ð²Ð½Ñ‹Ð¹ Ð¿Ð¾Ð¸ÑÐº - Ð½Ð°Ð¹Ð´ÐµÐ½ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚", child.Name, "Ð½Ð° Ñ€Ð°ÑÑÑ‚Ð¾ÑÐ½Ð¸Ð¸", math.floor(distance), "Ð¼")
                                    
                                    table.insert(items, {
                                        Object = part,
                                        Root = part,
                                        Distance = distance,
                                        Name = child.Name,
                                        Type = "YBA_Item",
                                        Folder = "Workspace"
                                    })
                                    break
                                end
                            end
                        end
                    elseif string.find(string.lower(child.Name), "diary") and YBAConfig.ItemESP.Items["DIO's Diary"] then
                        print("YBA Item ESP: ÐÐ»ÑŒÑ‚ÐµÑ€Ð½Ð°Ñ‚Ð¸Ð²Ð½Ñ‹Ð¹ Ð¿Ð¾Ð¸ÑÐº - Ð½Ð°Ð¹Ð´ÐµÐ½ Ð´Ð½ÐµÐ²Ð½Ð¸Ðº:", child.Name)

                        for _, part in ipairs(child:GetDescendants()) do
                            if part:IsA("MeshPart") or part:IsA("Part") then
                                local distance = (part.Position - playerRoot.Position).Magnitude
                                
                                if distance <= YBAConfig.ItemESP.MaxDistance then
                                    foundCount = foundCount + 1
                                    print("YBA Item ESP: ÐÐ»ÑŒÑ‚ÐµÑ€Ð½Ð°Ñ‚Ð¸Ð²Ð½Ñ‹Ð¹ Ð¿Ð¾Ð¸ÑÐº - Ð½Ð°Ð¹Ð´ÐµÐ½ Ð´Ð½ÐµÐ²Ð½Ð¸Ðº", child.Name, "Ð½Ð° Ñ€Ð°ÑÑÑ‚Ð¾ÑÐ½Ð¸Ð¸", math.floor(distance), "Ð¼")
                                    
                                    table.insert(items, {
                                        Object = part,
                                        Root = part,
                                        Distance = distance,
                                        Name = "DIO's Diary",
                                        Type = "YBA_Item",
                                        Folder = "Workspace"
                                    })
                                    break
                                end
                            end
                        end
                    else
                        if string.find(string.lower(child.Name), "arrow") or 
                           string.find(string.lower(child.Name), "rokakaka") or
                           string.find(string.lower(child.Name), "diamond") or
                           string.find(string.lower(child.Name), "coin") then
                            print("YBA Item ESP: ÐÐ»ÑŒÑ‚ÐµÑ€Ð½Ð°Ñ‚Ð¸Ð²Ð½Ñ‹Ð¹ Ð¿Ð¾Ð¸ÑÐº - Ð½Ð°Ð¹Ð´ÐµÐ½Ð° Ð½ÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð°Ñ Ð¼Ð¾Ð´ÐµÐ»ÑŒ (Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚):", child.Name)
                        end
                    end
                end
            elseif child:IsA("Folder") and depth < 5 then
                searchInWorkspace(child, depth + 1)
            end
        end
    end

    searchInWorkspace(workspace, 0)

    table.sort(items, function(a, b) return a.Distance < b.Distance end)
    
    print("YBA Item ESP: ÐÐ»ÑŒÑ‚ÐµÑ€Ð½Ð°Ñ‚Ð¸Ð²Ð½Ñ‹Ð¹ Ð¿Ð¾Ð¸ÑÐº - Ð²ÑÐµÐ³Ð¾ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐµÐ½Ð¾ Ð¾Ð±ÑŠÐµÐºÑ‚Ð¾Ð²:", debugCount)
    print("YBA Item ESP: ÐÐ»ÑŒÑ‚ÐµÑ€Ð½Ð°Ñ‚Ð¸Ð²Ð½Ñ‹Ð¹ Ð¿Ð¾Ð¸ÑÐº - Ð²ÑÐµÐ³Ð¾ Ð½Ð°Ð¹Ð´ÐµÐ½Ð¾ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ð¾Ð²:", foundCount)
    
    return items
end

local function debugWorkspaceStructure()
    print("YBA Item ESP: === ÐžÐ¢Ð›ÐÐ”ÐšÐ Ð¡Ð¢Ð Ð£ÐšÐ¢Ð£Ð Ð« WORKSPACE ===")
    
    local function printFolderStructure(parent, prefix, maxDepth)
        if maxDepth <= 0 then return end
        
        for _, child in ipairs(parent:GetChildren()) do
            local childType = child.ClassName
            local childName = child.Name
            
            print(prefix .. "â”œâ”€ " .. childName .. " (" .. childType .. ")")

            if child:IsA("Folder") then
                printFolderStructure(child, prefix .. "â”‚  ", maxDepth - 1)
            end

            if child:IsA("Model") then
                local hasMeshPart = false
                local hasPart = false
                for _, descendant in ipairs(child:GetDescendants()) do
                    if descendant:IsA("MeshPart") then
                        hasMeshPart = true
                    elseif descendant:IsA("Part") then
                        hasPart = true
                    end
                end
                if hasMeshPart or hasPart then
                    print(prefix .. "â”‚  â””â”€ [Ð¡Ð¾Ð´ÐµÑ€Ð¶Ð¸Ñ‚ MeshPart/Part]")
                end
            end
        end
    end
    
    print("YBA Item ESP: Ð¡Ñ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð° workspace (Ð¿ÐµÑ€Ð²Ñ‹Ðµ 3 ÑƒÑ€Ð¾Ð²Ð½Ñ):")
    printFolderStructure(workspace, "", 3)
    
    print("YBA Item ESP: === ÐšÐžÐÐ•Ð¦ ÐžÐ¢Ð›ÐÐ”ÐšÐ˜ ===")
end

local function createItemESP(item)
    if itemESPElements[item.Object] then
        return itemESPElements[item.Object]
    end
    
    if not item.Object or not item.Object.Parent then
        return nil
    end

    if item.Distance > YBAConfig.ItemESP.MaxRenderDistance then
        return nil
    end
    
    print("YBA Item ESP: Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ ESP Ð´Ð»Ñ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ð°:", item.Name)
    
    local esp = {}
    esp.itemName = item.Name 

    local function getItemColor(itemName)
        if string.find(itemName, "Arrow") then
            return Color3.fromRGB(255, 215, 0) 
        elseif string.find(itemName, "Rokakaka") then
            return Color3.fromRGB(255, 0, 255) 
        elseif string.find(itemName, "Diamond") then
            return Color3.fromRGB(0, 255, 255) 
        elseif string.find(itemName, "Corpse") then
            return Color3.fromRGB(255, 0, 0) 
        elseif string.find(itemName, "Diary") then
            return Color3.fromRGB(255, 165, 0)
        else
            return YBAConfig.ItemESP.FillColor 
        end
    end
    
    local itemColor = getItemColor(item.Name)

    if YBAConfig.ItemESP.ShowOutline or YBAConfig.ItemESP.ShowFill then
        local success, highlight = pcall(function()
            local hl = Instance.new("Highlight")
            hl.Adornee = item.Object
            hl.DepthMode = Enum.HighlightDepthMode.AlwaysOnTop
            hl.FillColor = YBAConfig.ItemESP.ShowFill and itemColor or Color3.fromRGB(0, 0, 0)
            hl.FillTransparency = YBAConfig.ItemESP.ShowFill and YBAConfig.ItemESP.FillTransparency or 1
            hl.OutlineColor = YBAConfig.ItemESP.ShowOutline and YBAConfig.ItemESP.OutlineColor or Color3.fromRGB(0, 0, 0)
            hl.OutlineTransparency = YBAConfig.ItemESP.ShowOutline and YBAConfig.ItemESP.OutlineTransparency or 1
            hl.Parent = item.Object

            local pulseConnection
            pulseConnection = RunService.Heartbeat:Connect(function()
                if not hl.Parent then
                    pulseConnection:Disconnect()
                    return
                end
                
                local time = tick()
                local pulse = math.sin(time * 4) * 0.4 + 0.6
                hl.FillTransparency = YBAConfig.ItemESP.FillTransparency + (1 - pulse) * 0.4
                hl.OutlineTransparency = YBAConfig.ItemESP.OutlineTransparency + (1 - pulse) * 0.2
            end)
            
            esp.pulseConnection = pulseConnection
            
            return hl
        end)
        
        if success and highlight then
            esp.highlight = highlight
            print("YBA Item ESP: Highlight ÑÐ¾Ð·Ð´Ð°Ð½ Ð´Ð»Ñ:", item.Name)
        else
            print("YBA Item ESP: ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¸ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ð¸ Highlight Ð´Ð»Ñ:", item.Name)
        end
    end

    if YBAConfig.ItemESP.ShowText then
        local success, billboard = pcall(function()
            local bg = Instance.new("BillboardGui")
            bg.AlwaysOnTop = true
            bg.Size = UDim2.new(0, 200, 0, 50) 
            bg.StudsOffset = Vector3.new(0, 3, 0) 
            bg.Parent = item.Object

            local background = Instance.new("Frame", bg)
            background.Size = UDim2.new(1, 0, 1, 0)
            background.Position = UDim2.new(0, 0, 0, 0)
            background.BackgroundColor3 = YBAConfig.ItemESP.TextBackgroundColor
            background.BackgroundTransparency = YBAConfig.ItemESP.TextBackgroundTransparency
            background.BorderSizePixel = 0
            background.ZIndex = 1
            
            local corner = Instance.new("UICorner", background)
            corner.CornerRadius = UDim.new(0, 6) 

            local border = Instance.new("Frame", bg)
            border.Size = UDim2.new(1, 2, 1, 2)
            border.Position = UDim2.new(0, -1, 0, -1)
            border.BackgroundColor3 = itemColor
            border.BorderSizePixel = 0
            border.ZIndex = 0
            
            local borderCorner = Instance.new("UICorner", border)
            borderCorner.CornerRadius = UDim.new(0, 8) 

            local tl = Instance.new("TextLabel", bg)
            tl.Size = UDim2.new(1, -6, 0.6, 0) 
            tl.Position = UDim2.new(0, 3, 0, 2)
            tl.BackgroundTransparency = 1
            tl.Font = YBAConfig.ItemESP.Font
            tl.TextSize = YBAConfig.ItemESP.TextSize
            tl.TextColor3 = YBAConfig.ItemESP.TextColor
            tl.TextXAlignment = Enum.TextXAlignment.Center
            tl.TextYAlignment = Enum.TextYAlignment.Center
            tl.Text = string.format("ðŸŽ¯ %s", item.Name)
            tl.ZIndex = 3

            local distanceLabel = Instance.new("TextLabel", bg)
            distanceLabel.Size = UDim2.new(1, -6, 0.4, 0) 
            distanceLabel.Position = UDim2.new(0, 3, 0.6, 0) 
            distanceLabel.BackgroundTransparency = 1
            distanceLabel.Font = Enum.Font.Gotham
            distanceLabel.TextSize = YBAConfig.ItemESP.DistanceTextSize
            distanceLabel.TextColor3 = YBAConfig.ItemESP.TextColor
            distanceLabel.TextXAlignment = Enum.TextXAlignment.Center
            distanceLabel.TextYAlignment = Enum.TextYAlignment.Center
            distanceLabel.Text = string.format("ðŸ“ %dm", math.floor(item.Distance)) 
            distanceLabel.ZIndex = 3
            
            return {
                billboard = bg, 
                text = tl, 
                distanceLabel = distanceLabel,
                background = background,
                border = border
            }
        end)
        
        if success and billboard then
            esp.billboard = billboard.billboard
            esp.text = billboard.text
            esp.distanceLabel = billboard.distanceLabel
            esp.background = billboard.background
            esp.border = billboard.border
            print("YBA Item ESP: BillboardGui ÑÐ¾Ð·Ð´Ð°Ð½ Ð´Ð»Ñ:", item.Name)
        else
            print("YBA Item ESP: ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¸ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ð¸ BillboardGui Ð´Ð»Ñ:", item.Name)
        end
    end
    
    itemESPElements[item.Object] = esp
    return esp
end

local function updateItemESP(item)
    local esp = itemESPElements[item.Object]
    if not esp then return end

    if true then
        if not item.Object or not item.Object.Parent then
            print("YBA Item ESP: ÐŸÑ€ÐµÐ´Ð¼ÐµÑ‚ Ð±Ð¾Ð»ÑŒÑˆÐµ Ð½Ðµ ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÐµÑ‚, ÑƒÐ´Ð°Ð»ÑÐµÐ¼ ESP:", item.Name)
            removeItemESP(item)
            return
        end

        local currentParent = item.Object.Parent
        while currentParent and currentParent ~= workspace do
            if currentParent.Name == "Items" and currentParent.Parent and currentParent.Parent.Name == "Item_Spawns" then
                break
            end
            currentParent = currentParent.Parent
        end
        
        if not currentParent or currentParent == workspace then
            print("YBA Item ESP: ÐŸÑ€ÐµÐ´Ð¼ÐµÑ‚ Ð¿ÐµÑ€ÐµÐ¼ÐµÑ‰ÐµÐ½ Ð¸Ð· Ð¿Ð°Ð¿ÐºÐ¸ Items, ÑƒÐ´Ð°Ð»ÑÐµÐ¼ ESP:", item.Name)
            removeItemESP(item)
            return
        end
    end

    local function getItemColor(itemName)
        if string.find(itemName, "Arrow") then
            return Color3.fromRGB(255, 215, 0) 
        elseif string.find(itemName, "Rokakaka") then
            return Color3.fromRGB(255, 0, 255)
        elseif string.find(itemName, "Diamond") then
            return Color3.fromRGB(0, 255, 255)
        elseif string.find(itemName, "Corpse") then
            return Color3.fromRGB(255, 0, 0) 
        elseif string.find(itemName, "Diary") then
            return Color3.fromRGB(255, 165, 0)
        else
            return YBAConfig.ItemESP.FillColor 
        end
    end
    
    local itemColor = getItemColor(item.Name)

    if esp.text and esp.text.Parent then
        pcall(function()
            esp.text.Text = string.format("ðŸŽ¯ %s", item.Name)
        end)
    end

    if esp.distanceLabel and esp.distanceLabel.Parent then
        pcall(function()
            esp.distanceLabel.Text = string.format("ðŸ“ %dm", math.floor(item.Distance)) 
        end)
    end

    if esp.highlight and esp.highlight.Parent then
        pcall(function()
            esp.highlight.FillColor = YBAConfig.ItemESP.ShowFill and itemColor or Color3.fromRGB(0, 0, 0)
            esp.highlight.FillTransparency = YBAConfig.ItemESP.ShowFill and YBAConfig.ItemESP.FillTransparency or 1
            esp.highlight.OutlineColor = YBAConfig.ItemESP.ShowOutline and YBAConfig.ItemESP.OutlineColor or Color3.fromRGB(0, 0, 0)
            esp.highlight.OutlineTransparency = YBAConfig.ItemESP.ShowOutline and YBAConfig.ItemESP.OutlineTransparency or 1
        end)
    end

    if esp.border and esp.border.Parent then
        pcall(function()
            esp.border.BackgroundColor3 = itemColor
        end)
    end
end

local function removeItemESP(item)
    local esp = itemESPElements[item.Object]
    if not esp then return end

    if esp.pulseConnection then
        esp.pulseConnection:Disconnect()
        esp.pulseConnection = nil
    end

    pcall(function()
        if esp.highlight and esp.highlight.Parent then
            esp.highlight:Destroy()
        end
    end)

    pcall(function()
        if esp.billboard and esp.billboard.Parent then
            esp.billboard:Destroy()
        end
    end)

    esp.highlight = nil
    esp.billboard = nil
    esp.text = nil
    esp.distanceLabel = nil
    esp.background = nil
    esp.border = nil
    
    itemESPElements[item.Object] = nil
end

local function startItemESP()
    if itemESPEnabled then 
        print("YBA Item ESP: Ð£Ð¶Ðµ Ð°ÐºÑ‚Ð¸Ð²Ð¸Ñ€Ð¾Ð²Ð°Ð½!")
        return 
    end
    itemESPEnabled = true
    
    print("YBA Item ESP: ÐÐºÑ‚Ð¸Ð²Ð¸Ñ€Ð¾Ð²Ð°Ð½!")
    print("YBA Item ESP: ÐœÐ°ÐºÑÐ¸Ð¼Ð°Ð»ÑŒÐ½Ð°Ñ Ð´Ð¸ÑÑ‚Ð°Ð½Ñ†Ð¸Ñ:", YBAConfig.ItemESP.MaxDistance)
    print("YBA Item ESP: ÐŸÐ¾ÐºÐ°Ð·Ñ‹Ð²Ð°Ñ‚ÑŒ Ð¾Ð±Ð²Ð¾Ð´ÐºÑƒ:", YBAConfig.ItemESP.ShowOutline)
    print("YBA Item ESP: ÐŸÐ¾ÐºÐ°Ð·Ñ‹Ð²Ð°Ñ‚ÑŒ Ñ‚ÐµÐºÑÑ‚:", YBAConfig.ItemESP.ShowText)

    local testItems = findYBAItems()
    print("YBA Item ESP: ÐÐºÑ‚Ð¸Ð²Ð¸Ñ€Ð¾Ð²Ð°Ð½! ÐÐ°Ð¹Ð´ÐµÐ½Ð¾ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ð¾Ð²:", #testItems)
    
    local lastUpdate = 0
    local updateInterval = YBAConfig.ItemESP.UpdateInterval 

    local itemESPLoop = RunService.Heartbeat:Connect(function()
        if not YBAConfig.ItemESP.Enabled then
            stopItemESP()
            return
        end

        local currentTime = tick()
        if currentTime - lastUpdate < updateInterval then
            return
        end
        lastUpdate = currentTime

        local success, items = pcall(findYBAItemsFast)
        local currentItems = {}

        if not success or not items or #items == 0 then
            local success2, items2 = pcall(findYBAItems)
            if success2 and items2 and #items2 > 0 then
                items = items2
                success = true
                print("YBA Item ESP: Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼ Ð¾Ð±Ñ‹Ñ‡Ð½Ñ‹Ð¹ Ð¿Ð¾Ð¸ÑÐº, Ð½Ð°Ð¹Ð´ÐµÐ½Ð¾ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ð¾Ð²:", #items)
            else
                local success3, items3 = pcall(findYBAItemsAlternative)
                if success3 and items3 and #items3 > 0 then
                    items = items3
                    success = true
                    print("YBA Item ESP: Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼ Ð°Ð»ÑŒÑ‚ÐµÑ€Ð½Ð°Ñ‚Ð¸Ð²Ð½Ñ‹Ð¹ Ð¿Ð¾Ð¸ÑÐº, Ð½Ð°Ð¹Ð´ÐµÐ½Ð¾ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ð¾Ð²:", #items)
                end
            end
        end
        
        if success and items then
            for i = 1, math.min(100, #items) do 
                local item = items[i]
                if item and item.Object and item.Object.Parent then
                    if YBAConfig.ItemESP.Items[item.Name] then
                        currentItems[item.Object] = true

                        if not itemESPElements[item.Object] then
                            pcall(createItemESP, item)
                        else
                            pcall(updateItemESP, item)
                        end
                    else
                        if itemESPElements[item.Object] then
                            pcall(removeItemESP, item)
                        end
                    end
                end
            end

            if math.floor(currentTime) % 5 == 0 then
                print("YBA Item ESP: ÐÐºÑ‚Ð¸Ð²Ð½Ñ‹Ñ… ESP:", #items, "| ÐœÐ°ÐºÑÐ¸Ð¼Ð°Ð»ÑŒÐ½Ð°Ñ Ð´Ð¸ÑÑ‚Ð°Ð½Ñ†Ð¸Ñ:", YBAConfig.ItemESP.MaxDistance)
            end
        end

        for obj, esp in pairs(itemESPElements) do
            if not currentItems[obj] then
                pcall(removeItemESP, {Object = obj})
            end
        end
    end)
    
    table.insert(itemESPConnections, itemESPLoop)

    local cleanupLoop = RunService.Heartbeat:Connect(function()
        if not YBAConfig.ItemESP.Enabled then
            return
        end
        
        for obj, esp in pairs(itemESPElements) do
            if not obj or not obj.Parent then
                pcall(removeItemESP, {Object = obj})
            end
        end
    end)
    
    table.insert(itemESPConnections, cleanupLoop)
end

local function stopItemESP()
    if not itemESPEnabled then return end
    itemESPEnabled = false
    
    print("YBA Item ESP: Ð”ÐµÐ°ÐºÑ‚Ð¸Ð²Ð¸Ñ€Ð¾Ð²Ð°Ð½!")

    for obj, esp in pairs(itemESPElements) do
        pcall(removeItemESP, {Object = obj})
    end

    for _, connection in ipairs(itemESPConnections) do
        if connection then
            pcall(function() connection:Disconnect() end)
        end
    end
    itemESPConnections = {}
end

-- ÐŸÑ€Ð¾ÑÑ‚Ñ‹Ðµ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸ ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ Player ESP







-- Autofarm Functions
-- Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ ÑƒÐ½Ð¸ÐºÐ°Ð»ÑŒÐ½Ð¾Ð³Ð¾ ÐºÐ»ÑŽÑ‡Ð° Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ð°
local function getItemKey(item)
    return item.Name .. "_" .. tostring(item.Position.X) .. "_" .. tostring(item.Position.Z)
end

-- Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ ÑÐ±Ñ€Ð¾ÑÐ° Ð¿Ð¾Ð¿Ñ‹Ñ‚Ð¾Ðº Ð´Ð»Ñ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ð°
local function resetItemAttempts(itemKey)
    autofarmItemAttempts[itemKey] = nil
end

-- Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ ÑƒÐ²ÐµÐ»Ð¸Ñ‡ÐµÐ½Ð¸Ñ ÑÑ‡ÐµÑ‚Ñ‡Ð¸ÐºÐ° Ð¿Ð¾Ð¿Ñ‹Ñ‚Ð¾Ðº
local function incrementItemAttempts(itemKey)
    autofarmItemAttempts[itemKey] = (autofarmItemAttempts[itemKey] or 0) + 1
    return autofarmItemAttempts[itemKey]
end

-- Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸, Ð½Ðµ Ð¿Ñ€ÐµÐ²Ñ‹ÑˆÐµÐ½Ð¾ Ð»Ð¸ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð¿Ð¾Ð¿Ñ‹Ñ‚Ð¾Ðº
local function isItemMaxAttempts(itemKey)
    return (autofarmItemAttempts[itemKey] or 0) >= 3
end

local function findAutofarmItems()
    local items = {}
    local player = Players.LocalPlayer
    local playerChar = player.Character
    local playerRoot = playerChar and playerChar:FindFirstChild("HumanoidRootPart")
    if not playerRoot then 
        print("AUTOFARM: Ð˜Ð³Ñ€Ð¾Ðº Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½")
        return items 
    end

    print("AUTOFARM: ÐÐ°Ñ‡Ð¸Ð½Ð°ÐµÐ¼ Ð¿Ð¾Ð¸ÑÐº Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ð¾Ð²...")
    
    -- Ð˜Ñ‰ÐµÐ¼ Ð¿Ð¾ Ñ‚Ð¾Ñ‡Ð½Ð¾Ð¼Ñƒ Ð¿ÑƒÑ‚Ð¸ workspace > Item_Spawns > Items
    local itemSpawnsFolder = workspace:FindFirstChild("Item_Spawns")
    if not itemSpawnsFolder then
        print("AUTOFARM: ÐŸÐ°Ð¿ÐºÐ° Item_Spawns Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½Ð°!")
        return items
    end
    
    local itemsFolder = itemSpawnsFolder:FindFirstChild("Items")
    if not itemsFolder then
        print("AUTOFARM: ÐŸÐ°Ð¿ÐºÐ° Items Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½Ð°!")
        return items
    end
    
    print("AUTOFARM: ÐŸÐ°Ð¿ÐºÐ¸ Ð½Ð°Ð¹Ð´ÐµÐ½Ñ‹, ÑÐºÐ°Ð½Ð¸Ñ€ÑƒÐµÐ¼ Ð¼Ð¾Ð´ÐµÐ»Ð¸...")
    local foundCount = 0
    
    for _, model in ipairs(itemsFolder:GetChildren()) do
        if model:IsA("Model") then
            -- ÐŸÐ¾Ð»ÑƒÑ‡Ð°ÐµÐ¼ Ð½Ð°Ð·Ð²Ð°Ð½Ð¸Ðµ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ð° Ð¸Ð· ProximityPrompt
            local proximityPrompt = model:FindFirstChild("ProximityPrompt")
            local itemName = model.Name
            
            if proximityPrompt then
                itemName = proximityPrompt.ObjectText or proximityPrompt.ActionText or model.Name
            end
            
            -- Ð”Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð°Ñ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð´Ð»Ñ Ð´Ð½ÐµÐ²Ð½Ð¸ÐºÐ° Ð”Ð˜Ðž (Ñ€Ð°Ð·Ð½Ñ‹Ðµ Ð²Ð°Ñ€Ð¸Ð°Ð½Ñ‚Ñ‹ Ð½Ð°Ð·Ð²Ð°Ð½Ð¸Ð¹)
            if itemName == "Dio's Diary" and AutofarmConfig.Items["DIO's Diary"] then
                itemName = "DIO's Diary" -- ÑÑ‚Ð°Ð½Ð´Ð°Ñ€Ñ‚Ð¸Ð·Ð¸Ñ€ÑƒÐµÐ¼ Ð½Ð°Ð·Ð²Ð°Ð½Ð¸Ðµ
            end
            
            -- Ð”Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð°Ñ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð´Ð»Ñ ÑÑ‚Ñ€ÐµÐ» (Ñ€Ð°Ð·Ð½Ñ‹Ðµ Ð²Ð°Ñ€Ð¸Ð°Ð½Ñ‚Ñ‹ Ð½Ð°Ð·Ð²Ð°Ð½Ð¸Ð¹)
            local shouldSkipItem = false
            if string.find(string.lower(itemName), "arrow") and not AutofarmConfig.Items["Mysterious Arrow"] then
                shouldSkipItem = true
            end
            
            -- Ð¡Ñ‚Ð°Ð½Ð´Ð°Ñ€Ñ‚Ð¸Ð·Ð¸Ñ€ÑƒÐµÐ¼ Ð½Ð°Ð·Ð²Ð°Ð½Ð¸Ðµ ÑÑ‚Ñ€ÐµÐ»
            if not shouldSkipItem and string.find(string.lower(itemName), "arrow") and itemName ~= "Mysterious Arrow" then
                itemName = "Mysterious Arrow"
            end
            if not shouldSkipItem and AutofarmConfig.Items[itemName] then
                -- Ð˜Ñ‰ÐµÐ¼ WorldPivot Ð¿Ð¾Ð·Ð¸Ñ†Ð¸ÑŽ
                local worldPivot = nil
                if model.WorldPivot then
                    worldPivot = model.WorldPivot.Position
                elseif model.PrimaryPart then
                    worldPivot = model.PrimaryPart.Position
                elseif model:FindFirstChild("HumanoidRootPart") then
                    worldPivot = model.HumanoidRootPart.Position
                else
                    -- Ð˜Ñ‰ÐµÐ¼ Ð»ÑŽÐ±ÑƒÑŽ Part
                    for _, child in ipairs(model:GetDescendants()) do
                        if child:IsA("BasePart") then
                            worldPivot = child.Position
                            break
                        end
                    end
                end
                
                if worldPivot then
                    local distance = (worldPivot - playerRoot.Position).Magnitude
                    foundCount = foundCount + 1
                    local tempItem = {
                        Name = itemName,
                        Position = worldPivot,
                        Distance = distance,
                        Model = model,
                        ProximityPrompt = proximityPrompt
                    }
                    local itemKey = getItemKey(tempItem)
                    
                    -- ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼ Ð½Ðµ Ð¿Ñ€ÐµÐ²Ñ‹ÑˆÐµÐ½Ð¾ Ð»Ð¸ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð¿Ð¾Ð¿Ñ‹Ñ‚Ð¾Ðº
                    if not isItemMaxAttempts(itemKey) then
                        -- Ð›Ð¾Ð³Ð¸Ñ€ÑƒÐµÐ¼ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð¿ÐµÑ€Ð²ÑƒÑŽ Ð¿Ð¾Ð¿Ñ‹Ñ‚ÐºÑƒ Ð´Ð»Ñ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ð°, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð½Ðµ ÑÐ¿Ð°Ð¼Ð¸Ñ‚ÑŒ
                        if (autofarmItemAttempts[itemKey] or 0) == 0 then
                            print("AUTOFARM: ðŸŽ¯ ÐÐ°Ð¹Ð´ÐµÐ½ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚", itemName, "Ð½Ð° Ñ€Ð°ÑÑÑ‚Ð¾ÑÐ½Ð¸Ð¸", math.floor(distance), "Ð¼")
                        end
                        table.insert(items, tempItem)
                    else
                        print("AUTOFARM: ÐŸÑ€ÐµÐ´Ð¼ÐµÑ‚", itemName, "Ð¿Ñ€Ð¾Ð¿ÑƒÑ‰ÐµÐ½ - Ð¿Ñ€ÐµÐ²Ñ‹ÑˆÐµÐ½Ð¾ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð¿Ð¾Ð¿Ñ‹Ñ‚Ð¾Ðº (3/3)")
                        -- Ð”Ð¾Ð±Ð°Ð²Ð»ÑÐµÐ¼ Ð² ÑÐ¿Ð¸ÑÐ¾Ðº Ð¿Ñ€Ð¾Ð¿ÑƒÑ‰ÐµÐ½Ð½Ñ‹Ñ… Ð´Ð»Ñ Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€Ð½Ð¾Ð¹ Ð¿Ð¾Ð¿Ñ‹Ñ‚ÐºÐ¸ Ð¿Ð¾Ð·Ð¶Ðµ
                        autofarmSkippedItems[itemKey] = tempItem
                    end
                end
            end -- Ð—Ð°ÐºÑ€Ñ‹Ð²Ð°ÐµÐ¼ if AutofarmConfig.Items[itemName] then
        end
    end
    
    -- Ð¡Ð¾Ñ€Ñ‚Ð¸Ñ€ÑƒÐµÐ¼ Ð¿Ð¾ Ñ€Ð°ÑÑÑ‚Ð¾ÑÐ½Ð¸ÑŽ (Ð±Ð»Ð¸Ð¶Ð°Ð¹ÑˆÐ¸Ðµ Ð¿ÐµÑ€Ð²Ñ‹Ð¼Ð¸)
    table.sort(items, function(a, b) return a.Distance < b.Distance end)
    
    -- Ð£Ð±Ð¸Ñ€Ð°ÐµÐ¼ ÑÐ¿Ð°Ð¼ Ð¿Ñ€Ð¾ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð½Ð°Ð¹Ð´ÐµÐ½Ð½Ñ‹Ñ… Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ð¾Ð²
    return items
end

local function moveToPosition(targetPosition, callback)
    local player = Players.LocalPlayer
    local character = player.Character
    if not character then
        print("AUTOFARM: ÐŸÐµÑ€ÑÐ¾Ð½Ð°Ð¶ Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½")
        return false
    end
    
    local humanoidRootPart = character:FindFirstChild("HumanoidRootPart")
    if not humanoidRootPart then
        print("AUTOFARM: HumanoidRootPart Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½")
        return false
    end
    
    print("AUTOFARM: ÐÐ°Ñ‡Ð¸Ð½Ð°ÐµÐ¼ Ð¿Ð¾Ð»ÐµÑ‚ Ðº Ð¿Ð¾Ð·Ð¸Ñ†Ð¸Ð¸", targetPosition)
    
    -- Ð’ÐºÐ»ÑŽÑ‡Ð°ÐµÐ¼ NoClip ÐµÑÐ»Ð¸ Ð½ÑƒÐ¶Ð½Ð¾
    if AutofarmConfig.UseNoClipMovement and not isNoClipping then
        startNoClip()
        print("AUTOFARM: NoClip Ð²ÐºÐ»ÑŽÑ‡ÐµÐ½")
    end
    
    -- ÐÐ°ÑÑ‚Ñ€Ð°Ð¸Ð²Ð°ÐµÐ¼ Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð¶Ð° Ð´Ð»Ñ Ð¿Ð¾Ð»ÐµÑ‚Ð° (ÐºÐ°Ðº Ð² Ð¾Ð±Ñ‹Ñ‡Ð½Ð¾Ð¼ Ñ„Ð»Ð°Ðµ)
    local humanoid = character:FindFirstChild("Humanoid")
    if humanoid then
        humanoid.JumpPower = 0
        humanoid.JumpHeight = 0
        humanoid.HipHeight = 0
    end
    
    -- Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ BodyVelocity Ð´Ð»Ñ Ð´Ð²Ð¸Ð¶ÐµÐ½Ð¸Ñ (ÐºÐ°Ðº Ð² Ð¾Ð±Ñ‹Ñ‡Ð½Ð¾Ð¼ Ñ„Ð»Ð°Ðµ)
    local bodyVelocity = humanoidRootPart:FindFirstChild("AutofarmBodyVelocity")
    if not bodyVelocity then
        bodyVelocity = Instance.new("BodyVelocity")
        bodyVelocity.Name = "AutofarmBodyVelocity"
        bodyVelocity.MaxForce = Vector3.new(9e9, 9e9, 9e9) -- ÐºÐ°Ðº Ð² Ð¾Ð±Ñ‹Ñ‡Ð½Ð¾Ð¼ Ñ„Ð»Ð°Ðµ
        bodyVelocity.Parent = humanoidRootPart
    end
    
    -- ÐžÑ‚ÐºÐ»ÑŽÑ‡Ð°ÐµÐ¼ Ð³Ñ€Ð°Ð²Ð¸Ñ‚Ð°Ñ†Ð¸ÑŽ ÐµÑÐ»Ð¸ Ð½ÑƒÐ¶Ð½Ð¾
    if AutofarmConfig.UseFlightMovement then
        workspace.Gravity = 0
        print("AUTOFARM: Ð“Ñ€Ð°Ð²Ð¸Ñ‚Ð°Ñ†Ð¸Ñ Ð¾Ñ‚ÐºÐ»ÑŽÑ‡ÐµÐ½Ð°")
    end
    
    -- Ð”Ð²Ð¸Ð¶ÐµÐ½Ð¸Ðµ Ðº Ñ†ÐµÐ»Ð¸ Ð±Ð»Ð¸Ð·ÐºÐ¾ Ðº Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ñƒ Ð´Ð»Ñ Ð¿Ð¾Ð´Ð±Ð¾Ñ€Ð° Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ð¾Ð² (ÐºÐ°Ðº Ð² YBA)
    local adjustedTarget = Vector3.new(targetPosition.X, targetPosition.Y - 1, targetPosition.Z) -- Ð½ÐµÐ¼Ð½Ð¾Ð³Ð¾ Ð¿Ð¾Ð´ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ð¾Ð¼ Ð´Ð»Ñ Ð»ÑƒÑ‡ÑˆÐµÐ³Ð¾ Ð¿Ð¾Ð´Ð±Ð¾Ñ€Ð°
    
    local moveConnection
    moveConnection = RunService.Heartbeat:Connect(function()
        if not isAutofarmEnabled then
            -- ÐŸÑ€Ð¸ Ð¾Ñ‚ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ð¸ Ð°Ð²Ñ‚Ð¾Ñ„Ð°Ñ€Ð¼Ð° Ð¾Ñ‡Ð¸Ñ‰Ð°ÐµÐ¼ BodyVelocity
            if bodyVelocity and bodyVelocity.Parent then
                bodyVelocity.Velocity = Vector3.new(0, 0, 0)
                bodyVelocity:Destroy()
            end
            moveConnection:Disconnect()
            return
        end
        
        local currentPos = humanoidRootPart.Position
        local distance = (adjustedTarget - currentPos).Magnitude
        
        if distance > 3 then
            local direction = (adjustedTarget - currentPos).Unit
            -- Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼ ÑÐ¸ÑÑ‚ÐµÐ¼Ñƒ ÐºÐ°Ðº Ð² Ð¾Ð±Ñ‹Ñ‡Ð½Ð¾Ð¼ Ñ„Ð»Ð°Ðµ Ð´Ð»Ñ Ð¿Ð»Ð°Ð²Ð½Ð¾Ð³Ð¾ Ð´Ð²Ð¸Ð¶ÐµÐ½Ð¸Ñ
            local moveVector = direction * (AutofarmConfig.FlightSpeed * 10) -- ÐºÐ°Ðº Ð² Ð¾Ð±Ñ‹Ñ‡Ð½Ð¾Ð¼ Ñ„Ð»Ð°Ðµ
            bodyVelocity.Velocity = moveVector
        else
            -- Ð”Ð¾ÑÑ‚Ð¸Ð³Ð»Ð¸ Ñ†ÐµÐ»Ð¸ - Ð´Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð°Ñ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ð¾ÑÑ‚Ð¸ Ð¿ÐµÑ€ÐµÐ¼ÐµÑ‰ÐµÐ½Ð¸Ñ
            bodyVelocity.Velocity = Vector3.new(0, 0, 0)
            
            -- ÐŸÐ ÐžÐ’Ð•Ð ÐšÐ: Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ Ð»Ð¸ Ð¼Ñ‹ Ð½Ð° Ð¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ð¾Ð¹ Ð¿Ð¾Ð·Ð¸Ñ†Ð¸Ð¸?
            local finalDistance = (adjustedTarget - humanoidRootPart.Position).Magnitude
            print("AUTOFARM: ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð¿Ð¾Ð·Ð¸Ñ†Ð¸Ð¸ - Ñ€Ð°ÑÑÑ‚Ð¾ÑÐ½Ð¸Ðµ Ð´Ð¾ Ñ†ÐµÐ»Ð¸:", math.floor(finalDistance), "Ð¼")
            
            if finalDistance <= 5 then
                print("AUTOFARM: âœ… Ð£ÑÐ¿ÐµÑˆÐ½Ð¾ Ð´Ð¾ÑÑ‚Ð¸Ð³Ð»Ð¸ Ð¿Ð¾Ð·Ð¸Ñ†Ð¸Ð¸ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ð°")
                moveConnection:Disconnect()
                if callback then
                    callback()
                end
            else
                print("AUTOFARM: âš ï¸ ÐÐµÑ‚Ð¾Ñ‡Ð½Ð¾Ðµ Ð¿ÐµÑ€ÐµÐ¼ÐµÑ‰ÐµÐ½Ð¸Ðµ, ÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð¸Ñ€ÑƒÐµÐ¼ Ð¿Ð¾Ð·Ð¸Ñ†Ð¸ÑŽ...")
                -- ÐšÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð¸Ñ€ÑƒÐµÐ¼ Ð¿Ð¾Ð·Ð¸Ñ†Ð¸ÑŽ Ð¿Ñ€Ð¸Ð½ÑƒÐ´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾
                humanoidRootPart.CFrame = CFrame.new(adjustedTarget)
                task.wait(0.2) -- Ð½ÐµÐ±Ð¾Ð»ÑŒÑˆÐ°Ñ Ð·Ð°Ð´ÐµÑ€Ð¶ÐºÐ° Ð´Ð»Ñ ÑÑ‚Ð°Ð±Ð¸Ð»Ð¸Ð·Ð°Ñ†Ð¸Ð¸
                
                local correctedDistance = (adjustedTarget - humanoidRootPart.Position).Magnitude
                print("AUTOFARM: ÐŸÐ¾ÑÐ»Ðµ ÐºÐ¾Ñ€Ñ€ÐµÐºÑ†Ð¸Ð¸ Ñ€Ð°ÑÑÑ‚Ð¾ÑÐ½Ð¸Ðµ:", math.floor(correctedDistance), "Ð¼")
                
                moveConnection:Disconnect()
                if callback then
                    callback()
                end
            end
        end
    end)
    
    table.insert(autofarmConnections, moveConnection)
    return true
end

local function pickupItem(item)
    print("AUTOFARM: ÐŸÑ‹Ñ‚Ð°ÐµÐ¼ÑÑ Ð¿Ð¾Ð´Ð¾Ð±Ñ€Ð°Ñ‚ÑŒ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚", item.Name)
    
    -- Ð”ÐžÐŸÐžÐ›ÐÐ˜Ð¢Ð•Ð›Ð¬ÐÐÐ¯ ÐŸÐ ÐžÐ’Ð•Ð ÐšÐ: Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚ Ð²ÑÐµ ÐµÑ‰Ðµ Ð²ÐºÐ»ÑŽÑ‡ÐµÐ½ Ð² Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ°Ñ… Ð°Ð²Ñ‚Ð¾Ñ„Ð°Ñ€Ð¼Ð°
    if not AutofarmConfig.Items[item.Name] then
        print("AUTOFARM: ÐŸÑ€ÐµÐ´Ð¼ÐµÑ‚", item.Name, "Ð±Ñ‹Ð» Ð¾Ñ‚ÐºÐ»ÑŽÑ‡ÐµÐ½ Ð² Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ°Ñ… Ð²Ð¾ Ð²Ñ€ÐµÐ¼Ñ Ð¿Ð¾Ð´Ð±Ð¾Ñ€Ð° - Ð¿Ñ€Ð¾Ð¿ÑƒÑÐºÐ°ÐµÐ¼")
        task.spawn(function()
            if isAutofarmEnabled then
                processNextItem()
            end
        end)
        return
    end
    
    autofarmPickingUp = true
    
    local player = Players.LocalPlayer
    local character = player.Character
    if not character then
        print("AUTOFARM: ÐŸÐµÑ€ÑÐ¾Ð½Ð°Ð¶ Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½ Ð¿Ñ€Ð¸ Ð¿Ð¾Ð´Ð±Ð¾Ñ€Ðµ")
        autofarmPickingUp = false
        task.spawn(function()
            if isAutofarmEnabled then
                processNextItem()
            end
        end)
        return
    end
    
    local humanoidRootPart = character:FindFirstChild("HumanoidRootPart")
    if not humanoidRootPart then
        print("AUTOFARM: HumanoidRootPart Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½ Ð¿Ñ€Ð¸ Ð¿Ð¾Ð´Ð±Ð¾Ñ€Ðµ")
        autofarmPickingUp = false
        task.spawn(function()
            if isAutofarmEnabled then
                processNextItem()
            end
        end)
        return
    end
    
    -- YBA Ð¼ÐµÑ…Ð°Ð½Ð¸ÐºÐ°: Ð¿Ñ€Ð¸Ð±Ð»Ð¸Ð¶Ð°ÐµÐ¼ÑÑ Ðº Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ñƒ Ð² Ñ€Ð°Ð´Ð¸ÑƒÑ 6 Ð¼ÐµÑ‚Ñ€Ð¾Ð² Ð¸ Ð·Ð°Ð¶Ð¸Ð¼Ð°ÐµÐ¼ E Ð½Ð° 0.6 ÑÐµÐºÑƒÐ½Ð´Ñ‹
    local pickupConnection
    local pickupStartTime = tick()
    local hasStartedPickup = false
    local isKeyPressed = false
    
    pickupConnection = RunService.Heartbeat:Connect(function()
        if not isAutofarmEnabled then
            -- ÐŸÑ€Ð¸ Ð¾Ñ‚ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ð¸ Ð°Ð²Ñ‚Ð¾Ñ„Ð°Ñ€Ð¼Ð° ÐžÐ‘Ð¯Ð—ÐÐ¢Ð•Ð›Ð¬ÐÐž Ð¾Ñ‚Ð¿ÑƒÑÐºÐ°ÐµÐ¼ ÐºÐ»Ð°Ð²Ð¸ÑˆÑƒ
            if isKeyPressed then
                pcall(function()
                    if game:GetService("VirtualInputManager") then
                        game:GetService("VirtualInputManager"):SendKeyEvent(false, AutofarmConfig.PickupKey, false, game)
                    end
                    game:GetService("UserInputService").InputEnded:Fire(
                        {KeyCode = AutofarmConfig.PickupKey, UserInputType = Enum.UserInputType.Keyboard},
                        false
                    )
                end)
                isKeyPressed = false
                print("AUTOFARM: ÐšÐ»Ð°Ð²Ð¸ÑˆÐ° E Ð¾Ñ‚Ð¿ÑƒÑ‰ÐµÐ½Ð° Ð¿Ñ€Ð¸ Ð¾Ñ‚ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ð¸ Ð°Ð²Ñ‚Ð¾Ñ„Ð°Ñ€Ð¼Ð°")
            end
            pickupConnection:Disconnect()
            autofarmPickingUp = false
            return
        end
        
        -- ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼ Ñ‡Ñ‚Ð¾ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚ ÐµÑ‰Ðµ Ñ„Ð¸Ð·Ð¸Ñ‡ÐµÑÐºÐ¸ ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÐµÑ‚
        local itemStillExists = false
        pcall(function()
            if item.Model and item.Model.Parent then
                local worldPivot = item.Model:GetPivot()
                if worldPivot and worldPivot.Position and worldPivot.Position.Magnitude > 0 then
                    local hasPhysicalParts = false
                    for _, child in pairs(item.Model:GetChildren()) do
                        if child:IsA("BasePart") and child.Size.Magnitude > 0 then
                            hasPhysicalParts = true
                            break
                        end
                    end
                    itemStillExists = hasPhysicalParts
                end
            end
        end)
        
        if not itemStillExists then
            print("AUTOFARM: ÐŸÑ€ÐµÐ´Ð¼ÐµÑ‚", item.Name, "Ð¸ÑÑ‡ÐµÐ· (Ð½ÐµÑ‚ Ñ„Ð¸Ð·Ð¸Ñ‡ÐµÑÐºÐ¸Ñ… Ñ‡Ð°ÑÑ‚ÐµÐ¹) - Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ Ð¿Ð¾Ð´Ð¾Ð±Ñ€Ð°Ð½")
            if isKeyPressed then
                pcall(function()
                    if game:GetService("VirtualInputManager") then
                        game:GetService("VirtualInputManager"):SendKeyEvent(false, AutofarmConfig.PickupKey, false, game)
                    end
                    game:GetService("UserInputService").InputEnded:Fire(
                        {KeyCode = AutofarmConfig.PickupKey, UserInputType = Enum.UserInputType.Keyboard},
                        false
                    )
                end)
                isKeyPressed = false
            end
            
            -- ÐŸÑ€ÐµÐ´Ð¼ÐµÑ‚ Ð¸ÑÑ‡ÐµÐ· - Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼ Ð±Ñ‹Ð» Ð»Ð¸ ÑÑ‚Ð¾ Ñ€ÐµÐ°Ð»ÑŒÐ½Ñ‹Ð¹ Ð¿Ð¾Ð´Ð±Ð¾Ñ€
            local itemKey = getItemKey(item)
            local actualPickupTime = tick() - pickupStartTime
            
            if hasStartedPickup and actualPickupTime >= (AutofarmConfig.PickupDuration * 0.2) then
                -- ÐŸÑ€ÐµÐ´Ð¼ÐµÑ‚ Ð¸ÑÑ‡ÐµÐ· ÐŸÐžÐ¡Ð›Ð• Ñ‚Ð¾Ð³Ð¾ ÐºÐ°Ðº Ð¼Ñ‹ Ð½Ð°Ñ‡Ð°Ð»Ð¸ Ð¶Ð°Ñ‚ÑŒ E - ÑÑ‚Ð¾ ÑƒÑÐ¿ÐµÑˆÐ½Ñ‹Ð¹ Ð¿Ð¾Ð´Ð±Ð¾Ñ€
                local attempts = (autofarmItemAttempts[itemKey] or 0) + 1
                resetItemAttempts(itemKey)
                autofarmLastPickupTime = tick() -- Ð’ÑÐµÐ³Ð´Ð° Ð¾Ð±Ð½Ð¾Ð²Ð»ÑÐµÐ¼ Ñ‚Ð°Ð¹Ð¼ÐµÑ€ Ð¿Ñ€Ð¸ Ð¸ÑÑ‡ÐµÐ·Ð½Ð¾Ð²ÐµÐ½Ð¸Ð¸ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ð°
                print("AUTOFARM: âœ… ÐŸÑ€ÐµÐ´Ð¼ÐµÑ‚", item.Name, "Ð£Ð¡ÐŸÐ•Ð¨ÐÐž Ð¿Ð¾Ð´Ð¾Ð±Ñ€Ð°Ð½ Ð·Ð°", attempts, "Ð¿Ð¾Ð¿Ñ‹Ñ‚ÐºÐ¸ (Ð¸ÑÑ‡ÐµÐ· Ð¿Ð¾ÑÐ»Ðµ", math.floor(actualPickupTime * 100) / 100, "ÑÐµÐº)")
            else
                -- ÐŸÑ€ÐµÐ´Ð¼ÐµÑ‚ Ð¸ÑÑ‡ÐµÐ· ÑÐ»Ð¸ÑˆÐºÐ¾Ð¼ Ð±Ñ‹ÑÑ‚Ñ€Ð¾ - Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ Ð±Ð°Ð³, Ð½Ðµ ÑÑ‡Ð¸Ñ‚Ð°ÐµÐ¼ ÑƒÑÐ¿ÐµÑˆÐ½Ñ‹Ð¼ Ð¿Ð¾Ð´Ð±Ð¾Ñ€Ð¾Ð¼
                incrementItemAttempts(itemKey)
                print("AUTOFARM: âš ï¸ ÐŸÑ€ÐµÐ´Ð¼ÐµÑ‚", item.Name, "Ð¸ÑÑ‡ÐµÐ· Ð¿Ð¾Ð´Ð¾Ð·Ñ€Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ Ð±Ñ‹ÑÑ‚Ñ€Ð¾ (", math.floor(actualPickupTime * 100) / 100, "ÑÐµÐº) - Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ Ð±Ð°Ð³")
            end
            
            pickupConnection:Disconnect()
            autofarmPickingUp = false
            
            -- Ð–Ð´ÐµÐ¼ Ð½ÐµÐ¼Ð½Ð¾Ð³Ð¾ Ð¸ Ð¿ÐµÑ€ÐµÑ…Ð¾Ð´Ð¸Ð¼ Ðº ÑÐ»ÐµÐ´ÑƒÑŽÑ‰ÐµÐ¼Ñƒ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ñƒ
            task.spawn(function()
                task.wait(0.5)
                if isAutofarmEnabled then
                    processNextItem()
                end
            end)
            return
        end
        
        -- ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼ Ñ€Ð°ÑÑÑ‚Ð¾ÑÐ½Ð¸Ðµ Ð´Ð¾ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ð°
        local distance = (humanoidRootPart.Position - item.Position).Magnitude
        
        -- Ð•ÑÐ»Ð¸ Ð² Ñ€Ð°Ð´Ð¸ÑƒÑÐµ Ð¿Ð¾Ð´Ð±Ð¾Ñ€Ð° Ð¸ ÐµÑ‰Ðµ Ð½Ðµ Ð½Ð°Ñ‡Ð°Ð»Ð¸ Ð¿Ð¾Ð´Ð±Ð¾Ñ€
        if distance <= AutofarmConfig.PickupRadius and not hasStartedPickup then
            print("AUTOFARM: ðŸ”§ ÐÐ°Ñ‡Ð¸Ð½Ð°ÐµÐ¼ Ð¿Ð¾Ð´Ð±Ð¾Ñ€", item.Name, "(", math.floor(distance), "Ð¼)")
            hasStartedPickup = true
            pickupStartTime = tick()
            
            -- Ð—Ð°Ð¶Ð¸Ð¼Ð°ÐµÐ¼ ÐºÐ»Ð°Ð²Ð¸ÑˆÑƒ E (ÑÐ¼ÑƒÐ»Ð¸Ñ€ÑƒÐµÐ¼ Ð½Ð°Ð¶Ð°Ñ‚Ð¸Ðµ ÐºÐ°Ðº Ð² Ñ€ÐµÐ°Ð»ÑŒÐ½Ð¾Ð¼ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸)
            pcall(function()
                -- ÐŸÑ€Ð¾Ð±ÑƒÐµÐ¼ Ð½ÐµÑÐºÐ¾Ð»ÑŒÐºÐ¾ ÑÐ¿Ð¾ÑÐ¾Ð±Ð¾Ð² Ð´Ð»Ñ Ð¼Ð°ÐºÑÐ¸Ð¼Ð°Ð»ÑŒÐ½Ð¾Ð¹ ÑÐ¾Ð²Ð¼ÐµÑÑ‚Ð¸Ð¼Ð¾ÑÑ‚Ð¸
                if game:GetService("VirtualInputManager") then
                    game:GetService("VirtualInputManager"):SendKeyEvent(true, AutofarmConfig.PickupKey, false, game)
                end
                -- Ð”Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ ÑÐ¼ÑƒÐ»Ð¸Ñ€ÑƒÐµÐ¼ Ñ‡ÐµÑ€ÐµÐ· UserInputService Ð´Ð»Ñ Ð½ÐµÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ñ… Ð¸Ð³Ñ€
                game:GetService("UserInputService").InputBegan:Fire(
                    {KeyCode = AutofarmConfig.PickupKey, UserInputType = Enum.UserInputType.Keyboard},
                    false
                )
            end)
            isKeyPressed = true
            
        elseif distance > AutofarmConfig.PickupRadius and not hasStartedPickup then
            -- Ð•ÑÐ»Ð¸ ÑÐ»Ð¸ÑˆÐºÐ¾Ð¼ Ð´Ð°Ð»ÐµÐºÐ¾, Ð¿Ð¾Ð´Ð»ÐµÑ‚Ð°ÐµÐ¼ Ð±Ð»Ð¸Ð¶Ðµ
            -- Ð£Ð±Ð¸Ñ€Ð°ÐµÐ¼ ÑÐ¿Ð°Ð¼ Ð¿Ñ€Ð¾ Ð¿Ð¾Ð´Ð»ÐµÑ‚
            -- Ð›ÐµÑ‚Ð¸Ð¼ Ðº Ð¿Ð¾Ð·Ð¸Ñ†Ð¸Ð¸ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ð° Ñ Ð½ÐµÐ±Ð¾Ð»ÑŒÑˆÐ¸Ð¼ Ð¾Ñ‚ÐºÐ»Ð¾Ð½ÐµÐ½Ð¸ÐµÐ¼
            local targetPos = Vector3.new(item.Position.X, item.Position.Y + 2, item.Position.Z)
            moveToPosition(targetPos, function()
                -- ÐŸÐ¾ÑÐ»Ðµ Ð¿Ð¾Ð´Ð»ÐµÑ‚Ð° Ð¿Ñ€Ð¾Ð´Ð¾Ð»Ð¶Ð°ÐµÐ¼ Ð¿Ð¾Ð´Ð±Ð¾Ñ€
            end)
            return
        end
        
        -- Ð•ÑÐ»Ð¸ Ð½Ð°Ñ‡Ð°Ð»Ð¸ Ð¿Ð¾Ð´Ð±Ð¾Ñ€, Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼ Ð¿Ñ€Ð¾ÑˆÐ»Ð¾ Ð»Ð¸ Ð½ÑƒÐ¶Ð½Ð¾Ðµ Ð²Ñ€ÐµÐ¼Ñ
        if hasStartedPickup and tick() - pickupStartTime >= AutofarmConfig.PickupDuration then
            -- ÐžÑ‚Ð¿ÑƒÑÐºÐ°ÐµÐ¼ ÐºÐ»Ð°Ð²Ð¸ÑˆÑƒ E
            if isKeyPressed then
                pcall(function()
                    if game:GetService("VirtualInputManager") then
                        game:GetService("VirtualInputManager"):SendKeyEvent(false, AutofarmConfig.PickupKey, false, game)
                    end
                    -- Ð”Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ ÑÐ¼ÑƒÐ»Ð¸Ñ€ÑƒÐµÐ¼ Ð¾Ñ‚Ð¿ÑƒÑÐºÐ°Ð½Ð¸Ðµ Ñ‡ÐµÑ€ÐµÐ· UserInputService
                    game:GetService("UserInputService").InputEnded:Fire(
                        {KeyCode = AutofarmConfig.PickupKey, UserInputType = Enum.UserInputType.Keyboard},
                        false
                    )
                end)
                isKeyPressed = false
            end
            print("AUTOFARM: Ð—Ð°Ð²ÐµÑ€ÑˆÐ¸Ð»Ð¸ Ð¿Ð¾Ð¿Ñ‹Ñ‚ÐºÑƒ Ð¿Ð¾Ð´Ð±Ð¾Ñ€Ð°", item.Name)
            
            -- Ð£Ð²ÐµÐ»Ð¸Ñ‡Ð¸Ð²Ð°ÐµÐ¼ ÑÑ‡ÐµÑ‚Ñ‡Ð¸Ðº Ð¿Ð¾Ð¿Ñ‹Ñ‚Ð¾Ðº Ð´Ð»Ñ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ð°
            local itemKey = getItemKey(item)
            local attempts = incrementItemAttempts(itemKey)
            print("AUTOFARM: ÐŸÐ¾Ð¿Ñ‹Ñ‚ÐºÐ°", attempts, "/3 Ð´Ð»Ñ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ð°", item.Name)
            
            -- Ð¤Ð˜ÐšÐ¡: ÐžÐ±Ð½Ð¾Ð²Ð»ÑÐµÐ¼ Ñ‚Ð°Ð¹Ð¼ÐµÑ€ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ ÐµÑÐ»Ð¸ Ð¿Ð¾Ð´Ð±Ð¾Ñ€ Ð±Ñ‹Ð» ÑƒÑÐ¿ÐµÑˆÐ½Ñ‹Ð¼ Ð·Ð° 1-2 Ð¿Ð¾Ð¿Ñ‹Ñ‚ÐºÐ¸
            if attempts <= 2 then
                autofarmLastPickupTime = tick()
                print("AUTOFARM: âœ… Ð£ÑÐ¿ÐµÑˆÐ½Ñ‹Ð¹ Ð¿Ð¾Ð´Ð±Ð¾Ñ€ Ð·Ð°", attempts, "Ð¿Ð¾Ð¿Ñ‹Ñ‚ÐºÐ¸ - Ñ‚Ð°Ð¹Ð¼ÐµÑ€ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½")
            else
                print("AUTOFARM: âš ï¸ ÐŸÐ¾Ð´Ð±Ð¾Ñ€ Ð½ÐµÑƒÑÐ¿ÐµÑˆÐµÐ½ -", attempts, "Ð¿Ð¾Ð¿Ñ‹Ñ‚ÐºÐ¸, Ñ‚Ð°Ð¹Ð¼ÐµÑ€ ÐÐ• Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½")
            end
            
            pickupConnection:Disconnect()
            autofarmPickingUp = false
            
            -- Ð–Ð´ÐµÐ¼ Ð½ÐµÐ¼Ð½Ð¾Ð³Ð¾ Ð¸ Ð¿ÐµÑ€ÐµÑ…Ð¾Ð´Ð¸Ð¼ Ðº ÑÐ»ÐµÐ´ÑƒÑŽÑ‰ÐµÐ¼Ñƒ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ñƒ
            task.spawn(function()
                task.wait(1) -- Ð´Ð°ÐµÐ¼ Ð²Ñ€ÐµÐ¼Ñ Ð½Ð° Ð¿Ð¾Ð´Ð±Ð¾Ñ€ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ð°
                if isAutofarmEnabled then
                    processNextItem()
                end
            end)
            return
        end
        
        -- Ð¢Ð°Ð¹Ð¼Ð°ÑƒÑ‚ Ð¾Ð±Ñ‰Ð¸Ð¹ - ÐµÑÐ»Ð¸ ÑÐ»Ð¸ÑˆÐºÐ¾Ð¼ Ð´Ð¾Ð»Ð³Ð¾ Ð¿Ñ‹Ñ‚Ð°ÐµÐ¼ÑÑ Ð¿Ð¾Ð´Ð¾Ð±Ñ€Ð°Ñ‚ÑŒ
        if tick() - pickupStartTime > 10 then
            print("AUTOFARM: ÐžÐ±Ñ‰Ð¸Ð¹ Ñ‚Ð°Ð¹Ð¼Ð°ÑƒÑ‚ Ð´Ð»Ñ", item.Name)
            if isKeyPressed then
                pcall(function()
                    if game:GetService("VirtualInputManager") then
                        game:GetService("VirtualInputManager"):SendKeyEvent(false, AutofarmConfig.PickupKey, false, game)
                    end
                    game:GetService("UserInputService").InputEnded:Fire(
                        {KeyCode = AutofarmConfig.PickupKey, UserInputType = Enum.UserInputType.Keyboard},
                        false
                    )
                end)
                isKeyPressed = false
            end
            
            -- Ð£Ð²ÐµÐ»Ð¸Ñ‡Ð¸Ð²Ð°ÐµÐ¼ ÑÑ‡ÐµÑ‚Ñ‡Ð¸Ðº Ð¿Ð¾Ð¿Ñ‹Ñ‚Ð¾Ðº Ð´Ð»Ñ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ð° (Ñ‚Ð°Ð¹Ð¼Ð°ÑƒÑ‚)
            local itemKey = getItemKey(item)
            local attempts = incrementItemAttempts(itemKey)
            print("AUTOFARM: Ð¢Ð°Ð¹Ð¼Ð°ÑƒÑ‚ - Ð¿Ð¾Ð¿Ñ‹Ñ‚ÐºÐ°", attempts, "/3 Ð´Ð»Ñ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ð°", item.Name)
            
            -- Ð¤Ð˜ÐšÐ¡: ÐžÐ±Ð½Ð¾Ð²Ð»ÑÐµÐ¼ Ñ‚Ð°Ð¹Ð¼ÐµÑ€ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ ÐµÑÐ»Ð¸ ÑÑ‚Ð¾ Ð±Ñ‹Ð»Ð° 1-2 Ð¿Ð¾Ð¿Ñ‹Ñ‚ÐºÐ°
            if attempts <= 2 then
                autofarmLastPickupTime = tick()
                print("AUTOFARM: âœ… Ð¢Ð°Ð¹Ð¼Ð°ÑƒÑ‚ Ð½Ð°", attempts, "Ð¿Ð¾Ð¿Ñ‹Ñ‚ÐºÐµ - Ñ‚Ð°Ð¹Ð¼ÐµÑ€ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½")
            else
                print("AUTOFARM: âš ï¸ Ð¢Ð°Ð¹Ð¼Ð°ÑƒÑ‚ Ð½Ð°", attempts, "Ð¿Ð¾Ð¿Ñ‹Ñ‚ÐºÐµ, Ñ‚Ð°Ð¹Ð¼ÐµÑ€ ÐÐ• Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½")
            end
            
            pickupConnection:Disconnect()
            autofarmPickingUp = false
            task.spawn(function()
                if isAutofarmEnabled then
                    processNextItem()
                end
            end)
        end
    end)
    
    table.insert(autofarmConnections, pickupConnection)
end

function processNextItem()
    if not isAutofarmEnabled then
        return
    end
    
    -- Ð•ÑÐ»Ð¸ ÑƒÐ¶Ðµ Ñ‡Ñ‚Ð¾-Ñ‚Ð¾ Ð¿Ð¾Ð´Ð±Ð¸Ñ€Ð°ÐµÐ¼, Ð¶Ð´ÐµÐ¼
    if autofarmPickingUp then
        -- Ð£Ð±Ð¸Ñ€Ð°ÐµÐ¼ ÑÐ¿Ð°Ð¼ Ð¿Ñ€Ð¾ Ð¾Ð¶Ð¸Ð´Ð°Ð½Ð¸Ðµ Ð¿Ð¾Ð´Ð±Ð¾Ñ€Ð°
        return
    end
    
    -- ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼ Ð½ÐµÐ°ÐºÑ‚Ð¸Ð²Ð½Ð¾ÑÑ‚ÑŒ (15 ÑÐµÐºÑƒÐ½Ð´ Ð±ÐµÐ· Ð¿Ð¾Ð´Ð±Ð¾Ñ€Ð°)
    -- Ð¢Ð°Ð¹Ð¼ÐµÑ€ Ð´Ð¾Ð»Ð¶ÐµÐ½ Ð±Ñ‹Ñ‚ÑŒ Ð¸Ð½Ð¸Ñ†Ð¸Ð°Ð»Ð¸Ð·Ð¸Ñ€Ð¾Ð²Ð°Ð½ (> 0) Ð¸ Ð¿Ñ€Ð¾ÑˆÐ»Ð¾ Ð±Ð¾Ð»ÑŒÑˆÐµ 15 ÑÐµÐºÑƒÐ½Ð´
    local currentTime = tick()
    local timeSinceLastPickup = autofarmLastPickupTime and autofarmLastPickupTime > 0 and (currentTime - autofarmLastPickupTime) or -1
    
    if timeSinceLastPickup > 15 then
        print("AUTOFARM: ÐÐµÐ°ÐºÑ‚Ð¸Ð²Ð½Ð¾ÑÑ‚ÑŒ", math.floor(timeSinceLastPickup), "ÑÐµÐºÑƒÐ½Ð´ - ÐŸÐžÐ›ÐÐ«Ð™ ÐŸÐ•Ð Ð•Ð—ÐÐŸÐ£Ð¡Ðš Ð°Ð²Ñ‚Ð¾Ñ„Ð°Ñ€Ð¼Ð°")
        
        task.spawn(function()
            -- ÐŸÐ¾Ð»Ð½Ð¾ÑÑ‚ÑŒÑŽ Ð¾ÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÐ¼ Ð°Ð²Ñ‚Ð¾Ñ„Ð°Ñ€Ð¼
            stopAutofarm()
            
            -- Ð–Ð´ÐµÐ¼ Ð½ÐµÐ¼Ð½Ð¾Ð³Ð¾ Ð´Ð»Ñ ÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ð¾Ð³Ð¾ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¸Ñ
            task.wait(1)
            
            -- Ð—Ð°Ð¿ÑƒÑÐºÐ°ÐµÐ¼ Ð°Ð²Ñ‚Ð¾Ñ„Ð°Ñ€Ð¼ Ð·Ð°Ð½Ð¾Ð²Ð¾ (ÐºÐ°Ðº Ð±ÑƒÐ´Ñ‚Ð¾ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ Ð½Ð°Ð¶Ð°Ð» ÐºÐ½Ð¾Ð¿ÐºÑƒ)
            print("AUTOFARM: ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹ Ð¿ÐµÑ€ÐµÐ·Ð°Ð¿ÑƒÑÐº...")
            startAutofarm()
        end)
        return
    end
    
    -- ÐžÐ¢Ð›ÐÐ”ÐšÐ: ÐŸÐ¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÐ¼ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ Ñ‚Ð°Ð¹Ð¼ÐµÑ€Ð° ÐºÐ°Ð¶Ð´Ñ‹Ð¹ Ñ€Ð°Ð·
    local currentTime = tick()
    local timeSinceLastPickup = autofarmLastPickupTime and autofarmLastPickupTime > 0 and (currentTime - autofarmLastPickupTime) or -1
    if timeSinceLastPickup > 0 then
        print("AUTOFARM DEBUG: ÐŸÑ€Ð¾ÑˆÐ»Ð¾", math.floor(timeSinceLastPickup), "ÑÐµÐºÑƒÐ½Ð´ Ñ Ð¿Ð¾ÑÐ»ÐµÐ´Ð½ÐµÐ³Ð¾ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾Ð³Ð¾ Ð¿Ð¾Ð´Ð±Ð¾Ñ€Ð°")
    else
        print("AUTOFARM DEBUG: Ð¢Ð°Ð¹Ð¼ÐµÑ€ Ð½Ðµ Ð¸Ð½Ð¸Ñ†Ð¸Ð°Ð»Ð¸Ð·Ð¸Ñ€Ð¾Ð²Ð°Ð½")
    end
    
    -- Ð¡ÐºÐ°Ð½Ð¸Ñ€ÑƒÐµÐ¼ Ð½Ð¾Ð²Ñ‹Ðµ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ñ‹
    local items = findAutofarmItems()
    if #items == 0 then
        -- Ð•ÑÐ»Ð¸ Ð½ÐµÑ‚ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ñ‹Ñ… Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ð¾Ð², Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼ Ð¿Ñ€Ð¾Ð¿ÑƒÑ‰ÐµÐ½Ð½Ñ‹Ðµ
        if next(autofarmSkippedItems) then
            print("AUTOFARM: ÐžÐ±Ñ‹Ñ‡Ð½Ñ‹Ðµ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ñ‹ Ð·Ð°ÐºÐ¾Ð½Ñ‡Ð¸Ð»Ð¸ÑÑŒ, Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼ Ð¿Ñ€Ð¾Ð¿ÑƒÑ‰ÐµÐ½Ð½Ñ‹Ðµ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ñ‹")
            
            -- Ð¤Ð¸Ð»ÑŒÑ‚Ñ€ÑƒÐµÐ¼ Ð¿Ñ€Ð¾Ð¿ÑƒÑ‰ÐµÐ½Ð½Ñ‹Ðµ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ñ‹ - ÑƒÐ´Ð°Ð»ÑÐµÐ¼ Ñ‚Ðµ, Ñ‡Ñ‚Ð¾ Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°Ð»Ð¸ÑÑŒ Ð±Ð¾Ð»ÐµÐµ 5 Ñ€Ð°Ð·
            local validSkippedItems = {}
            for itemKey, skippedItem in pairs(autofarmSkippedItems) do
                local returnCount = (autofarmSkippedReturns[itemKey] or 0) + 1
                autofarmSkippedReturns[itemKey] = returnCount
                
                if returnCount <= 5 then
                    validSkippedItems[itemKey] = skippedItem
                    print("AUTOFARM: Ð’Ð¾Ð·Ð²Ñ€Ð°Ñ‚ Ðº Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ñƒ", skippedItem.Name, "- Ð¿Ð¾Ð¿Ñ‹Ñ‚ÐºÐ°", returnCount, "/5")
                else
                    print("AUTOFARM: ÐŸÑ€ÐµÐ´Ð¼ÐµÑ‚", skippedItem.Name, "Ð·Ð°Ð±Ñ‹Ñ‚ Ð½Ð°Ð²ÑÐµÐ³Ð´Ð° - Ð¿Ñ€ÐµÐ²Ñ‹ÑˆÐµÐ½Ð¾ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‚Ð¾Ð² (5/5)")
                    autofarmSkippedReturns[itemKey] = nil -- ÐžÑ‡Ð¸Ñ‰Ð°ÐµÐ¼ ÑÑ‡ÐµÑ‚Ñ‡Ð¸Ðº
                end
            end
            
            if next(validSkippedItems) then
                print("AUTOFARM: Ð’Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÐ¼ÑÑ Ðº", table.getn and table.getn(validSkippedItems) or "Ð½ÐµÑÐºÐ¾Ð»ÑŒÐºÐ¸Ð¼", "Ð¿Ñ€Ð¾Ð¿ÑƒÑ‰ÐµÐ½Ð½Ñ‹Ð¼ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ð°Ð¼")
                -- Ð¡Ð±Ñ€Ð°ÑÑ‹Ð²Ð°ÐµÐ¼ Ð¿Ð¾Ð¿Ñ‹Ñ‚ÐºÐ¸ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð´Ð»Ñ Ð²Ð°Ð»Ð¸Ð´Ð½Ñ‹Ñ… Ð¿Ñ€Ð¾Ð¿ÑƒÑ‰ÐµÐ½Ð½Ñ‹Ñ… Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ð¾Ð²
                for itemKey, skippedItem in pairs(validSkippedItems) do
                    resetItemAttempts(itemKey)
                end
                autofarmSkippedItems = {}
                -- ÐŸÐµÑ€ÐµÐ·Ð°Ð¿ÑƒÑÐºÐ°ÐµÐ¼ Ð¿Ð¾Ð¸ÑÐº
                task.spawn(function()
                    task.wait(0.5)
                    if isAutofarmEnabled then
                        processNextItem()
                    end
                end)
                return
                         else
                 print("AUTOFARM: Ð’ÑÐµ Ð¿Ñ€Ð¾Ð¿ÑƒÑ‰ÐµÐ½Ð½Ñ‹Ðµ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ñ‹ Ð·Ð°Ð±Ñ‹Ñ‚Ñ‹ - ÑÐºÐ°Ð½Ð¸Ñ€ÑƒÐµÐ¼ ÐºÐ°Ñ€Ñ‚Ñƒ ÐµÑ‰Ðµ Ñ€Ð°Ð·")
                 autofarmSkippedItems = {}
                 
                 -- Ð”ÐµÐ»Ð°ÐµÐ¼ ÐµÑ‰Ðµ Ð¾Ð´Ð½Ð¾ ÑÐºÐ°Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ ÐºÐ°Ñ€Ñ‚Ñ‹
                 task.spawn(function()
                     task.wait(1) -- ÐÐµÐ±Ð¾Ð»ÑŒÑˆÐ°Ñ Ð¿Ð°ÑƒÐ·Ð°
                     if not isAutofarmEnabled then return end
                     
                     local finalScanItems = findAutofarmItems()
                     if #finalScanItems > 0 then
                         print("AUTOFARM: ÐŸÑ€Ð¸ Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€Ð½Ð¾Ð¼ ÑÐºÐ°Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ð¸ Ð½Ð°Ð¹Ð´ÐµÐ½Ð¾", #finalScanItems, "Ð½Ð¾Ð²Ñ‹Ñ… Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ð¾Ð²!")
                         processNextItem()
                     else
                         print("AUTOFARM: ÐŸÑ€Ð¸ Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€Ð½Ð¾Ð¼ ÑÐºÐ°Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ð¸ Ð½Ð¾Ð²Ñ‹Ñ… Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ð¾Ð² Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½Ð¾ - Ð²Ñ‹ÐºÐ»ÑŽÑ‡Ð°ÐµÐ¼ÑÑ Ð½Ð° 60 ÑÐµÐºÑƒÐ½Ð´")
                         
                         -- ÐžÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÐ¼ Ð°Ð²Ñ‚Ð¾Ñ„Ð°Ñ€Ð¼
                         stopAutofarm()
                         autofarmAutoRestarting = true
                         
                         -- Ð—Ð°Ð¿ÑƒÑÐºÐ°ÐµÐ¼ Ñ‚Ð°Ð¹Ð¼ÐµÑ€ Ð½Ð° 60 ÑÐµÐºÑƒÐ½Ð´
                         autofarmRestartTimer = task.spawn(function()
                             task.wait(60)
                             if autofarmAutoRestarting then
                                 print("ðŸ¤– AUTOFARM: ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹ Ð¿ÐµÑ€ÐµÐ·Ð°Ð¿ÑƒÑÐº Ñ‡ÐµÑ€ÐµÐ· 60 ÑÐµÐºÑƒÐ½Ð´")
                                 autofarmAutoRestarting = false
                                 startAutofarm()
                             end
                         end)
                         
                         print("ðŸ¤– AUTOFARM: Ð’Ñ‹ÐºÐ»ÑŽÑ‡ÐµÐ½ Ð½Ð° 60 ÑÐµÐºÑƒÐ½Ð´ - Ð¶Ð´ÐµÐ¼ Ð¿Ð¾ÑÐ²Ð»ÐµÐ½Ð¸Ñ Ð½Ð¾Ð²Ñ‹Ñ… Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ð¾Ð²")
                     end
                 end)
                 return
             end
        else
            -- Ð£Ð±Ð¸Ñ€Ð°ÐµÐ¼ ÑÐ¿Ð°Ð¼ Ð¿Ñ€Ð¾ Ð¾Ñ‚ÑÑƒÑ‚ÑÑ‚Ð²Ð¸Ðµ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ð¾Ð²
            -- Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼ spawn Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð¸Ð·Ð±ÐµÐ¶Ð°Ñ‚ÑŒ Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²ÐºÐ¸
            task.spawn(function()
                task.wait(AutofarmConfig.ScanInterval)
                if isAutofarmEnabled then
                    processNextItem()
                end
            end)
            return
        end
    end
    
    -- Ð‘ÐµÑ€ÐµÐ¼ Ð±Ð»Ð¸Ð¶Ð°Ð¹ÑˆÐ¸Ð¹ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚
    local nextItem = items[1]
    autofarmCurrentTarget = nextItem
    
    -- Ð”ÐžÐŸÐžÐ›ÐÐ˜Ð¢Ð•Ð›Ð¬ÐÐÐ¯ ÐŸÐ ÐžÐ’Ð•Ð ÐšÐ: Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚ Ð²ÑÐµ ÐµÑ‰Ðµ Ð²ÐºÐ»ÑŽÑ‡ÐµÐ½ Ð² Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ°Ñ… Ð°Ð²Ñ‚Ð¾Ñ„Ð°Ñ€Ð¼Ð°
    if not AutofarmConfig.Items[nextItem.Name] then
        print("AUTOFARM: ÐŸÑ€ÐµÐ´Ð¼ÐµÑ‚", nextItem.Name, "Ð±Ñ‹Ð» Ð¾Ñ‚ÐºÐ»ÑŽÑ‡ÐµÐ½ Ð² Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ°Ñ… - Ð¿Ñ€Ð¾Ð¿ÑƒÑÐºÐ°ÐµÐ¼")
        task.spawn(function()
            task.wait(0.1)
            if isAutofarmEnabled then
                processNextItem()
            end
        end)
        return
    end
    
    -- Ð”ÐžÐŸÐžÐ›ÐÐ˜Ð¢Ð•Ð›Ð¬ÐÐÐ¯ ÐŸÐ ÐžÐ’Ð•Ð ÐšÐ: Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚ ÐµÑ‰Ðµ ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÐµÑ‚ Ð¿ÐµÑ€ÐµÐ´ Ð¿Ð¾Ð»ÐµÑ‚Ð¾Ð¼
    local itemExists = false
    pcall(function()
        if nextItem.Model and nextItem.Model.Parent then
            -- ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼ Ñ‡Ñ‚Ð¾ Ñƒ Ð¼Ð¾Ð´ÐµÐ»Ð¸ ÐµÑÑ‚ÑŒ WorldPivot Ð¸ Ð¿Ð¾Ð·Ð¸Ñ†Ð¸Ñ Ð²Ð°Ð»Ð¸Ð´Ð½Ð°
            local worldPivot = nextItem.Model:GetPivot()
            if worldPivot and worldPivot.Position and worldPivot.Position.Magnitude > 0 then
                -- Ð”Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼ Ñ‡Ñ‚Ð¾ Ð¼Ð¾Ð´ÐµÐ»ÑŒ Ð¸Ð¼ÐµÐµÑ‚ Ñ„Ð¸Ð·Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ Ñ‡Ð°ÑÑ‚Ð¸
                local hasPhysicalParts = false
                for _, child in pairs(nextItem.Model:GetChildren()) do
                    if child:IsA("BasePart") and child.Size.Magnitude > 0 then
                        hasPhysicalParts = true
                        break
                    end
                end
                itemExists = hasPhysicalParts
            end
        end
    end)
    
    if not itemExists then
        print("AUTOFARM: ÐŸÑ€ÐµÐ´Ð¼ÐµÑ‚", nextItem.Name, "Ð¸ÑÑ‡ÐµÐ· Ð”Ðž Ð½Ð°Ñ‡Ð°Ð»Ð° Ð¿Ð¾Ð»ÐµÑ‚Ð° (Ð½ÐµÑ‚ Ñ„Ð¸Ð·Ð¸Ñ‡ÐµÑÐºÐ¸Ñ… Ñ‡Ð°ÑÑ‚ÐµÐ¹) - Ð¸Ñ‰ÐµÐ¼ ÑÐ»ÐµÐ´ÑƒÑŽÑ‰Ð¸Ð¹")
        task.spawn(function()
            task.wait(0.5)
            if isAutofarmEnabled then
                processNextItem()
            end
        end)
        return
    end
    
    print("AUTOFARM: âœˆï¸ Ð›ÐµÑ‚Ð¸Ð¼ Ðº Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ñƒ", nextItem.Name, "Ð½Ð° Ñ€Ð°ÑÑÑ‚Ð¾ÑÐ½Ð¸Ð¸", math.floor(nextItem.Distance), "Ð¼")
    
    -- Ð›ÐµÑ‚Ð¸Ð¼ Ðº Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ñƒ (Ñ Ð¾Ñ‚ÑÑ‚ÑƒÐ¿Ð¾Ð¼ 2 ÐµÐ´Ð¸Ð½Ð¸Ñ†Ñ‹ Ð²Ð²ÐµÑ€Ñ…)
    local targetPosition = Vector3.new(nextItem.Position.X, nextItem.Position.Y + 2, nextItem.Position.Z)
    pcall(function()
        moveToPosition(targetPosition, function()
        if isAutofarmEnabled then
            -- ÐŸÐžÐ’Ð¢ÐžÐ ÐÐÐ¯ ÐŸÐ ÐžÐ’Ð•Ð ÐšÐ: Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚ ÐµÑ‰Ðµ ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÐµÑ‚ Ð¿Ð¾ÑÐ»Ðµ Ð¿Ð¾Ð»ÐµÑ‚Ð°
            local itemExistsAfterFlight = false
            pcall(function()
                if nextItem.Model and nextItem.Model.Parent then
                    local worldPivot = nextItem.Model:GetPivot()
                    if worldPivot and worldPivot.Position and worldPivot.Position.Magnitude > 0 then
                        local hasPhysicalParts = false
                        for _, child in pairs(nextItem.Model:GetChildren()) do
                            if child:IsA("BasePart") and child.Size.Magnitude > 0 then
                                hasPhysicalParts = true
                                break
                            end
                        end
                        itemExistsAfterFlight = hasPhysicalParts
                    end
                end
            end)
            
            if itemExistsAfterFlight then
                pickupItem(nextItem)
            else
                print("AUTOFARM: ÐŸÑ€ÐµÐ´Ð¼ÐµÑ‚", nextItem.Name, "Ð¸ÑÑ‡ÐµÐ· ÐŸÐžÐ¡Ð›Ð• Ð¿Ð¾Ð»ÐµÑ‚Ð° (Ð½ÐµÑ‚ Ñ„Ð¸Ð·Ð¸Ñ‡ÐµÑÐºÐ¸Ñ… Ñ‡Ð°ÑÑ‚ÐµÐ¹) - Ð¸Ñ‰ÐµÐ¼ ÑÐ»ÐµÐ´ÑƒÑŽÑ‰Ð¸Ð¹")
                task.spawn(function()
                    task.wait(0.5)
                    if isAutofarmEnabled then
                        processNextItem()
                    end
                end)
            end
        end
        end)
    end)
end

-- Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ Ð¿Ñ€Ð¸Ð½ÑƒÐ´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ð¹ Ð¿Ñ€Ð¾Ð³Ñ€ÑƒÐ·ÐºÐ¸ Ð²ÑÐµÐ¹ ÐºÐ°Ñ€Ñ‚Ñ‹
local function forceLoadEntireMap()
    print("ðŸ¤– AUTOFARM: ÐÐ°Ñ‡Ð¸Ð½Ð°ÐµÐ¼ Ð¿Ñ€Ð¸Ð½ÑƒÐ´Ð¸Ñ‚ÐµÐ»ÑŒÐ½ÑƒÑŽ Ð¿Ñ€Ð¾Ð³Ñ€ÑƒÐ·ÐºÑƒ ÐºÐ°Ñ€Ñ‚Ñ‹...")
    
    local player = Players.LocalPlayer
    local character = player.Character
    if not character then return end
    
    local humanoidRootPart = character:FindFirstChild("HumanoidRootPart")
    if not humanoidRootPart then return end
    
    local originalPosition = humanoidRootPart.Position
    local camera = workspace.CurrentCamera
    local originalCameraCFrame = camera.CFrame
    
    -- Ð’ÐºÐ»ÑŽÑ‡Ð°ÐµÐ¼ NoClip Ð´Ð»Ñ ÑÐ²Ð¾Ð±Ð¾Ð´Ð½Ð¾Ð³Ð¾ Ð´Ð²Ð¸Ð¶ÐµÐ½Ð¸Ñ
    if not isNoClipping then
        pcall(function()
            startNoClip()
        end)
        task.wait(0.1)
    end
    
    -- ÐœÐ¸Ð½Ð¸Ð¼Ð°Ð»ÑŒÐ½Ñ‹Ðµ Ñ‚Ð¾Ñ‡ÐºÐ¸ Ð´Ð»Ñ Ð¿Ñ€Ð¾Ð³Ñ€ÑƒÐ·ÐºÐ¸ ÐºÐ°Ñ€Ñ‚Ñ‹ (15 Ñ‚Ð¾Ñ‡ÐµÐº Ð²Ð¾ÐºÑ€ÑƒÐ³ Ñ†ÐµÐ½Ñ‚Ñ€Ð°)
    local loadPoints = {
        -- Ð¦ÐµÐ½Ñ‚Ñ€ ÐºÐ°Ñ€Ñ‚Ñ‹
        Vector3.new(0, 70, 0),
        
        -- 4 Ð¾ÑÐ½Ð¾Ð²Ð½Ñ‹Ñ… Ð½Ð°Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ (ÑÑ€ÐµÐ´Ð½Ð¸Ð¹ Ñ€Ð°Ð´Ð¸ÑƒÑ)
        Vector3.new(500, 70, 0),     -- Ð’Ð¾ÑÑ‚Ð¾Ðº
        Vector3.new(-500, 70, 0),    -- Ð—Ð°Ð¿Ð°Ð´
        Vector3.new(0, 70, 500),     -- Ð¡ÐµÐ²ÐµÑ€
        Vector3.new(0, 70, -500),    -- Ð®Ð³
        
        -- 4 Ð´Ð¸Ð°Ð³Ð¾Ð½Ð°Ð»ÑŒÐ½Ñ‹Ñ… Ð½Ð°Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ (ÑÑ€ÐµÐ´Ð½Ð¸Ð¹ Ñ€Ð°Ð´Ð¸ÑƒÑ)
        Vector3.new(400, 70, 400),   -- Ð¡Ð’
        Vector3.new(-400, 70, 400),  -- Ð¡Ð—
        Vector3.new(400, 70, -400),  -- Ð®Ð’
        Vector3.new(-400, 70, -400), -- Ð®Ð—
        
        -- Ð‘Ð»Ð¸Ð¶Ð½Ð¸Ð¹ ÐºÑ€ÑƒÐ³ (4 Ñ‚Ð¾Ñ‡ÐºÐ¸)
        Vector3.new(250, 70, 0),     Vector3.new(-250, 70, 0),
        Vector3.new(0, 70, 250),     Vector3.new(0, 70, -250),
        
        -- Ð’Ñ‹ÑÐ¾Ñ‚Ð½Ñ‹Ðµ Ñ‚Ð¾Ñ‡ÐºÐ¸ Ð´Ð»Ñ Ð²ÐµÑ€Ñ‚Ð¸ÐºÐ°Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ð¿Ð¾ÐºÑ€Ñ‹Ñ‚Ð¸Ñ
        Vector3.new(0, 120, 0),      -- Ð¦ÐµÐ½Ñ‚Ñ€ Ð²Ñ‹ÑˆÐµ
        Vector3.new(0, -50, 0),      -- Ð¦ÐµÐ½Ñ‚Ñ€ Ð½Ð¸Ð¶Ðµ
    }
    
    print("ðŸ¤– AUTOFARM: Ð›ÐµÑ‚Ð¸Ð¼ Ð¿Ð¾", #loadPoints, "Ñ‚Ð¾Ñ‡ÐºÐ°Ð¼ Ð´Ð»Ñ Ð¿Ñ€Ð¾Ð³Ñ€ÑƒÐ·ÐºÐ¸ ÐºÐ°Ñ€Ñ‚Ñ‹...")
    
    -- Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ BodyVelocity Ð´Ð»Ñ Ð¿Ð¾Ð»ÐµÑ‚Ð° (ÐºÐ°Ðº Ð² Ð°Ð²Ñ‚Ð¾Ñ„Ð°Ñ€Ð¼Ðµ)
    local bodyVelocity = Instance.new("BodyVelocity", humanoidRootPart)
    bodyVelocity.MaxForce = Vector3.new(9e9, 9e9, 9e9)
    bodyVelocity.Velocity = Vector3.new(0, 0, 0)
    
    for i, point in ipairs(loadPoints) do
        if not isAutofarmEnabled then break end -- ÐŸÑ€ÐµÑ€Ñ‹Ð²Ð°ÐµÐ¼ ÐµÑÐ»Ð¸ Ð°Ð²Ñ‚Ð¾Ñ„Ð°Ñ€Ð¼ Ð¾Ñ‚ÐºÐ»ÑŽÑ‡Ð¸Ð»Ð¸
        
        -- Ð›ÐµÑ‚Ð¸Ð¼ Ðº Ñ‚Ð¾Ñ‡ÐºÐµ Ð¿Ñ€Ð¾Ð³Ñ€ÑƒÐ·ÐºÐ¸ (Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼ Ð¿Ð¾Ð»ÐµÑ‚ ÐºÐ°Ðº Ð² Ð°Ð²Ñ‚Ð¾Ñ„Ð°Ñ€Ð¼Ðµ)
        print("ðŸ¤– AUTOFARM: Ð›ÐµÑ‚Ð¸Ð¼ Ðº Ñ‚Ð¾Ñ‡ÐºÐµ Ð¿Ñ€Ð¾Ð³Ñ€ÑƒÐ·ÐºÐ¸", i, "/", #loadPoints, "- Ð¿Ð¾Ð·Ð¸Ñ†Ð¸Ñ:", point)
        
        local startTime = tick()
        local maxFlightTime = 10 -- ÐœÐ°ÐºÑÐ¸Ð¼ÑƒÐ¼ 10 ÑÐµÐºÑƒÐ½Ð´ Ð½Ð° Ð¾Ð´Ð½Ñƒ Ñ‚Ð¾Ñ‡ÐºÑƒ
        
        while isAutofarmEnabled and tick() - startTime < maxFlightTime do
            local currentPos = humanoidRootPart.Position
            local distance = (point - currentPos).Magnitude
            
            if distance > 5 then
                local direction = (point - currentPos).Unit
                -- Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼ Ñ‚Ñƒ Ð¶Ðµ ÑÐºÐ¾Ñ€Ð¾ÑÑ‚ÑŒ Ñ‡Ñ‚Ð¾ Ð¸ Ð² Ð°Ð²Ñ‚Ð¾Ñ„Ð°Ñ€Ð¼Ðµ
                local moveVector = direction * (AutofarmConfig.FlightSpeed * 10)
                bodyVelocity.Velocity = moveVector
            else
                -- Ð”Ð¾ÑÑ‚Ð¸Ð³Ð»Ð¸ Ñ‚Ð¾Ñ‡ÐºÐ¸ Ð¿Ñ€Ð¾Ð³Ñ€ÑƒÐ·ÐºÐ¸
                bodyVelocity.Velocity = Vector3.new(0, 0, 0)
                break
            end
            
            task.wait(0.03) -- ÐŸÐ»Ð°Ð²Ð½Ð¾Ðµ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ Ð¿Ð¾Ð»ÐµÑ‚Ð°
        end
        
        -- ÐŸÐ¾Ð²Ð¾Ñ€Ð°Ñ‡Ð¸Ð²Ð°ÐµÐ¼ ÐºÐ°Ð¼ÐµÑ€Ñƒ Ð´Ð»Ñ Ð»ÑƒÑ‡ÑˆÐµÐ¹ Ð¿Ñ€Ð¾Ð³Ñ€ÑƒÐ·ÐºÐ¸
        camera.CFrame = CFrame.new(point + Vector3.new(0, 50, 0), point)
        
        -- ÐœÐÐšÐ¡Ð˜ÐœÐÐ›Ð¬ÐÐž Ð‘Ð«Ð¡Ð¢Ð ÐÐ¯ Ð¿Ñ€Ð¾Ð³Ñ€ÑƒÐ·ÐºÐ° Ð½Ð¾ Ñ Ð³Ð°Ñ€Ð°Ð½Ñ‚Ð¸ÐµÐ¹
        task.wait(0.1)
        
        -- ÐŸÐ¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÐ¼ Ð¿Ñ€Ð¾Ð³Ñ€ÐµÑÑ ÐºÐ°Ð¶Ð´Ð¾Ð¹ Ñ‚Ð¾Ñ‡ÐºÐ¸
        print("ðŸ¤– AUTOFARM: ÐŸÑ€Ð¾Ð³Ñ€ÑƒÐ·ÐºÐ° Ñ‚Ð¾Ñ‡ÐºÐ¸", i, "/", #loadPoints, "- Ð¿Ð¾Ð·Ð¸Ñ†Ð¸Ñ:", point, "Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð°")
    end
    
    -- ÐžÑ‡Ð¸Ñ‰Ð°ÐµÐ¼ BodyVelocity Ð¿Ð¾ÑÐ»Ðµ Ð¿Ñ€Ð¾Ð³Ñ€ÑƒÐ·ÐºÐ¸
    if bodyVelocity and bodyVelocity.Parent then
        bodyVelocity:Destroy()
    end
    
    -- Ð’Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÐ¼ÑÑ Ð² Ð¸ÑÑ…Ð¾Ð´Ð½ÑƒÑŽ Ð¿Ð¾Ð·Ð¸Ñ†Ð¸ÑŽ Ñ‡ÐµÑ€ÐµÐ· Ð¿Ð¾Ð»ÐµÑ‚
    print("ðŸ¤– AUTOFARM: Ð’Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÐ¼ÑÑ Ð² Ð¸ÑÑ…Ð¾Ð´Ð½ÑƒÑŽ Ð¿Ð¾Ð·Ð¸Ñ†Ð¸ÑŽ Ñ‡ÐµÑ€ÐµÐ· Ð¿Ð¾Ð»ÐµÑ‚")
    
    local returnBodyVelocity = Instance.new("BodyVelocity", humanoidRootPart)
    returnBodyVelocity.MaxForce = Vector3.new(9e9, 9e9, 9e9)
    returnBodyVelocity.Velocity = Vector3.new(0, 0, 0)
    
    local returnStartTime = tick()
    local maxReturnTime = 15 -- ÐœÐ°ÐºÑÐ¸Ð¼ÑƒÐ¼ 15 ÑÐµÐºÑƒÐ½Ð´ Ð½Ð° Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‚
    
    while isAutofarmEnabled and tick() - returnStartTime < maxReturnTime do
        local currentPos = humanoidRootPart.Position
        local distance = (originalPosition - currentPos).Magnitude
        
        if distance > 5 then
            local direction = (originalPosition - currentPos).Unit
            local moveVector = direction * (AutofarmConfig.FlightSpeed * 10)
            returnBodyVelocity.Velocity = moveVector
        else
            -- Ð”Ð¾ÑÑ‚Ð¸Ð³Ð»Ð¸ Ð¸ÑÑ…Ð¾Ð´Ð½Ð¾Ð¹ Ð¿Ð¾Ð·Ð¸Ñ†Ð¸Ð¸
            returnBodyVelocity.Velocity = Vector3.new(0, 0, 0)
            break
        end
        
        task.wait(0.03)
    end
    
    -- ÐžÑ‡Ð¸Ñ‰Ð°ÐµÐ¼ BodyVelocity Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‚Ð°
    if returnBodyVelocity and returnBodyVelocity.Parent then
        returnBodyVelocity:Destroy()
    end
    
    camera.CFrame = originalCameraCFrame
    
    -- Ð‘Ñ‹ÑÑ‚Ñ€Ð°Ñ Ñ„Ð¸Ð½Ð°Ð»ÑŒÐ½Ð°Ñ ÑÑ‚Ð°Ð±Ð¸Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ
    task.wait(1)
    
    print("ðŸ¤– AUTOFARM: ÐŸÑ€Ð¾Ð³Ñ€ÑƒÐ·ÐºÐ° ÐºÐ°Ñ€Ñ‚Ñ‹ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð°! Ð—Ð°Ð³Ñ€ÑƒÐ¶ÐµÐ½Ð¾", #loadPoints, "Ñ‚Ð¾Ñ‡ÐµÐº. ÐÐ°Ñ‡Ð¸Ð½Ð°ÐµÐ¼ Ð¿Ð¾Ð¸ÑÐº Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ð¾Ð²...")
end

function startAutofarm()
    if isAutofarmEnabled then
        print("AUTOFARM: Ð£Ð¶Ðµ Ð°ÐºÑ‚Ð¸Ð²ÐµÐ½!")
        return
    end
    
    -- ÐžÑ‚Ð¼ÐµÐ½ÑÐµÐ¼ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹ Ð¿ÐµÑ€ÐµÐ·Ð°Ð¿ÑƒÑÐº ÐµÑÐ»Ð¸ Ð¾Ð½ Ð±Ñ‹Ð» Ð·Ð°Ð¿Ð»Ð°Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½
    if autofarmAutoRestarting then
        autofarmAutoRestarting = false
        if autofarmRestartTimer then
            task.cancel(autofarmRestartTimer)
            autofarmRestartTimer = nil
        end
        print("ðŸ¤– AUTOFARM: ÐžÑ‚Ð¼ÐµÐ½ÐµÐ½ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹ Ð¿ÐµÑ€ÐµÐ·Ð°Ð¿ÑƒÑÐº - Ð·Ð°Ð¿ÑƒÑÐº Ð²Ñ€ÑƒÑ‡Ð½ÑƒÑŽ")
    end
    
    local player = Players.LocalPlayer
    local character = player.Character
    if not character then
        print("AUTOFARM: ÐŸÐµÑ€ÑÐ¾Ð½Ð°Ð¶ Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½!")
        return
    end
    
    local humanoidRootPart = character:FindFirstChild("HumanoidRootPart")
    if not humanoidRootPart then
        print("AUTOFARM: HumanoidRootPart Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½!")
        return
    end
    
    print("ðŸ¤– AUTOFARM: Ð—ÐÐŸÐ£Ð©Ð•Ð!")
    isAutofarmEnabled = true
    AutofarmConfig.Enabled = true
    
    -- ÐžÑ‡Ð¸Ñ‰Ð°ÐµÐ¼ Ð¿Ñ€ÐµÐ´Ñ‹Ð´ÑƒÑ‰Ð¸Ðµ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð¾ Ð¿Ð¾Ð¿Ñ‹Ñ‚ÐºÐ°Ñ… Ð¸ Ð¿Ñ€Ð¾Ð¿ÑƒÑ‰ÐµÐ½Ð½Ñ‹Ñ… Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ð°Ñ…
    autofarmItemAttempts = {}
    autofarmSkippedItems = {}
    autofarmSkippedReturns = {}
    
    -- ÐÐµ ÑÐ¾Ñ…Ñ€Ð°Ð½ÑÐµÐ¼ Ð¸ÑÑ…Ð¾Ð´Ð½ÑƒÑŽ Ð¿Ð¾Ð·Ð¸Ñ†Ð¸ÑŽ - Ð¾ÑÑ‚Ð°ÐµÐ¼ÑÑ Ð³Ð´Ðµ Ð¾ÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ð»Ð¸ÑÑŒ (ÐºÐ°Ðº Ñ‚ÐµÐ»ÐµÐ¿Ð¾Ñ€Ñ‚)
    
    -- ÐÐžÐ’ÐžÐ•: ÐŸÑ€Ð¸Ð½ÑƒÐ´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð°Ñ Ð¿Ñ€Ð¾Ð³Ñ€ÑƒÐ·ÐºÐ° ÐºÐ°Ñ€Ñ‚Ñ‹ Ð¿ÐµÑ€ÐµÐ´ Ð½Ð°Ñ‡Ð°Ð»Ð¾Ð¼ Ñ„Ð°Ñ€Ð¼Ð°
    task.spawn(function()
        pcall(function()
            forceLoadEntireMap()
        end)
        
        -- Ð’ÐÐ–ÐÐž: Ð˜Ð½Ð¸Ñ†Ð¸Ð°Ð»Ð¸Ð·Ð¸Ñ€ÑƒÐµÐ¼ Ð²Ñ€ÐµÐ¼Ñ Ð¿Ð¾ÑÐ»ÐµÐ´Ð½ÐµÐ³Ð¾ Ð¿Ð¾Ð´Ð±Ð¾Ñ€Ð° ÐŸÐžÐ¡Ð›Ð• Ð¿Ñ€Ð¾Ð³Ñ€ÑƒÐ·ÐºÐ¸ ÐºÐ°Ñ€Ñ‚Ñ‹
        autofarmLastPickupTime = tick()
        print("ðŸ¤– AUTOFARM: Ð¢Ð°Ð¹Ð¼ÐµÑ€ Ð½ÐµÐ°ÐºÑ‚Ð¸Ð²Ð½Ð¾ÑÑ‚Ð¸ Ð·Ð°Ð¿ÑƒÑ‰ÐµÐ½ Ð¿Ð¾ÑÐ»Ðµ Ð¿Ñ€Ð¾Ð³Ñ€ÑƒÐ·ÐºÐ¸ ÐºÐ°Ñ€Ñ‚Ñ‹")
        
        -- ÐŸÐ¾ÑÐ»Ðµ Ð¿Ñ€Ð¾Ð³Ñ€ÑƒÐ·ÐºÐ¸ Ð½Ð°Ñ‡Ð¸Ð½Ð°ÐµÐ¼ Ð¾ÑÐ½Ð¾Ð²Ð½Ð¾Ð¹ Ð¿Ñ€Ð¾Ñ†ÐµÑÑ
        if isAutofarmEnabled then
            pcall(function()
                processNextItem()
            end)
        end
    end)
end

function stopAutofarm()
    if not isAutofarmEnabled then
        return
    end
    
    print("ðŸ¤– AUTOFARM: ÐžÐ¡Ð¢ÐÐÐžÐ’Ð›Ð•Ð!")
    isAutofarmEnabled = false
    AutofarmConfig.Enabled = false
    autofarmPickingUp = false
    autofarmCurrentTarget = nil
    
    -- ÐžÑ‚Ð¼ÐµÐ½ÑÐµÐ¼ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹ Ð¿ÐµÑ€ÐµÐ·Ð°Ð¿ÑƒÑÐº ÐµÑÐ»Ð¸ Ð¾Ð½ Ð±Ñ‹Ð» Ð·Ð°Ð¿Ð»Ð°Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½
    if autofarmAutoRestarting then
        autofarmAutoRestarting = false
        if autofarmRestartTimer then
            task.cancel(autofarmRestartTimer)
            autofarmRestartTimer = nil
        end
        print("ðŸ¤– AUTOFARM: ÐžÑ‚Ð¼ÐµÐ½ÐµÐ½ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹ Ð¿ÐµÑ€ÐµÐ·Ð°Ð¿ÑƒÑÐº - Ð¾ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° Ð²Ñ€ÑƒÑ‡Ð½ÑƒÑŽ")
    end
    
    -- ÐŸÐ Ð˜ÐÐ£Ð”Ð˜Ð¢Ð•Ð›Ð¬ÐÐž Ð¾Ñ‚Ð¿ÑƒÑÐºÐ°ÐµÐ¼ ÐºÐ»Ð°Ð²Ð¸ÑˆÑƒ E (Ñ„Ð¸ÐºÑ Ð±Ð°Ð³Ð° Ñ Ð·Ð°Ð¶Ð°Ñ‚Ð¾Ð¹ ÐºÐ½Ð¾Ð¿ÐºÐ¾Ð¹)
    pcall(function()
        if game:GetService("VirtualInputManager") then
            game:GetService("VirtualInputManager"):SendKeyEvent(false, AutofarmConfig.PickupKey, false, game)
        end
        game:GetService("UserInputService").InputEnded:Fire(
            {KeyCode = AutofarmConfig.PickupKey, UserInputType = Enum.UserInputType.Keyboard},
            false
        )
        print("ðŸ¤– AUTOFARM: ÐšÐ»Ð°Ð²Ð¸ÑˆÐ° E Ð¿Ñ€Ð¸Ð½ÑƒÐ´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ Ð¾Ñ‚Ð¿ÑƒÑ‰ÐµÐ½Ð°")
    end)
    
    -- ÐžÑ‚ÐºÐ»ÑŽÑ‡Ð°ÐµÐ¼ Ð²ÑÐµ ÑÐ¾ÐµÐ´Ð¸Ð½ÐµÐ½Ð¸Ñ
    for _, connection in ipairs(autofarmConnections) do
        if connection then
            pcall(function() connection:Disconnect() end)
        end
    end
    autofarmConnections = {}
    
    local player = Players.LocalPlayer
    local character = player.Character
    if character then
        local humanoidRootPart = character:FindFirstChild("HumanoidRootPart")
        if humanoidRootPart then
            -- Ð£Ð±Ð¸Ñ€Ð°ÐµÐ¼ BodyVelocity
            local bv = humanoidRootPart:FindFirstChild("AutofarmBodyVelocity")
            if bv then
                bv:Destroy()
            end
            
            -- Ð’Ð¾ÑÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÐ¼ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð¶Ð° Ð¢ÐžÐ›Ð¬ÐšÐž ÐµÑÐ»Ð¸ Ñ„Ð»Ð°Ð¹ ÐÐ• Ð²ÐºÐ»ÑŽÑ‡ÐµÐ½
            if not isFlying then
                local humanoid = character:FindFirstChild("Humanoid")
                if humanoid then
                    humanoid.JumpPower = 50 -- Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÐ¼ Ð¾Ð±Ñ‹Ñ‡Ð½ÑƒÑŽ ÑÐ¸Ð»Ñƒ Ð¿Ñ€Ñ‹Ð¶ÐºÐ°
                    humanoid.JumpHeight = 7.2 -- Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÐ¼ Ð¾Ð±Ñ‹Ñ‡Ð½ÑƒÑŽ Ð²Ñ‹ÑÐ¾Ñ‚Ñƒ Ð¿Ñ€Ñ‹Ð¶ÐºÐ°  
                    humanoid.HipHeight = 2 -- Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÐ¼ ÐŸÐ ÐÐ’Ð˜Ð›Ð¬ÐÐ£Ð® Ð²Ñ‹ÑÐ¾Ñ‚Ñƒ Ð±ÐµÐ´ÐµÑ€ (ÐºÐ°Ðº Ð² stopFly)
                end
                
                -- Ð’Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÐ¼ Ð³Ñ€Ð°Ð²Ð¸Ñ‚Ð°Ñ†Ð¸ÑŽ Ð¢ÐžÐ›Ð¬ÐšÐž ÐµÑÐ»Ð¸ Ñ„Ð»Ð°Ð¹ Ð¸ NoClip ÐÐ• Ð²ÐºÐ»ÑŽÑ‡ÐµÐ½Ñ‹
                if AutofarmConfig.UseFlightMovement and not isNoClipping and not isFlying then
                    workspace.Gravity = 196.2
                end
            else
                print("AUTOFARM: Ð¤Ð»Ð°Ð¹ Ð²ÐºÐ»ÑŽÑ‡ÐµÐ½ - ÐÐ• Ð²Ð¾ÑÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÐ¼ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð¶Ð°")
            end
            
            -- Ð”ÐžÐŸÐžÐ›ÐÐ˜Ð¢Ð•Ð›Ð¬ÐÐÐ¯ ÐžÐ§Ð˜Ð¡Ð¢ÐšÐ: ÑƒÐ±Ð¸Ñ€Ð°ÐµÐ¼ Ð²ÑÐµ BodyVelocity Ð¾Ð±ÑŠÐµÐºÑ‚Ñ‹ Ñ Ð¿ÐµÑ€ÑÐ¾Ð½Ð°Ð¶Ð°
            for _, part in pairs(character:GetChildren()) do
                if part:IsA("BasePart") then
                    for _, child in pairs(part:GetChildren()) do
                        if child:IsA("BodyVelocity") or child:IsA("BodyPosition") or child:IsA("BodyGyro") then
                            print("AUTOFARM: Ð£Ð´Ð°Ð»ÑÐµÐ¼", child.ClassName, "Ð¸Ð·", part.Name)
                            child:Destroy()
                        end
                    end
                end
            end
            
            -- ÐÐ• Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÐ¼ÑÑ Ðº Ð¸ÑÑ…Ð¾Ð´Ð½Ð¾Ð¹ Ð¿Ð¾Ð·Ð¸Ñ†Ð¸Ð¸ - Ð¾ÑÑ‚Ð°ÐµÐ¼ÑÑ Ð³Ð´Ðµ Ð¾ÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ð»Ð¸ÑÑŒ (ÐºÐ°Ðº Ð² Ñ‚ÐµÐ»ÐµÐ¿Ð¾Ñ€Ñ‚Ðµ)
        end
        
        -- ÐžÑ‚ÐºÐ»ÑŽÑ‡Ð°ÐµÐ¼ NoClip ÐµÑÐ»Ð¸ Ð²ÐºÐ»ÑŽÑ‡Ð°Ð»Ð¸
        if AutofarmConfig.UseNoClipMovement and isNoClipping then
            stopNoClip()
        end
    end
    
    print("AUTOFARM: ÐŸÐ¾Ð»Ð½Ð¾ÑÑ‚ÑŒÑŽ Ð¾ÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½")
end

local screenGui = Instance.new("ScreenGui", CoreGui)
screenGui.Name = "SslkinGui"
screenGui.ResetOnSpawn = false

local mainFrame = Instance.new("Frame", screenGui)
mainFrame.Name = "MainFrame"
mainFrame.Position = UDim2.new(0, 20, 0.5, -250)
mainFrame.Size = UDim2.new(0, 400, 0, 500)
mainFrame.BackgroundTransparency = 1
mainFrame.BorderSizePixel = 0
mainFrame.Active = true
mainFrame.Draggable = true

local minWidth = 200
local minHeight = 150

local mainCorner = Instance.new("UICorner", mainFrame)
mainCorner.CornerRadius = UDim.new(0, 8)

local leftPanel = Instance.new("Frame", mainFrame)
leftPanel.Name = "LeftPanel"
leftPanel.Size = UDim2.new(0, 120, 1, 0)
leftPanel.Position = UDim2.new(0, 0, 0, 0)
leftPanel.BackgroundColor3 = Color3.fromRGB(25, 25, 30)
leftPanel.BackgroundTransparency = 0
leftPanel.BorderSizePixel = 0

local leftCorner = Instance.new("UICorner", leftPanel)
leftCorner.CornerRadius = UDim.new(0, 8)

local logoFrame = Instance.new("Frame", leftPanel)
logoFrame.Name = "LogoFrame"
logoFrame.Size = UDim2.new(1, 0, 0, 80)
logoFrame.Position = UDim2.new(0, 0, 0, 0)
logoFrame.BackgroundTransparency = 1

local logoText = Instance.new("TextLabel", logoFrame)
logoText.Name = "LogoText"
logoText.Size = UDim2.new(1, 0, 0, 40)
logoText.Position = UDim2.new(0, 0, 0, 10)
logoText.Text = "SSLKIN"
logoText.Font = Enum.Font.GothamBold
logoText.TextSize = 18
logoText.TextColor3 = Color3.new(1, 1, 1)
logoText.BackgroundTransparency = 1
logoText.TextXAlignment = Enum.TextXAlignment.Center

local versionText = Instance.new("TextLabel", logoFrame)
versionText.Name = "VersionText"
versionText.Size = UDim2.new(1, 0, 0, 20)
versionText.Position = UDim2.new(0, 0, 0, 50)
versionText.Text = "UNIVERSAL SCRIPT"
versionText.Font = Enum.Font.Gotham
versionText.TextSize = 10
versionText.TextColor3 = Color3.new(1, 1, 1)
versionText.BackgroundTransparency = 1
versionText.TextXAlignment = Enum.TextXAlignment.Center

local navButtons = {
    {name = "Main", icon = "ðŸ "},
    {name = "YBA Hacks", icon = "âš”ï¸"},
    {name = "Settings", icon = "âš™ï¸"}
}

local selectedTab = "Main"

-- Scroll position for each tab
local tabScrollPositions = {
    ["Main"] = 0,
    ["YBA Hacks"] = 0,
    ["Settings"] = 0
}

for i, buttonData in ipairs(navButtons) do
    local navButton = Instance.new("TextButton", leftPanel)
    navButton.Name = buttonData.name .. "Button"
    navButton.Size = UDim2.new(1, -20, 0, 40)
    navButton.Position = UDim2.new(0, 10, 0, 100 + (i-1) * 50)
    navButton.Text = buttonData.icon .. " " .. buttonData.name
    navButton.Font = Enum.Font.Gotham
    navButton.TextSize = 14
    navButton.TextColor3 = Color3.new(1, 1, 1)
    navButton.BackgroundColor3 = buttonData.name == selectedTab and Color3.fromRGB(40, 40, 45) or Color3.fromRGB(30, 30, 35)
    navButton.BorderSizePixel = 0
    navButton.AutoButtonColor = false
    
    local buttonCorner = Instance.new("UICorner", navButton)
    buttonCorner.CornerRadius = UDim.new(0, 6)
    
    -- ÐŸÐ¾Ð´ÑÐ²ÐµÑ‚ÐºÐ° Ð²Ñ‹Ð±Ñ€Ð°Ð½Ð½Ð¾Ð¹ Ð²ÐºÐ»Ð°Ð´ÐºÐ¸
    if buttonData.name == selectedTab then
        local highlight = Instance.new("Frame", navButton)
        highlight.Name = "Highlight"
        highlight.Size = UDim2.new(0, 3, 1, 0)
        highlight.Position = UDim2.new(0, 0, 0, 0)
        highlight.BackgroundColor3 = MenuSettings.AccentColor
        highlight.BorderSizePixel = 0
        
        local highlightCorner = Instance.new("UICorner", highlight)
        highlightCorner.CornerRadius = UDim.new(0, 2)
    end
    
    navButton.MouseButton1Click:Connect(function()
        -- ÐžÐ±Ð½Ð¾Ð²Ð»ÑÐµÐ¼ Ð²Ñ‹Ð±Ñ€Ð°Ð½Ð½ÑƒÑŽ Ð²ÐºÐ»Ð°Ð´ÐºÑƒ
        for _, btn in pairs(leftPanel:GetChildren()) do
            if btn:IsA("TextButton") then
                btn.BackgroundColor3 = Color3.fromRGB(30, 30, 35)
                local highlight = btn:FindFirstChild("Highlight")
                if highlight then
                    highlight:Destroy()
                end
            end
        end
        
        navButton.BackgroundColor3 = Color3.fromRGB(40, 40, 45)
        selectedTab = buttonData.name
        
        local highlight = Instance.new("Frame", navButton)
        highlight.Name = "Highlight"
        highlight.Size = UDim2.new(0, 3, 1, 0)
        highlight.Position = UDim2.new(0, 0, 0, 0)
        highlight.BackgroundColor3 = MenuSettings.AccentColor
        highlight.BorderSizePixel = 0
        
        local highlightCorner = Instance.new("UICorner", highlight)
        highlightCorner.CornerRadius = UDim.new(0, 2)
        
        showContent(buttonData.name)
    end)
end

local rightPanel = Instance.new("Frame", mainFrame)
rightPanel.Name = "RightPanel"
rightPanel.Size = UDim2.new(1, -120, 1, 0)
rightPanel.Position = UDim2.new(0, 120, 0, 0)
rightPanel.BackgroundColor3 = Color3.fromRGB(40, 40, 45)
rightPanel.BackgroundTransparency = 0.15
rightPanel.BorderSizePixel = 0

local glassEffect = Instance.new("Frame", rightPanel)
glassEffect.Name = "GlassEffect"
glassEffect.Size = UDim2.new(1, 0, 1, 0)
glassEffect.Position = UDim2.new(0, 0, 0, 0)
glassEffect.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
glassEffect.BackgroundTransparency = 0.92
glassEffect.BorderSizePixel = 0
glassEffect.ZIndex = -1

local glassGradient = Instance.new("UIGradient", glassEffect)
glassGradient.Color = ColorSequence.new{
    ColorSequenceKeypoint.new(0, Color3.fromRGB(200, 200, 220)),
    ColorSequenceKeypoint.new(0.5, Color3.fromRGB(150, 150, 170)),
    ColorSequenceKeypoint.new(1, Color3.fromRGB(100, 100, 120))
}
glassGradient.Rotation = 45

local glassBorder = Instance.new("UIStroke", rightPanel)
glassBorder.Color = Color3.fromRGB(200, 200, 220)
glassBorder.Transparency = 0.7
glassBorder.Thickness = 1

local rightCorner = Instance.new("UICorner", rightPanel)
rightCorner.CornerRadius = UDim.new(0, 8)

local glassCorner = Instance.new("UICorner", glassEffect)
glassCorner.CornerRadius = UDim.new(0, 8)

local closeButton = Instance.new("TextButton", rightPanel)
closeButton.Name = "CloseButton"
closeButton.Size = UDim2.new(0, 30, 0, 30)
closeButton.Position = UDim2.new(1, -35, 0, 5)
closeButton.Text = "X"
closeButton.Font = Enum.Font.GothamBold
closeButton.TextSize = 16
closeButton.TextColor3 = Color3.new(1, 1, 1)
closeButton.BackgroundColor3 = Color3.fromRGB(255, 100, 100)
closeButton.BorderSizePixel = 0
closeButton.AutoButtonColor = false

local closeCorner = Instance.new("UICorner", closeButton)
closeCorner.CornerRadius = UDim.new(0, 6)

closeButton.MouseButton1Click:Connect(function()
    mainFrame.Visible = false
    createReopenButton()
end)

local resizeHandle = Instance.new("Frame", mainFrame)
resizeHandle.Name = "ResizeHandle"
resizeHandle.Size = UDim2.new(0, 15, 0, 15)
resizeHandle.Position = UDim2.new(1, -15, 1, -15)
resizeHandle.BackgroundColor3 = Color3.fromRGB(120, 120, 120)
resizeHandle.BackgroundTransparency = 0.2
resizeHandle.BorderSizePixel = 0
resizeHandle.ZIndex = 15

local line1 = Instance.new("Frame", resizeHandle)
line1.Size = UDim2.new(0, 2, 0, 10)
line1.Position = UDim2.new(0, 8, 0, 2)
line1.BackgroundColor3 = Color3.new(0.8, 0.8, 0.8)
line1.BorderSizePixel = 0
line1.Rotation = 45

local line2 = Instance.new("Frame", resizeHandle)
line2.Size = UDim2.new(0, 2, 0, 6)
line2.Position = UDim2.new(0, 5, 0, 6)
line2.BackgroundColor3 = Color3.new(0.8, 0.8, 0.8)
line2.BorderSizePixel = 0
line2.Rotation = 45

local line3 = Instance.new("Frame", resizeHandle)
line3.Size = UDim2.new(0, 2, 0, 2)
line3.Position = UDim2.new(0, 2, 0, 10)
line3.BackgroundColor3 = Color3.new(0.8, 0.8, 0.8)
line3.BorderSizePixel = 0
line3.Rotation = 45

-- Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ñ Ñ€Ð°Ð·Ð¼ÐµÑ€Ð° (ÑÐ²Ð¾Ð±Ð¾Ð´Ð½Ð¾Ðµ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ðµ ÐºÐ°Ðº Ð² Windows)
local isResizing = false
local startMousePos = Vector2.new(0, 0)
local startFrameSize = UDim2.new(0, 400, 0, 500)

resizeHandle.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        isResizing = true
        startMousePos = UserInputService:GetMouseLocation()
        startFrameSize = mainFrame.Size
        
        -- ÐžÑ‚ÐºÐ»ÑŽÑ‡Ð°ÐµÐ¼ Ð¿ÐµÑ€ÐµÑ‚Ð°ÑÐºÐ¸Ð²Ð°Ð½Ð¸Ðµ Ð¾ÑÐ½Ð¾Ð²Ð½Ð¾Ð³Ð¾ Ñ„Ñ€ÐµÐ¹Ð¼Ð°
        mainFrame.Draggable = false
        
        -- ÐœÐµÐ½ÑÐµÐ¼ Ð²Ð¸Ð·ÑƒÐ°Ð» handle Ð¿Ñ€Ð¸ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ð¸
        resizeHandle.BackgroundTransparency = 0.1
    end
end)

UserInputService.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 and isResizing then
        isResizing = false
        mainFrame.Draggable = true
        resizeHandle.BackgroundTransparency = 0.2
    end
end)

RunService.RenderStepped:Connect(function()
    if isResizing then
        local currentMousePos = UserInputService:GetMouseLocation()
        local deltaX = currentMousePos.X - startMousePos.X
        local deltaY = currentMousePos.Y - startMousePos.Y
        
        -- Ð¡Ð²Ð¾Ð±Ð¾Ð´Ð½Ð¾Ðµ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ðµ Ñ€Ð°Ð·Ð¼ÐµÑ€Ð° (ÐºÐ°Ðº Ð² Windows)
        local newWidth = math.max(minWidth, startFrameSize.X.Offset + deltaX)
        local newHeight = math.max(minHeight, startFrameSize.Y.Offset + deltaY)
        
        mainFrame.Size = UDim2.new(0, newWidth, 0, newHeight)
    end
end)

function createReopenButton()
    local existingButton = screenGui:FindFirstChild("ReopenButton")
    if existingButton then
        existingButton:Destroy()
    end
    
    local reopenButton = Instance.new("TextButton", screenGui)
    reopenButton.Name = "ReopenButton"
    reopenButton.Size = UDim2.new(0, 50, 0, 50)
    reopenButton.Position = UDim2.new(1, -70, 0, 20)
    reopenButton.Text = "ðŸ”§"
    reopenButton.Font = Enum.Font.GothamBold
    reopenButton.TextSize = 20
    reopenButton.TextColor3 = Color3.new(1, 1, 1)
    reopenButton.BackgroundColor3 = MenuSettings.AccentColor
    reopenButton.BorderSizePixel = 0
    reopenButton.AutoButtonColor = false
    
    local reopenCorner = Instance.new("UICorner", reopenButton)
    reopenCorner.CornerRadius = UDim.new(0.5, 0)
    
    reopenButton.MouseButton1Click:Connect(function()
        mainFrame.Visible = true
        reopenButton:Destroy()
    end)
end

local contentTitle = Instance.new("TextLabel", rightPanel)
contentTitle.Name = "ContentTitle"
contentTitle.Size = UDim2.new(1, -20, 0, 40)
contentTitle.Position = UDim2.new(0, 10, 0, 10)
contentTitle.Text = "MAIN FUNCTIONS"
contentTitle.Font = Enum.Font.GothamBold
contentTitle.TextSize = 18
contentTitle.TextColor3 = Color3.new(1, 1, 1)
contentTitle.BackgroundTransparency = 1
contentTitle.TextXAlignment = Enum.TextXAlignment.Center

local scrollFrame = Instance.new("ScrollingFrame", rightPanel)
scrollFrame.Name = "ScrollFrame"
scrollFrame.Size = UDim2.new(1, -20, 1, -100)
scrollFrame.Position = UDim2.new(0, 10, 0, 60)
scrollFrame.BackgroundTransparency = 1
scrollFrame.ScrollBarThickness = 6
scrollFrame.CanvasSize = UDim2.new(0, 0, 0, 0)
scrollFrame.AutomaticCanvasSize = Enum.AutomaticSize.Y

local functionsContainer = Instance.new("Frame", scrollFrame)
functionsContainer.Name = "FunctionsContainer"
functionsContainer.Size = UDim2.new(1, 0, 0, 0)
functionsContainer.Position = UDim2.new(0, 0, 0, 0)
functionsContainer.BackgroundTransparency = 1
functionsContainer.AutomaticSize = Enum.AutomaticSize.Y

local currentY = 0
local padding = 8

local function createSectionHeader(text)
    currentY = currentY + padding
    local spacer = Instance.new("Frame", functionsContainer)
    spacer.Size = UDim2.new(1, 0, 0, 10)
    spacer.Position = UDim2.new(0, 0, 0, currentY)
    spacer.BackgroundTransparency = 1
    currentY = currentY + 10
    
    local lbl = Instance.new("TextLabel", functionsContainer)
    lbl.Text = text
    lbl.Size = UDim2.new(1, -10, 0, 30)
    lbl.Position = UDim2.new(0, 5, 0, currentY)
    lbl.Font = Enum.Font.GothamBold
    lbl.TextSize = 16
    lbl.TextColor3 = Color3.fromRGB(255,255,255)
    lbl.BackgroundTransparency = 1
    currentY = currentY + 30 + padding
    return lbl
end

local function createToggle(label, default, callback)
    local btn = Instance.new("TextButton", functionsContainer)
    btn.Size = UDim2.new(1, -10, 0, 28)
    btn.Position = UDim2.new(0, 5, 0, currentY)
    btn.Text = label .. ": " .. (default and "ON" or "OFF")
    btn.Font = Enum.Font.Gotham
    btn.TextSize = 14
    btn.TextColor3 = Color3.new(1,1,1)
    btn.BackgroundColor3 = Color3.fromRGB(40,40,40)
    btn.AutoButtonColor = false
    Instance.new("UICorner", btn).CornerRadius = UDim.new(0,6)

    btn.MouseButton1Click:Connect(function()
        default = not default
        btn.Text = label .. ": " .. (default and "ON" or "OFF")
        callback(default)
    end)
    
    currentY = currentY + 28 + padding
    return btn
end

local function createToggleSlider(label, default, callback)
    local container = Instance.new("Frame", functionsContainer)
    container.Size = UDim2.new(1, -10, 0, 40)
    container.Position = UDim2.new(0, 5, 0, currentY)
    container.BackgroundTransparency = 1

    local lbl = Instance.new("TextLabel", container)
    lbl.Text = label
    lbl.Size = UDim2.new(0.7, 0, 1, 0)
    lbl.Position = UDim2.new(0, 0, 0, 0)
    lbl.Font = Enum.Font.Gotham
    lbl.TextSize = 14
    lbl.TextColor3 = Color3.new(1,1,1)
    lbl.BackgroundTransparency = 1
    lbl.TextXAlignment = Enum.TextXAlignment.Left

    -- ÐŸÐ¾Ð»Ð·ÑƒÐ½Ð¾Ðº Ñ„Ð¾Ð½
    local sliderBack = Instance.new("Frame", container)
    sliderBack.Position = UDim2.new(0.7, 5, 0.3, 0)
    sliderBack.Size = UDim2.new(0, 50, 0, 20)
    sliderBack.BackgroundColor3 = default and MenuSettings.AccentColor or Color3.fromRGB(100, 100, 100)
    sliderBack.BorderSizePixel = 0
    sliderBack.Name = "SliderBack" -- Ð”Ð¾Ð±Ð°Ð²Ð»ÑÐµÐ¼ Ð¸Ð¼Ñ Ð´Ð»Ñ Ð¿Ð¾Ð¸ÑÐºÐ°
    Instance.new("UICorner", sliderBack).CornerRadius = UDim.new(1, 0)

    -- ÐŸÐ¾Ð»Ð·ÑƒÐ½Ð¾Ðº ÐºÑ€ÑƒÐ¶Ð¾Ðº
    local sliderKnob = Instance.new("Frame", sliderBack)
    sliderKnob.Size = UDim2.new(0, 16, 0, 16)
    sliderKnob.Position = default and UDim2.new(1, -18, 0.5, -8) or UDim2.new(0, 2, 0.5, -8)
    sliderKnob.BackgroundColor3 = Color3.new(1, 1, 1)
    sliderKnob.BorderSizePixel = 0
    Instance.new("UICorner", sliderKnob).CornerRadius = UDim.new(1, 0)

    -- ÐÐ½Ð¸Ð¼Ð°Ñ†Ð¸Ñ Ð¸ ÐºÐ»Ð¸Ðº
    local isEnabled = default
    sliderBack.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            isEnabled = not isEnabled
            
            -- ÐÐ½Ð¸Ð¼Ð°Ñ†Ð¸Ñ
            local targetPos = isEnabled and UDim2.new(1, -18, 0.5, -8) or UDim2.new(0, 2, 0.5, -8)
            local targetColor = isEnabled and MenuSettings.AccentColor or Color3.fromRGB(100, 100, 100)
            
            local tween1 = TweenService:Create(sliderKnob, TweenInfo.new(0.2, Enum.EasingStyle.Quad), {Position = targetPos})
            local tween2 = TweenService:Create(sliderBack, TweenInfo.new(0.2, Enum.EasingStyle.Quad), {BackgroundColor3 = targetColor})
            
            tween1:Play()
            tween2:Play()
            
            callback(isEnabled)
        end
    end)
    
    currentY = currentY + 40 + padding
    return container
end

local function createSlider(label, min, max, value, callback)
    local container = Instance.new("Frame", functionsContainer)
    container.Size = UDim2.new(1, -10, 0, 36)
    container.Position = UDim2.new(0, 5, 0, currentY)
    container.BackgroundTransparency = 1

    local lbl = Instance.new("TextLabel", container)
    lbl.Text = label .. ": " .. math.floor(value)
    lbl.Size = UDim2.new(1, 0, 0.5, 0)
    lbl.Font = Enum.Font.Gotham
    lbl.TextSize = 13
    lbl.TextColor3 = Color3.new(1,1,1)
    lbl.BackgroundTransparency = 1

    local sliderBack = Instance.new("Frame", container)
    sliderBack.Position = UDim2.new(0,0,0.5,4)
    sliderBack.Size = UDim2.new(1, 0, 0, 6)
    sliderBack.BackgroundColor3 = Color3.fromRGB(50,50,50)
    Instance.new("UICorner", sliderBack).CornerRadius = UDim.new(1,0)

    local sliderFill = Instance.new("Frame", sliderBack)
    sliderFill.Size = UDim2.new((math.floor(value) - min) / (max - min), 0, 1, 0)
    sliderFill.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    Instance.new("UICorner", sliderFill).CornerRadius = UDim.new(1,0)

    local dragging = false
    sliderBack.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
        end
    end)
    UserInputService.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = false
        end
    end)
    RunService.RenderStepped:Connect(function()
        if dragging then
            local pos = UserInputService:GetMouseLocation().X
            local abs = sliderBack.AbsolutePosition.X
            local width = sliderBack.AbsoluteSize.X
            local pct = math.clamp((pos - abs) / width, 0, 1)
            local newVal = math.floor(min + (max - min) * pct)
            sliderFill.Size = UDim2.new(pct, 0, 1, 0)
            lbl.Text = label .. ": " .. newVal
            callback(newVal)
        end
    end)
    
    currentY = currentY + 36 + padding
end

local function createColorPicker(labelText, currentColor, callback)
    local lbl = Instance.new("TextLabel", functionsContainer)
    lbl.Text = labelText
    lbl.TextColor3 = Color3.new(1,1,1)
    lbl.BackgroundTransparency = 1
    lbl.Size = UDim2.new(1, -10, 0, 20)
    lbl.Position = UDim2.new(0, 5, 0, currentY)
    lbl.Font = Enum.Font.SourceSans
    lbl.TextSize = 14
    currentY = currentY + 20 + padding

    local colors = {
        Color3.fromRGB(255, 255, 255),
        Color3.fromRGB(255, 0, 0),
        Color3.fromRGB(0, 255, 0),
        Color3.fromRGB(0, 0, 255),
        Color3.fromRGB(255, 255, 0),
        Color3.fromRGB(255, 0, 255),
        Color3.fromRGB(0, 255, 255),
        Color3.fromRGB(128, 128, 128),
        Color3.fromRGB(255, 165, 0),
    }

    local row = Instance.new("Frame", functionsContainer)
    row.Size = UDim2.new(1, -10, 0, 28)
    row.Position = UDim2.new(0, 5, 0, currentY)
    row.BackgroundTransparency = 1

    local layout = Instance.new("UIListLayout", row)
    layout.FillDirection = Enum.FillDirection.Horizontal
    layout.HorizontalAlignment = Enum.HorizontalAlignment.Left
    layout.Padding = UDim.new(0, 4)

    for _, clr in pairs(colors) do
        local btn = Instance.new("TextButton", row)
        btn.Size = UDim2.new(0, 24, 0, 24)
        btn.BackgroundColor3 = clr
        btn.Text = ""
        btn.AutoButtonColor = false
        btn.MouseButton1Click:Connect(function()
            callback(clr)
        end)
    end
    
    currentY = currentY + 28 + padding
end

local function createSpeedInput(label, currentSpeed, callback)
    local container = Instance.new("Frame", functionsContainer)
    container.Size = UDim2.new(1, -10, 0, 36)
    container.Position = UDim2.new(0, 5, 0, currentY)
    container.BackgroundTransparency = 1

    local lbl = Instance.new("TextLabel", container)
    lbl.Text = label .. ": " .. currentSpeed
    lbl.Size = UDim2.new(0.7, 0, 0.5, 0)
    lbl.Font = Enum.Font.Gotham
    lbl.TextSize = 13
    lbl.TextColor3 = Color3.new(1,1,1)
    lbl.BackgroundTransparency = 1

    local inputBox = Instance.new("TextBox", container)
    inputBox.Position = UDim2.new(0.7, 5, 0.25, 0)
    inputBox.Size = UDim2.new(0.3, -5, 0.5, 0)
    inputBox.Text = tostring(currentSpeed)
    inputBox.Font = Enum.Font.Gotham
    inputBox.TextSize = 12
    inputBox.TextColor3 = Color3.new(1,1,1)
    inputBox.BackgroundColor3 = Color3.fromRGB(40,40,40)
    inputBox.PlaceholderText = "Speed"
    Instance.new("UICorner", inputBox).CornerRadius = UDim.new(0,4)

    inputBox.FocusLost:Connect(function()
        local newSpeed = tonumber(inputBox.Text)
        if newSpeed and newSpeed > 0 then
            callback(newSpeed)
            lbl.Text = label .. ": " .. newSpeed
        else
            inputBox.Text = tostring(currentSpeed)
        end
    end)

    currentY = currentY + 36 + padding
    return lbl, inputBox
end

local function createKeyBindButton(name, currentKey, callback)
    local btn = Instance.new("TextButton", functionsContainer)
    btn.Size = UDim2.new(1, -10, 0, 24)
    btn.Position = UDim2.new(0, 5, 0, currentY)
    btn.Text = name .. " Hotkey: [" .. (currentKey and tostring(currentKey.Name) or "None") .. "]"
    btn.BackgroundColor3 = Color3.fromRGB(40,40,40)
    btn.TextColor3 = Color3.new(1,1,1)
    btn.Font = Enum.Font.Gotham
    btn.TextSize = 13
    btn.AutoButtonColor = false
    Instance.new("UICorner", btn).CornerRadius = UDim.new(0,6)

    btn.MouseButton1Click:Connect(function()
        btn.Text = name .. " Hotkey: [Press any key]"
        local conn
        conn = UserInputService.InputBegan:Connect(function(input, gp)
            if not gp and input.UserInputType == Enum.UserInputType.Keyboard then
                conn:Disconnect()
                callback(input.KeyCode)
                btn.Text = name .. " Hotkey: [" .. tostring(input.KeyCode.Name) .. "]"
            end
        end)
    end)
    
    currentY = currentY + 24 + padding
end

local function createDivider()
    local divider = Instance.new("Frame", functionsContainer)
    divider.Size = UDim2.new(1, -10, 0, 2)
    divider.Position = UDim2.new(0, 5, 0, currentY)
    divider.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
    divider.BorderSizePixel = 0
    currentY = currentY + 2 + padding
end

local function createDropdown(label, options, currentValue, callback)
    local container = Instance.new("Frame", functionsContainer)
    container.Size = UDim2.new(1, -10, 0, 50)
    container.Position = UDim2.new(0, 5, 0, currentY)
    container.BackgroundTransparency = 1

    local lbl = Instance.new("TextLabel", container)
    lbl.Text = label
    lbl.Size = UDim2.new(1, 0, 0, 20)
    lbl.Position = UDim2.new(0, 0, 0, 0)
    lbl.Font = Enum.Font.Gotham
    lbl.TextSize = 14
    lbl.TextColor3 = Color3.new(1,1,1)
    lbl.BackgroundTransparency = 1
    lbl.TextXAlignment = Enum.TextXAlignment.Left

    local dropdown = Instance.new("TextButton", container)
    dropdown.Size = UDim2.new(1, 0, 0, 25)
    dropdown.Position = UDim2.new(0, 0, 0, 25)
    dropdown.Text = currentValue .. " â–¼"
    dropdown.Font = Enum.Font.Gotham
    dropdown.TextSize = 12
    dropdown.TextColor3 = Color3.new(1,1,1)
    dropdown.BackgroundColor3 = Color3.fromRGB(50,50,50)
    dropdown.AutoButtonColor = false
    Instance.new("UICorner", dropdown).CornerRadius = UDim.new(0,4)

    local isOpen = false
    local optionsFrame = Instance.new("Frame", container)
    optionsFrame.Size = UDim2.new(1, 0, 0, #options * 25)
    optionsFrame.Position = UDim2.new(0, 0, 0, 50)
    optionsFrame.BackgroundColor3 = Color3.fromRGB(45,45,45)
    optionsFrame.BorderSizePixel = 0
    optionsFrame.Visible = false
    optionsFrame.ZIndex = 20
    Instance.new("UICorner", optionsFrame).CornerRadius = UDim.new(0,4)

    for i, option in ipairs(options) do
        local optionBtn = Instance.new("TextButton", optionsFrame)
        optionBtn.Size = UDim2.new(1, 0, 0, 25)
        optionBtn.Position = UDim2.new(0, 0, 0, (i-1) * 25)
        optionBtn.Text = option
        optionBtn.Font = Enum.Font.Gotham
        optionBtn.TextSize = 12
        optionBtn.TextColor3 = Color3.new(1,1,1)
        optionBtn.BackgroundColor3 = Color3.fromRGB(45,45,45)
        optionBtn.AutoButtonColor = false
        optionBtn.BorderSizePixel = 0
        optionBtn.ZIndex = 21

        optionBtn.MouseButton1Click:Connect(function()
            dropdown.Text = option .. " â–¼"
            optionsFrame.Visible = false
            isOpen = false
            callback(option)
        end)

        optionBtn.MouseEnter:Connect(function()
            optionBtn.BackgroundColor3 = Color3.fromRGB(60,60,60)
        end)

        optionBtn.MouseLeave:Connect(function()
            optionBtn.BackgroundColor3 = Color3.fromRGB(45,45,45)
        end)
    end

    dropdown.MouseButton1Click:Connect(function()
        isOpen = not isOpen
        optionsFrame.Visible = isOpen
        dropdown.Text = currentValue .. (isOpen and " â–²" or " â–¼")
    end)

    currentY = currentY + 50 + padding + (isOpen and (#options * 25) or 0)
    return container
end

-- Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ Ð´Ð»Ñ Ð¿Ð¾ÐºÐ°Ð·Ð° ÐºÐ¾Ð½Ñ‚ÐµÐ½Ñ‚Ð°
function showContent(tabName)
    -- Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÑÐµÐ¼ Ñ‚ÐµÐºÑƒÑ‰ÑƒÑŽ Ð¿Ð¾Ð·Ð¸Ñ†Ð¸ÑŽ Ð¿Ñ€Ð¾ÐºÑ€ÑƒÑ‚ÐºÐ¸
    if selectedTab and scrollFrame then
        tabScrollPositions[selectedTab] = scrollFrame.CanvasPosition.Y
    end
    
    -- ÐžÑ‡Ð¸Ñ‰Ð°ÐµÐ¼ ÐºÐ¾Ð½Ñ‚ÐµÐ¹Ð½ÐµÑ€ Ð¸ ÑÐ±Ñ€Ð°ÑÑ‹Ð²Ð°ÐµÐ¼ Ð¿Ð¾Ð·Ð¸Ñ†Ð¸ÑŽ
    for _, child in pairs(functionsContainer:GetChildren()) do
        child:Destroy()
    end
    currentY = 0
    
    if tabName == "Main" then
        contentTitle.Text = getText("MainFunctions")
        
        -- Hotkeys
        createKeyBindButton("ESP", Config.ESP.ToggleKey, function(newKey)
            Config.ESP.ToggleKey = newKey
        end)
        
        createKeyBindButton("Aimbot", Config.Aimbot.ToggleKey, function(newKey)
            Config.Aimbot.ToggleKey = newKey
        end)
        
        createKeyBindButton("Fly", MovementConfig.Fly.ToggleKey, function(newKey)
            MovementConfig.Fly.ToggleKey = newKey
        end)
        
        createKeyBindButton("NoClip", MovementConfig.NoClip.ToggleKey, function(newKey)
            MovementConfig.NoClip.ToggleKey = newKey
        end)
        
        createKeyBindButton("SpeedHack", MovementConfig.Speed.ToggleKey, function(newKey)
            MovementConfig.Speed.ToggleKey = newKey
        end)
        
        createKeyBindButton("Teleport", TeleportConfig.ToggleKey, function(newKey)
            TeleportConfig.ToggleKey = newKey
        end)
        
        createDivider()
        
        createSectionHeader("ðŸ”·ESP Settings")
        createToggleSlider(getText("ESP"), Config.ESP.Enabled, function(v) Config.ESP.Enabled = v end)
        createToggleSlider(getText("TeamCheck"), Config.ESP.TeamCheck, function(v) Config.ESP.TeamCheck = v end)
        createToggleSlider(getText("ShowOutline"), Config.ESP.ShowOutline, function(v) Config.ESP.ShowOutline = v end)
        createToggleSlider(getText("ShowLines"), Config.ESP.ShowLines, function(v) Config.ESP.ShowLines = v end)
        createToggleSlider(getText("RainbowColors"), Config.ESP.Rainbow, function(v) Config.ESP.Rainbow = v end)
        
        createColorPicker("Fill Color", Config.ESP.FillColor, function(c) Config.ESP.FillColor = c end)
        createColorPicker("Outline Color", Config.ESP.OutlineColor, function(c) Config.ESP.OutlineColor = c end)
        createColorPicker("Text Color", Config.ESP.TextColor, function(c) Config.ESP.TextColor = c end)
        createSlider("Fill Transparency", 0, 1, Config.ESP.FillTransparency, function(v) Config.ESP.FillTransparency = v end)
        createSlider("Outline Transparency", 0, 1, Config.ESP.OutlineTransparency, function(v) Config.ESP.OutlineTransparency = v end)
        
        createDivider()
        
        createSectionHeader("ðŸ”·Aimbot Settings")
        createToggleSlider(getText("Aimbot"), Config.Aimbot.Enabled, function(v) Config.Aimbot.Enabled = v end)
        createToggleSlider(getText("TeamCheck"), Config.Aimbot.TeamCheck, function(v) Config.Aimbot.TeamCheck = v end)
        createToggleSlider(getText("VisibilityCheck"), Config.Aimbot.VisibilityCheck, function(v) Config.Aimbot.VisibilityCheck = v end)
        createSlider("FOV Radius", 10, 500, Config.Aimbot.FOV, function(v) Config.Aimbot.FOV = v end)
        createToggleSlider(getText("FOVRainbow"), Config.Aimbot.FOVRainbow, function(v) Config.Aimbot.FOVRainbow = v end)
        createColorPicker("Aimbot FOV Color", Config.Aimbot.FOVColor, function(c) Config.Aimbot.FOVColor = c end)
        
        createDivider()
        
        createSectionHeader("ðŸŸ¨ Fly Settings")
        createToggleSlider("Fly", MovementConfig.Fly.Enabled, function(v)
            MovementConfig.Fly.Enabled = v
            if v then startFly() else stopFly() end
        end)
        
        createSlider("Fly Speed", 0.1, 10, MovementConfig.Fly.Speed, function(v)
            MovementConfig.Fly.Speed = v
        end)
        
        createSpeedInput("Custom Fly Speed", MovementConfig.Fly.Speed, function(v)
            MovementConfig.Fly.Speed = v
        end)
        
        createDivider()
        
        createSectionHeader("ðŸŸª NoClip Settings")
        local noClipStatusLabel = Instance.new("TextLabel", functionsContainer)
        noClipStatusLabel.Size = UDim2.new(1, -10, 0, 20)
        noClipStatusLabel.Position = UDim2.new(0, 5, 0, currentY)
        noClipStatusLabel.Text = "NoClip Status: OFF"
        noClipStatusLabel.Font = Enum.Font.GothamBold
        noClipStatusLabel.TextSize = 12
        noClipStatusLabel.TextColor3 = Color3.fromRGB(255,100,100)
        noClipStatusLabel.BackgroundTransparency = 1
        noClipStatusLabel.TextXAlignment = Enum.TextXAlignment.Left
        currentY = currentY + 20 + padding
        
        local forceNoClipToggle = createToggleSlider("Force NoClip", isNoClipping, function(v)
            if v then
                startNoClip()
                noClipStatusLabel.Text = "NoClip Status: ON"
                noClipStatusLabel.TextColor3 = Color3.fromRGB(100,255,100)
            else
                stopNoClip()
                noClipStatusLabel.Text = "NoClip Status: OFF"
                noClipStatusLabel.TextColor3 = Color3.fromRGB(255,100,100)
            end
        end)
        
        createDivider()
        
        createSectionHeader("ðŸŸ¦ SpeedHack Settings")
        createToggleSlider("SpeedHack", MovementConfig.Speed.Enabled, function(v)
            MovementConfig.Speed.Enabled = v
            if v then startSpeedHack() else stopSpeedHack() end
        end)
        
        createToggleSlider("Use JumpPower Method", MovementConfig.Speed.UseJumpPower, function(v)
            MovementConfig.Speed.UseJumpPower = v
            if MovementConfig.Speed.Enabled then
                stopSpeedHack()
                startSpeedHack()
            end
        end)
        
        createSlider("SpeedHack Speed", 0.1, 10, MovementConfig.Speed.Speed, function(v)
            MovementConfig.Speed.Speed = v
            if MovementConfig.Speed.Enabled then
                local char = Players.LocalPlayer.Character
                local hum = char and char:FindFirstChildOfClass("Humanoid")
                if hum then
                    hum.WalkSpeed = v * 16
                    if MovementConfig.Speed.UseJumpPower then
                        hum.JumpPower = v * 50
                    end
                end
            end
        end)
        
        createSpeedInput("Custom SpeedHack Speed", MovementConfig.Speed.Speed, function(v)
            MovementConfig.Speed.Speed = v
            if MovementConfig.Speed.Enabled then
                local char = Players.LocalPlayer.Character
                local hum = char and char:FindFirstChildOfClass("Humanoid")
                if hum then
                    hum.WalkSpeed = v * 16
                    if MovementConfig.Speed.UseJumpPower then
                        hum.JumpPower = v * 50
                    end
                end
            end
        end)
        
        createDivider()
        
        -- Jump Settings
        createSectionHeader("ðŸ¦˜ Jump Settings")
        createToggleSlider(getText("LongJump"), MovementConfig.LongJump.Enabled, function(v)
            MovementConfig.LongJump.Enabled = v
            if v then startLongJump() else stopLongJump() end
        end)
        
        createSlider("Long Jump Power", 50, 500, MovementConfig.LongJump.JumpPower, function(v)
            MovementConfig.LongJump.JumpPower = v
            if MovementConfig.LongJump.Enabled then
                local char = Players.LocalPlayer.Character
                local hum = char and char:FindFirstChildOfClass("Humanoid")
                if hum then
                    hum.JumpPower = v
                end
            end
        end)
        
        createToggleSlider(getText("InfiniteJump"), MovementConfig.InfiniteJump.Enabled, function(v)
            MovementConfig.InfiniteJump.Enabled = v
            if v then startInfiniteJump() else stopInfiniteJump() end
        end)
        
        createSlider("Infinite Jump Power", 20, 150, MovementConfig.InfiniteJump.JumpPower, function(v)
            MovementConfig.InfiniteJump.JumpPower = v
        end)
        
        createDivider()
        
        -- Teleport Settings
        createSectionHeader("ðŸŸ© Teleport Settings")
        
        local selectedPlayerLabel = Instance.new("TextLabel", functionsContainer)
        selectedPlayerLabel.Size = UDim2.new(1, -10, 0, 24)
        selectedPlayerLabel.Position = UDim2.new(0, 5, 0, currentY)
        selectedPlayerLabel.Text = getText("SelectedPlayer") .. ": " .. (TeleportConfig.SelectedPlayerName or "None")
        selectedPlayerLabel.Font = Enum.Font.GothamBold
        selectedPlayerLabel.TextSize = 14
        selectedPlayerLabel.TextColor3 = Color3.new(1,1,1)
        selectedPlayerLabel.BackgroundTransparency = 1
        selectedPlayerLabel.TextXAlignment = Enum.TextXAlignment.Left
        currentY = currentY + 24 + padding
        
        teleportBtn = Instance.new("TextButton", functionsContainer)
        teleportBtn.Size = UDim2.new(1, -10, 0, 28)
        teleportBtn.Position = UDim2.new(0, 5, 0, currentY)
        teleportBtn.Text = getText("StartTeleport")
        teleportBtn.Font = Enum.Font.GothamBold
        teleportBtn.TextSize = 14
        teleportBtn.TextColor3 = Color3.new(1,1,1)
        teleportBtn.BackgroundColor3 = Color3.fromRGB(0,150,0)
        teleportBtn.AutoButtonColor = false
        Instance.new("UICorner", teleportBtn).CornerRadius = UDim.new(0,6)
        currentY = currentY + 28 + padding
        
        teleportBtn.MouseButton1Click:Connect(function()
            if not TeleportConfig.TargetPlayer then
                teleportBtn.Text = "Select player first!"
                task.wait(2)
                teleportBtn.Text = "START TELEPORT"
                return
            end
            
            if TeleportConfig.Enabled then
                stopTeleport()
                TeleportConfig.Enabled = false
                teleportBtn.Text = getText("StartTeleport")
                teleportBtn.BackgroundColor3 = Color3.fromRGB(0,150,0)
            else
                startTeleport()
                TeleportConfig.Enabled = true
                teleportBtn.Text = getText("StopTeleport")
                teleportBtn.BackgroundColor3 = Color3.fromRGB(150,0,0)
            end
        end)
        
        local playerListLabel = Instance.new("TextLabel", functionsContainer)
        playerListLabel.Size = UDim2.new(1, -10, 0, 20)
        playerListLabel.Position = UDim2.new(0, 5, 0, currentY)
        playerListLabel.Text = getText("SelectPlayerForTeleport") .. ":"
        playerListLabel.Font = Enum.Font.GothamBold
        playerListLabel.TextSize = 12
        playerListLabel.TextColor3 = Color3.new(1,1,1)
        playerListLabel.BackgroundTransparency = 1
        playerListLabel.TextXAlignment = Enum.TextXAlignment.Left
        currentY = currentY + 20 + padding
        
        local playerButtons = {}
        local playerListStartY = currentY
        
        local function createPlayerList()
            for _, btn in pairs(playerButtons) do
                if btn and btn.Parent then
                    btn:Destroy()
                end
            end
            playerButtons = {}
            
            currentY = playerListStartY
            
            local allPlayers = Players:GetPlayers()
            local playerList = {}
            
            for _, player in ipairs(allPlayers) do
                if player ~= Players.LocalPlayer then
                    table.insert(playerList, player)
                end
            end
            
            table.sort(playerList, function(a, b)
                return string.lower(a.Name) < string.lower(b.Name)
            end)
            
            for _, player in ipairs(playerList) do
                local playerBtn = Instance.new("TextButton", functionsContainer)
                playerBtn.Size = UDim2.new(1, -10, 0, 24)
                playerBtn.Position = UDim2.new(0, 5, 0, currentY)
                playerBtn.Text = player.Name
                playerBtn.Font = Enum.Font.Gotham
                playerBtn.TextSize = 12
                playerBtn.TextColor3 = Color3.new(1,1,1)
                playerBtn.BackgroundColor3 = Color3.fromRGB(40,40,40)
                playerBtn.AutoButtonColor = false
                Instance.new("UICorner", playerBtn).CornerRadius = UDim.new(0,4)
                currentY = currentY + 24 + padding
                
                table.insert(playerButtons, playerBtn)
                
                playerBtn.MouseButton1Click:Connect(function()
                    TeleportConfig.TargetPlayer = player
                    TeleportConfig.SelectedPlayerName = player.Name
                    selectedPlayerLabel.Text = getText("SelectedPlayer") .. ": " .. player.Name
                    
                    for _, child in pairs(functionsContainer:GetChildren()) do
                        if child:IsA("TextButton") and child.Text == player.Name then
                            child.BackgroundColor3 = Color3.fromRGB(0,255,0)
                        elseif child:IsA("TextButton") and child.Text ~= "START TELEPORT" and child.Text ~= "STOP TELEPORT" and child.Text ~= player.Name then
                            child.BackgroundColor3 = Color3.fromRGB(40,40,40)
                        end
                    end
                end)
            end
        end
        
        createPlayerList()
        
        spawn(function()
            while true do
                task.wait(2)
                if selectedTab == "Main" then
                    createPlayerList()
                end
            end
        end)
        
    elseif tabName == "YBA Hacks" then
        contentTitle.Text = getText("YBAHacks")
        
        -- ðŸŽ¯ STAND RANGE Ð·Ð°Ð³Ð¾Ð»Ð¾Ð²Ð¾Ðº ÐºÐ°Ðº Ð² Player ESP
        createSectionHeader("ðŸŽ¯ STAND RANGE")
        
        local ybaToggleBtn = createToggleSlider(getText("YBAStandRange"), YBAConfig.Enabled, function(v)
            YBAConfig.Enabled = v
            if v then 
                startYBA() 
            else 
                stopYBA() 
            end
        end)
        
        local undergroundFlightToggleBtn = createToggleSlider(getText("UndergroundFlight"), isUndergroundControlEnabled, function(v)
            if v then
                if startUndergroundControl then
                    startUndergroundControl()
                end
            else
                if stopUndergroundControl then
                    stopUndergroundControl()
                end
            end
        end)
        
        local ybaNoClipStatusLabel = Instance.new("TextLabel", functionsContainer)
        ybaNoClipStatusLabel.Size = UDim2.new(1, -10, 0, 20)
        ybaNoClipStatusLabel.Position = UDim2.new(0, 5, 0, currentY)
        ybaNoClipStatusLabel.Text = "NoClip Status: " .. (isNoClipping and "ON" or "OFF")
        ybaNoClipStatusLabel.Font = Enum.Font.GothamBold
        ybaNoClipStatusLabel.TextSize = 12
        ybaNoClipStatusLabel.TextColor3 = isNoClipping and Color3.fromRGB(100,255,100) or Color3.fromRGB(255,100,100)
        ybaNoClipStatusLabel.BackgroundTransparency = 1
        ybaNoClipStatusLabel.TextXAlignment = Enum.TextXAlignment.Left
        currentY = currentY + 20 + padding
        
        local ybaNoClipToggle = createToggleSlider(getText("ForceNoClip"), isNoClipping, function(v)
            if v then
                startNoClip()
                ybaNoClipStatusLabel.Text = "NoClip Status: ON"
                ybaNoClipStatusLabel.TextColor3 = Color3.fromRGB(100,255,100)
            else
                stopNoClip()
                ybaNoClipStatusLabel.Text = "NoClip Status: OFF"
                ybaNoClipStatusLabel.TextColor3 = Color3.fromRGB(255,100,100)
            end
        end)
        
        createSlider("YBA Underground Speed", 1, 200, YBAConfig.UndergroundControl.FlightSpeed or 50, function(v)
            YBAConfig.UndergroundControl.FlightSpeed = v
            if isUndergroundControlEnabled and controlledStandForUnderground then
                print("YBA: Ð¡ÐºÐ¾Ñ€Ð¾ÑÑ‚ÑŒ Ð¿Ð¾Ð´Ð·ÐµÐ¼Ð½Ð¾Ð³Ð¾ Ð¿Ð¾Ð»ÐµÑ‚Ð° Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð° Ð½Ð°:", v)
            end
        end)
        

        
        -- â° ANTI TS Ð·Ð°Ð³Ð¾Ð»Ð¾Ð²Ð¾Ðº ÐºÐ°Ðº Ð² Player ESP
        createSectionHeader("â° ANTI TS")
        
        local         antiTimeStopBtn = Instance.new("TextButton", functionsContainer)
        antiTimeStopBtn.Size = UDim2.new(1, -10, 0, 28)
        antiTimeStopBtn.Position = UDim2.new(0, 5, 0, currentY)
        antiTimeStopBtn.Text = getText("AntiTimeStop")
        antiTimeStopBtn.Font = Enum.Font.GothamBold
        antiTimeStopBtn.TextSize = 14
        antiTimeStopBtn.TextColor3 = Color3.new(1,1,1)
        antiTimeStopBtn.BackgroundColor3 = Color3.fromRGB(255,100,100)
        antiTimeStopBtn.AutoButtonColor = false
        Instance.new("UICorner", antiTimeStopBtn).CornerRadius = UDim.new(0,6)
        currentY = currentY + 28 + padding
        
        antiTimeStopBtn.MouseButton1Click:Connect(function()
            if not isAntiTimeStopEnabled then
                AntiTimeStopConfig.Enabled = true
                startAntiTimeStop()
                antiTimeStopBtn.Text = "ANTI TIME STOP ACTIVE"
                antiTimeStopBtn.BackgroundColor3 = Color3.fromRGB(0,255,0)
                
                -- Ð‘Ñ‹ÑÑ‚Ñ€Ð¾Ðµ Ð¾Ñ‚ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ Ð¿Ð¾ÑÐ»Ðµ Ð¾ÑÐ²Ð¾Ð±Ð¾Ð¶Ð´ÐµÐ½Ð¸Ñ
                spawn(function()
                    task.wait(0.1) -- ÐœÐ¸Ð½Ð¸Ð¼Ð°Ð»ÑŒÐ½Ð¾Ðµ Ð²Ñ€ÐµÐ¼Ñ Ð´Ð»Ñ Ð¾ÑÐ²Ð¾Ð±Ð¾Ð¶Ð´ÐµÐ½Ð¸Ñ
                    
                    AntiTimeStopConfig.Enabled = false
                    stopAntiTimeStop()
                    antiTimeStopBtn.Text = "ANTI TIME STOP"
                    antiTimeStopBtn.BackgroundColor3 = Color3.fromRGB(255,100,100)
                    print("Anti TS: Ð“ÐžÐ¢ÐžÐ’Ðž!")
                end)
            end
        end)
        

        createDivider()
        
        -- ðŸ‘¥ PLAYER ESP Ð·Ð°Ð³Ð¾Ð»Ð¾Ð²Ð¾Ðº
        createSectionHeader("ðŸ‘¥ PLAYER ESP")
        
        local userStandToggleBtn = createToggleSlider("User Stand", false, function(v)
            if v then
                startUserStandESP()
            else
                stopUserStandESP()
            end
        end)
        
        local userStyleToggleBtn = createToggleSlider("User Style", false, function(v)
            if v then
                startUserStyleESP()
            else
                stopUserStyleESP()
            end
        end)
        
        -- ðŸ“¦ ITEM ESP Ð·Ð°Ð³Ð¾Ð»Ð¾Ð²Ð¾Ðº
        createSectionHeader("ðŸ“¦ ITEM ESP")
        
        local itemESPToggleBtn = createToggleSlider(getText("ItemESP"), YBAConfig.ItemESP.Enabled, function(v)
            YBAConfig.ItemESP.Enabled = v
            if v then 
                startItemESP() 
            else 
                stopItemESP() 
            end
        end)
        
        local itemSelectionHeader = Instance.new("TextLabel", functionsContainer)
        itemSelectionHeader.Size = UDim2.new(1, -10, 0, 25)
        itemSelectionHeader.Position = UDim2.new(0, 5, 0, currentY)
        itemSelectionHeader.Text = "ðŸ“¦ ITEM SELECTION"
        itemSelectionHeader.Font = Enum.Font.GothamBold
        itemSelectionHeader.TextSize = 14
        itemSelectionHeader.TextColor3 = Color3.fromRGB(255, 255, 0)
        itemSelectionHeader.BackgroundColor3 = Color3.fromRGB(40, 40, 50)
        itemSelectionHeader.BorderSizePixel = 1
        itemSelectionHeader.BorderColor3 = Color3.fromRGB(100, 100, 120)
        itemSelectionHeader.TextXAlignment = Enum.TextXAlignment.Left
        Instance.new("UICorner", itemSelectionHeader).CornerRadius = UDim.new(0,4)
        currentY = currentY + 25 + padding
        
        local function createItemToggle(itemName, defaultState)
            local btn = createToggleSlider(itemName, defaultState, function(v)
                YBAConfig.ItemESP.Items[itemName] = v
                print("YBA Item ESP: ÐŸÑ€ÐµÐ´Ð¼ÐµÑ‚", itemName, "ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½ Ð²", v and "ON" or "OFF")
                
                if YBAConfig.ItemESP.Enabled then
                    if not v then
                        for obj, esp in pairs(itemESPElements) do
                            if esp.itemName == itemName then
                                pcall(removeItemESP, {Object = obj})
                            end
                        end
                    end
                end
            end)
            return btn
        end
        
        createItemToggle(getText("MysteriousArrow"), YBAConfig.ItemESP.Items["Mysterious Arrow"])
        createItemToggle(getText("Rokakaka"), YBAConfig.ItemESP.Items["Rokakaka"])
        createItemToggle(getText("PureRokakaka"), YBAConfig.ItemESP.Items["Pure Rokakaka"])
        createItemToggle(getText("Diamond"), YBAConfig.ItemESP.Items["Diamond"])
        createItemToggle(getText("GoldCoin"), YBAConfig.ItemESP.Items["Gold Coin"])
        createItemToggle(getText("SteelBall"), YBAConfig.ItemESP.Items["Steel Ball"])
        createItemToggle(getText("Clackers"), YBAConfig.ItemESP.Items["Clackers"])
        createItemToggle(getText("CaesarsHeadband"), YBAConfig.ItemESP.Items["Caesar's Headband"])
        createItemToggle(getText("ZeppeliHat"), YBAConfig.ItemESP.Items["Zeppeli's Hat"])
        createItemToggle(getText("ZeppeliScarf"), YBAConfig.ItemESP.Items["Zeppeli's Scarf"])
        createItemToggle(getText("QuintonsGlove"), YBAConfig.ItemESP.Items["Quinton's Glove"])
        createItemToggle(getText("StoneMask"), YBAConfig.ItemESP.Items["Stone Mask"])
        createItemToggle(getText("RibCage"), YBAConfig.ItemESP.Items["Rib Cage of The Saint's Corpse"])
        createItemToggle(getText("AncientScroll"), YBAConfig.ItemESP.Items["Ancient Scroll"])
        createItemToggle(getText("DiosDiary"), YBAConfig.ItemESP.Items["DIO's Diary"])
        createItemToggle(getText("LuckyStoneMask"), YBAConfig.ItemESP.Items["Lucky Stone Mask"])
        createItemToggle(getText("LuckyArrow"), YBAConfig.ItemESP.Items["Lucky Arrow"])
        
        -- ðŸ¤– AUTOFARM Ð·Ð°Ð³Ð¾Ð»Ð¾Ð²Ð¾Ðº
        createSectionHeader("ðŸ¤– AUTOFARM")
        
        -- Autofarm Ñ‚ÑƒÐ¼Ð±Ð»ÐµÑ€
        createToggleSlider("Autofarm", isAutofarmEnabled, function(v)
            if v then
                startAutofarm()
            else
                stopAutofarm()
            end
        end)
        
        -- Ð—Ð°Ð³Ð¾Ð»Ð¾Ð²Ð¾Ðº Ð´Ð»Ñ Ð²Ñ‹Ð±Ð¾Ñ€Ð° Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ð¾Ð² Ð°Ð²Ñ‚Ð¾Ñ„Ð°Ñ€Ð¼Ð°
        createSectionHeader("ðŸ“¦ ITEMS FARM")
        
        -- Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ Ð´Ð»Ñ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ Ð¿ÐµÑ€ÐµÐºÐ»ÑŽÑ‡Ð°Ñ‚ÐµÐ»ÐµÐ¹ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ð¾Ð² Ð°Ð²Ñ‚Ð¾Ñ„Ð°Ñ€Ð¼Ð°
        local function createAutofarmItemToggle(itemName, defaultState)
            local btn = createToggleSlider(itemName, defaultState, function(v)
                AutofarmConfig.Items[itemName] = v
                
                -- Ð¤Ð˜ÐšÐ¡: Ð¡Ð¸Ð½Ñ…Ñ€Ð¾Ð½Ð¸Ð·Ð¸Ñ€ÑƒÐµÐ¼ ÐžÐ‘Ð Ð²Ð°Ñ€Ð¸Ð°Ð½Ñ‚Ð° ÐºÐ»ÑŽÑ‡ÐµÐ¹ Ð´Ð»Ñ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ð¾Ð²
                if itemName == "MysteriousArrow" or itemName == "Mysterious Arrow" or itemName == "Ð¢Ð°Ð¸Ð½ÑÑ‚Ð²ÐµÐ½Ð½Ð°Ñ ÑÑ‚Ñ€ÐµÐ»Ð°" then
                    AutofarmConfig.Items["Mysterious Arrow"] = v -- Ñ Ð¿Ñ€Ð¾Ð±ÐµÐ»Ð¾Ð¼ (ÐžÐ¡ÐÐžÐ’ÐÐžÐ™ ÐºÐ»ÑŽÑ‡ Ð´Ð»Ñ Ð¿Ð¾Ð¸ÑÐºÐ°)
                    AutofarmConfig.Items["MysteriousArrow"] = v -- Ð±ÐµÐ· Ð¿Ñ€Ð¾Ð±ÐµÐ»Ð°
                elseif itemName == "GoldCoin" or itemName == "Gold Coin" or itemName == "Ð—Ð¾Ð»Ð¾Ñ‚Ð°Ñ Ð¼Ð¾Ð½ÐµÑ‚Ð°" then
                    AutofarmConfig.Items["Gold Coin"] = v -- Ñ Ð¿Ñ€Ð¾Ð±ÐµÐ»Ð¾Ð¼
                    AutofarmConfig.Items["GoldCoin"] = v -- Ð±ÐµÐ· Ð¿Ñ€Ð¾Ð±ÐµÐ»Ð°
                end
                
                print("ðŸ¤– AUTOFARM: ÐŸÑ€ÐµÐ´Ð¼ÐµÑ‚", itemName, "ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½ Ð²", v and "ON" or "OFF")
                
                -- Ð•ÑÐ»Ð¸ Ð°Ð²Ñ‚Ð¾Ñ„Ð°Ñ€Ð¼ Ð°ÐºÑ‚Ð¸Ð²ÐµÐ½, ÑÐ±Ñ€Ð°ÑÑ‹Ð²Ð°ÐµÐ¼ Ð¿Ð¾Ð¿Ñ‹Ñ‚ÐºÐ¸ Ð´Ð»Ñ Ð²ÑÐµÑ… Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ð¾Ð² ÑÑ‚Ð¾Ð³Ð¾ Ñ‚Ð¸Ð¿Ð°
                -- Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ñ Ð¿Ñ€Ð¸Ð¼ÐµÐ½Ð¸Ð»Ð¸ÑÑŒ Ð½ÐµÐ¼ÐµÐ´Ð»ÐµÐ½Ð½Ð¾
                if isAutofarmEnabled then
                    -- ÐžÑ‡Ð¸Ñ‰Ð°ÐµÐ¼ ÑÑ‡ÐµÑ‚Ñ‡Ð¸ÐºÐ¸ Ð¿Ð¾Ð¿Ñ‹Ñ‚Ð¾Ðº Ð´Ð»Ñ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ð°
                    for key, _ in pairs(autofarmItemAttempts) do
                        if string.find(key, itemName) then
                            autofarmItemAttempts[key] = nil
                        end
                    end
                    
                    -- ÐžÑ‡Ð¸Ñ‰Ð°ÐµÐ¼ Ð¿Ñ€Ð¾Ð¿ÑƒÑ‰ÐµÐ½Ð½Ñ‹Ðµ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ñ‹
                    for key, item in pairs(autofarmSkippedItems) do
                        if item.Name == itemName then
                            autofarmSkippedItems[key] = nil
                        end
                    end
                    
                    -- ÐšÐ Ð˜Ð¢Ð˜Ð§ÐÐž: Ð•ÑÐ»Ð¸ Ñ‚ÐµÐºÑƒÑ‰Ð¸Ð¹ Ñ†ÐµÐ»ÐµÐ²Ð¾Ð¹ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚ Ð±Ñ‹Ð» Ð¾Ñ‚ÐºÐ»ÑŽÑ‡ÐµÐ½, Ð¿Ñ€ÐµÑ€Ñ‹Ð²Ð°ÐµÐ¼ Ð´Ð²Ð¸Ð¶ÐµÐ½Ð¸Ðµ Ðº Ð½ÐµÐ¼Ñƒ
                    if autofarmCurrentTarget and autofarmCurrentTarget.Name == itemName and not v then
                        print("ðŸ¤– AUTOFARM: ÐŸÑ€ÐµÑ€Ñ‹Ð²Ð°ÐµÐ¼ Ð´Ð²Ð¸Ð¶ÐµÐ½Ð¸Ðµ Ðº Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ñƒ", itemName, "- Ð¾Ð½ Ð±Ñ‹Ð» Ð¾Ñ‚ÐºÐ»ÑŽÑ‡ÐµÐ½ Ð² Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ°Ñ…")
                        autofarmCurrentTarget = nil
                        autofarmPickingUp = false
                        
                        -- ÐŸÐ Ð˜ÐÐ£Ð”Ð˜Ð¢Ð•Ð›Ð¬ÐÐž Ð¾Ñ‚Ð¿ÑƒÑÐºÐ°ÐµÐ¼ ÐºÐ»Ð°Ð²Ð¸ÑˆÑƒ E ÐµÑÐ»Ð¸ Ð¾Ð½Ð° Ð·Ð°Ð¶Ð°Ñ‚Ð°
                        pcall(function()
                            if game:GetService("VirtualInputManager") then
                                game:GetService("VirtualInputManager"):SendKeyEvent(false, AutofarmConfig.PickupKey, false, game)
                            end
                            game:GetService("UserInputService").InputEnded:Fire(
                                {KeyCode = AutofarmConfig.PickupKey, UserInputType = Enum.UserInputType.Keyboard},
                                false
                            )
                        end)
                        
                        -- ÐžÑ‚ÐºÐ»ÑŽÑ‡Ð°ÐµÐ¼ Ð²ÑÐµ ÑÐ¾ÐµÐ´Ð¸Ð½ÐµÐ½Ð¸Ñ Ð´Ð²Ð¸Ð¶ÐµÐ½Ð¸Ñ Ð¸ Ð¿Ð¾Ð´Ð±Ð¾Ñ€Ð°
                        for _, connection in ipairs(autofarmConnections) do
                            if connection then
                                pcall(function() connection:Disconnect() end)
                            end
                        end
                        autofarmConnections = {}
                        
                        -- ÐÐµÐ¼ÐµÐ´Ð»ÐµÐ½Ð½Ð¾ Ð¸Ñ‰ÐµÐ¼ ÑÐ»ÐµÐ´ÑƒÑŽÑ‰Ð¸Ð¹ Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚
                        task.spawn(function()
                            task.wait(0.1)
                            if isAutofarmEnabled then
                                processNextItem()
                            end
                        end)
                    end
                    
                    -- Ð£Ð±Ð¸Ñ€Ð°ÐµÐ¼ Ð»Ð¸ÑˆÐ½Ð¸Ð¹ ÑÐ¿Ð°Ð¼
                end
            end)
            return btn
        end
        
        -- Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ Ð¿ÐµÑ€ÐµÐºÐ»ÑŽÑ‡Ð°Ñ‚ÐµÐ»Ð¸ Ð´Ð»Ñ Ð²ÑÐµÑ… Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ð¾Ð² Ð°Ð²Ñ‚Ð¾Ñ„Ð°Ñ€Ð¼Ð°
        createAutofarmItemToggle("Mysterious Arrow", AutofarmConfig.Items["Mysterious Arrow"])
        createAutofarmItemToggle("Rokakaka", AutofarmConfig.Items["Rokakaka"])
        createAutofarmItemToggle("Pure Rokakaka", AutofarmConfig.Items["Pure Rokakaka"])
        createAutofarmItemToggle("Diamond", AutofarmConfig.Items["Diamond"])
        createAutofarmItemToggle("Gold Coin", AutofarmConfig.Items["Gold Coin"])
        createAutofarmItemToggle("Steel Ball", AutofarmConfig.Items["Steel Ball"])
        createAutofarmItemToggle("Clackers", AutofarmConfig.Items["Clackers"])
        createAutofarmItemToggle("Caesar's Headband", AutofarmConfig.Items["Caesar's Headband"])
        createAutofarmItemToggle("Zeppeli's Hat", AutofarmConfig.Items["Zeppeli's Hat"])
        createAutofarmItemToggle("Zeppeli's Scarf", AutofarmConfig.Items["Zeppeli's Scarf"])
        createAutofarmItemToggle("Quinton's Glove", AutofarmConfig.Items["Quinton's Glove"])
        createAutofarmItemToggle("Stone Mask", AutofarmConfig.Items["Stone Mask"])
        createAutofarmItemToggle("Rib Cage of The Saint's Corpse", AutofarmConfig.Items["Rib Cage of The Saint's Corpse"])
        createAutofarmItemToggle("Ancient Scroll", AutofarmConfig.Items["Ancient Scroll"])
        createAutofarmItemToggle("DIO's Diary", AutofarmConfig.Items["DIO's Diary"])
        createAutofarmItemToggle("Lucky Stone Mask", AutofarmConfig.Items["Lucky Stone Mask"])
        createAutofarmItemToggle("Lucky Arrow", AutofarmConfig.Items["Lucky Arrow"])
        
        -- AUTOSELL ÑÐµÐºÑ†Ð¸Ñ
        createDivider()
        createSectionHeader("ðŸ¤– AUTO SELL")
        
        -- Ð“Ð»Ð°Ð²Ð½Ñ‹Ð¹ Ñ‚ÑƒÐ¼Ð±Ð»ÐµÑ€ Ð°Ð²Ñ‚Ð¾ÑÐµÐ»Ð»Ð°
        local autosellToggleBtn = createToggleSlider("Auto Sell Enabled", AutosellConfig.Enabled, function(v)
            AutosellConfig.Enabled = v
            if v then
                startAutosell()
            else
                stopAutosell()
            end
        end)
        
        -- ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° Ð¼Ð°ÐºÑÐ¸Ð¼Ð°Ð»ÑŒÐ½Ð¾Ð³Ð¾ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð° Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ð¾Ð²
        createSlider("Max Items Count", 5, 20, AutosellConfig.MaxItemCount, function(v) 
            AutosellConfig.MaxItemCount = v 
        end)
        
        -- Ð—Ð°Ð³Ð¾Ð»Ð¾Ð²Ð¾Ðº Ð´Ð»Ñ Ð²Ñ‹Ð±Ð¾Ñ€Ð° Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ð¾Ð²
        createDivider()
        local itemsLabel = Instance.new("TextLabel", functionsContainer)
        itemsLabel.Text = "Select Items to Auto Sell:"
        itemsLabel.TextColor3 = Color3.new(1,1,1)
        itemsLabel.BackgroundTransparency = 1
        itemsLabel.Size = UDim2.new(1, -10, 0, 20)
        itemsLabel.Position = UDim2.new(0, 5, 0, currentY)
        itemsLabel.Font = Enum.Font.GothamBold
        itemsLabel.TextSize = 14
        itemsLabel.TextXAlignment = Enum.TextXAlignment.Left
        currentY = currentY + 25
        
        -- Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ Ñ‚ÑƒÐ¼Ð±Ð»ÐµÑ€Ð¾Ð² Ð´Ð»Ñ Ð°Ð²Ñ‚Ð¾ÑÐµÐ»Ð»Ð°
        local function createAutosellItemToggle(itemName, defaultState)
            local btn = createToggleSlider(itemName, defaultState, function(v)
                AutosellConfig.Items[itemName] = v
                print("ðŸ¤– AUTOSELL: ÐŸÑ€ÐµÐ´Ð¼ÐµÑ‚", itemName, "Ð´Ð»Ñ Ð¿Ñ€Ð¾Ð´Ð°Ð¶Ð¸ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½ Ð²", v and "ON" or "OFF")
            end)
            return btn
        end
        
        -- Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ Ð¿ÐµÑ€ÐµÐºÐ»ÑŽÑ‡Ð°Ñ‚ÐµÐ»Ð¸ Ð´Ð»Ñ Ð²ÑÐµÑ… Ð¿Ñ€ÐµÐ´Ð¼ÐµÑ‚Ð¾Ð² Ð°Ð²Ñ‚Ð¾ÑÐµÐ»Ð»Ð°
        createAutosellItemToggle("Mysterious Arrow", AutosellConfig.Items["Mysterious Arrow"])
        createAutosellItemToggle("Rokakaka", AutosellConfig.Items["Rokakaka"])
        createAutosellItemToggle("Pure Rokakaka", AutosellConfig.Items["Pure Rokakaka"])
        createAutosellItemToggle("Diamond", AutosellConfig.Items["Diamond"])
        createAutosellItemToggle("Gold Coin", AutosellConfig.Items["Gold Coin"])
        createAutosellItemToggle("Steel Ball", AutosellConfig.Items["Steel Ball"])
        createAutosellItemToggle("Clackers", AutosellConfig.Items["Clackers"])
        createAutosellItemToggle("Caesar's Headband", AutosellConfig.Items["Caesar's Headband"])
        createAutosellItemToggle("Zeppeli's Hat", AutosellConfig.Items["Zeppeli's Hat"])
        createAutosellItemToggle("Zeppeli's Scarf", AutosellConfig.Items["Zeppeli's Scarf"])
        createAutosellItemToggle("Quinton's Glove", AutosellConfig.Items["Quinton's Glove"])
        createAutosellItemToggle("Stone Mask", AutosellConfig.Items["Stone Mask"])
        createAutosellItemToggle("Rib Cage of The Saint's Corpse", AutosellConfig.Items["Rib Cage of The Saint's Corpse"])
        createAutosellItemToggle("Ancient Scroll", AutosellConfig.Items["Ancient Scroll"])
        createAutosellItemToggle("DIO's Diary", AutosellConfig.Items["DIO's Diary"])
        createAutosellItemToggle("Lucky Stone Mask", AutosellConfig.Items["Lucky Stone Mask"])
        createAutosellItemToggle("Lucky Arrow", AutosellConfig.Items["Lucky Arrow"])
        
    elseif tabName == "Settings" then
        contentTitle.Text = getText("MenuSettings")
        

        
        createDivider()
        
        local accentColorLabel = Instance.new("TextLabel", functionsContainer)
        accentColorLabel.Text = getText("AccentColor")
        accentColorLabel.TextColor3 = Color3.new(1,1,1)
        accentColorLabel.BackgroundTransparency = 1
        accentColorLabel.Size = UDim2.new(1, -10, 0, 20)
        accentColorLabel.Position = UDim2.new(0, 5, 0, currentY)
        accentColorLabel.Font = Enum.Font.Gotham
        accentColorLabel.TextSize = 14
        accentColorLabel.TextXAlignment = Enum.TextXAlignment.Left
        currentY = currentY + 20 + padding

        local accentColors = {
            Color3.fromRGB(0, 150, 0),
            Color3.fromRGB(0, 100, 255),
            Color3.fromRGB(255, 0, 100),
            Color3.fromRGB(255, 150, 0),
            Color3.fromRGB(150, 0, 255),
            Color3.fromRGB(255, 255, 0),
            Color3.fromRGB(0, 255, 255),
            Color3.fromRGB(255, 50, 50),
        }

        local colorRow = Instance.new("Frame", functionsContainer)
        colorRow.Size = UDim2.new(1, -10, 0, 35)
        colorRow.Position = UDim2.new(0, 5, 0, currentY)
        colorRow.BackgroundTransparency = 1

        local colorLayout = Instance.new("UIListLayout", colorRow)
        colorLayout.FillDirection = Enum.FillDirection.Horizontal
        colorLayout.HorizontalAlignment = Enum.HorizontalAlignment.Left
        colorLayout.Padding = UDim.new(0, 8)

        for _, color in pairs(accentColors) do
            local colorBtn = Instance.new("TextButton", colorRow)
            colorBtn.Size = UDim2.new(0, 30, 0, 30)
            colorBtn.BackgroundColor3 = color
            colorBtn.Text = ""
            colorBtn.AutoButtonColor = false
            colorBtn.BorderSizePixel = 0
            
            local colorCorner = Instance.new("UICorner", colorBtn)
            colorCorner.CornerRadius = UDim.new(0, 6)
            
            if MenuSettings.AccentColor == color then
                local highlight = Instance.new("UIStroke", colorBtn)
                highlight.Color = Color3.new(1, 1, 1)
                highlight.Thickness = 2
            end
            
            colorBtn.MouseButton1Click:Connect(function()
                MenuSettings.AccentColor = color
                updateAccentColor()
                
                for _, btn in pairs(colorRow:GetChildren()) do
                    if btn:IsA("TextButton") then
                        local stroke = btn:FindFirstChild("UIStroke")
                        if stroke then stroke:Destroy() end
                        
                        if btn.BackgroundColor3 == color then
                            local highlight = Instance.new("UIStroke", btn)
                            highlight.Color = Color3.new(1, 1, 1)
                            highlight.Thickness = 2
                        end
                    end
                end
                
                showContent(selectedTab)
            end)
        end
        
        currentY = currentY + 35 + padding
        
        createDivider()
        
        createDropdown(getText("Language"), {"English", "Russian"}, MenuSettings.Language, function(selectedLanguage)
            MenuSettings.Language = selectedLanguage
            updateAllTexts()
        end)
    end
    
    functionsContainer.Size = UDim2.new(1, 0, 0, currentY)
    
    selectedTab = tabName
    
    if scrollFrame and tabScrollPositions[tabName] then
        scrollFrame.CanvasPosition = Vector2.new(0, tabScrollPositions[tabName])
    end
end

showContent("Main")

UserInputService.InputBegan:Connect(function(input, gp)
    if not gp and input.KeyCode == Enum.KeyCode.Insert then
        mainFrame.Visible = not mainFrame.Visible
        if mainFrame.Visible then
            local existingButton = screenGui:FindFirstChild("ReopenButton")
            if existingButton then
                existingButton:Destroy()
            end
        else
            createReopenButton()
        end
    end
end)

